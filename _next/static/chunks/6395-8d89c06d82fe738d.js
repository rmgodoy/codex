"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6395],{46395:(e,s,t)=>{t.r(s),t.d(s,{default:()=>X});var l=t(95155),a=t(12115),r=t(6195),n=t(20031),i=t(47906),c=t(15019),d=t(62523),o=t(30285),m=t(66424),x=t(22346),u=t(87481),h=t(34301),j=t(75074),p=t(9572),f=t(20203),g=t(73926),N=t(85057),v=t(59409),w=t(90648),y=t(8643);function b(e){let{onSelectItem:s,onNewItem:t,selectedItemId:r,dataVersion:n,filters:i,setFilters:b,onClearFilters:C}=e,[S,I]=(0,a.useState)([]),[z,k]=(0,a.useState)(!0),{toast:T}=(0,u.dj)();(0,a.useEffect)(()=>{(async()=>{k(!0);try{I(await (0,c.SP)())}catch(e){T({variant:"destructive",title:"Error",description:"Could not fetch rooms from database."})}finally{k(!1)}})()},[n,T]);let A=(0,a.useMemo)(()=>{let e=S.filter(e=>{let s=e.name.toLowerCase().includes(i.searchTerm.toLowerCase()),t=!0,l=i.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return l.length>0&&(t=!!e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&t}).sort((e,s)=>e.name.localeCompare(s.name));return"desc"===i.sortOrder&&e.reverse(),e},[S,i]);return(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)(o.$,{onClick:t,className:"w-full",children:[(0,l.jsx)(h.A,{})," New Room"]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.p,{placeholder:"Search rooms...",value:i.searchTerm,onChange:e=>b.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,l.jsxs)(y.Nt,{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(y.R6,{asChild:!0,children:(0,l.jsxs)(o.$,{variant:"ghost",className:"-ml-2",children:[(0,l.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Filters"]})}),(0,l.jsx)(o.$,{variant:"ghost",size:"sm",onClick:C,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,l.jsx)(y.Ke,{className:"space-y-2 pt-2",children:(0,l.jsx)(w.F,{value:i.tagFilter?i.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>b.setTagFilter(e.join(",")),placeholder:"Tags (e.g. dungeon, trap)",tagSource:"room"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(N.J,{children:"Sort by"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(v.l6,{value:i.sortBy,onValueChange:e=>b.setSortBy(e),children:[(0,l.jsx)(v.bq,{children:(0,l.jsx)(v.yv,{placeholder:"Sort by"})}),(0,l.jsx)(v.gC,{children:(0,l.jsx)(v.eb,{value:"name",children:"Name"})})]}),(0,l.jsxs)(o.$,{variant:"ghost",size:"icon",onClick:()=>b.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===i.sortOrder?(0,l.jsx)(f.A,{className:"h-4 w-4"}):(0,l.jsx)(g.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,l.jsx)(x.w,{}),(0,l.jsx)(m.F,{className:"flex-1",children:(0,l.jsx)("div",{className:"p-4",children:z?(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading rooms..."}):A.length>0?(0,l.jsx)("ul",{className:"space-y-1",children:A.map(e=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(r===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:e.name})},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"No rooms found."})})})]})}var C=t(62177),S=t(90221),I=t(55594),z=t(38914),k=t(66695),T=t(88539),A=t(90010),F=t(17759),V=t(12543),E=t(18763),R=t(73503),B=t(98917),$=t(22945),L=t(77223),M=t(25318),D=t(53054),J=t(18046),O=t(21887),Z=t(68856),q=t(26126),_=t(54165),W=t(47262);let K=I.z.object({id:I.z.string(),title:I.z.string().min(1,"Feature title is required"),description:I.z.string().min(1,"Feature description is required"),encounterIds:I.z.array(I.z.string()),treasureIds:I.z.array(I.z.string()),alchemicalItemIds:I.z.array(I.z.string())}),P=I.z.object({name:I.z.string().min(1,"Room name is required"),description:I.z.string().optional(),size:I.z.string().optional(),tags:I.z.array(I.z.string()).optional(),features:I.z.array(K),totalTreasureValue:I.z.coerce.number()}),G=e=>{let{triggerButton:s,dialogTitle:t,items:r,onSelectItems:n,initialSelectedIds:i=[]}=e,[c,x]=(0,a.useState)(!1),[u,h]=(0,a.useState)(new Set(i)),[j,p]=(0,a.useState)(""),f=(0,a.useMemo)(()=>{let e=r.filter(e=>e.name.toLowerCase().includes(j.toLowerCase()));return e.sort((e,s)=>{let t=u.has(e.id),l=u.has(s.id);return t&&!l?-1:!t&&l?1:e.name.localeCompare(s.name)}),e},[r,j,u]),g=e=>{h(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})};return(0,l.jsxs)(_.lG,{open:c,onOpenChange:e=>{e&&h(new Set(i)),x(e)},children:[(0,l.jsx)(_.zM,{asChild:!0,children:s}),(0,l.jsxs)(_.Cf,{className:"max-w-lg h-[70vh] flex flex-col",children:[(0,l.jsx)(_.c7,{children:(0,l.jsx)(_.L3,{children:t})}),(0,l.jsx)(d.p,{placeholder:"Search...",value:j,onChange:e=>p(e.target.value),className:"mb-4 shrink-0"}),(0,l.jsx)(m.F,{className:"flex-1 border rounded-md p-2",children:(0,l.jsx)("div",{className:"space-y-1",children:f.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-md",children:[(0,l.jsx)(W.S,{id:"item-".concat(e.id),onCheckedChange:()=>g(e.id),checked:u.has(e.id)}),(0,l.jsxs)("label",{htmlFor:"item-".concat(e.id),className:"flex-1",children:[(0,l.jsx)("p",{className:"font-semibold",children:e.name}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[void 0!==e.value&&"Value: ".concat(e.value),e.type&&"Type: ".concat(e.type)]})]})]},e.id))})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 pt-4 shrink-0",children:[(0,l.jsx)(o.$,{variant:"ghost",onClick:()=>x(!1),children:"Cancel"}),(0,l.jsx)(o.$,{onClick:()=>{n(Array.from(u)),x(!1)},children:"Confirm"})]})]})]})},U={name:"",description:"",size:"",tags:[],features:[],totalTreasureValue:0};function H(e){let{roomId:s,isCreatingNew:t,onSaveSuccess:r,onDeleteSuccess:n,onEditCancel:m,onFilterByClick:h,onBack:j,dataVersion:p}=e,{toast:f}=(0,u.dj)(),[g,N]=(0,a.useState)(t),[v,b]=(0,a.useState)(!t&&!!s),[I,_]=(0,a.useState)(null),[W,K]=(0,a.useState)([]),[H,X]=(0,a.useState)([]),[Q,Y]=(0,a.useState)([]),ee=(0,i.a)(),{worldSlug:es}=(0,z.q)(),et=(0,a.useMemo)(()=>({encounters:new Map(W.map(e=>[e.id,e])),treasures:new Map(H.map(e=>[e.id,e])),alchemicalItems:new Map(Q.map(e=>[e.id,e]))}),[W,H,Q]),el=(0,C.mN)({resolver:(0,S.u)(P),defaultValues:U}),{fields:ea,append:er,remove:en}=(0,C.jz)({control:el.control,name:"features"}),ei=el.watch("features");(0,a.useEffect)(()=>{if(g){let e=ei.reduce((e,s)=>e+s.treasureIds.reduce((e,s)=>{let t=et.treasures.get(s);return e+((null==t?void 0:t.value)||0)},0),0);el.getValues("totalTreasureValue")!==e&&el.setValue("totalTreasureValue",e,{shouldValidate:!0})}},[ei,et.treasures,el,g]),(0,a.useEffect)(()=>{Promise.all([(0,c.eS)(),(0,c.h4)(),(0,c.vV)()]).then(e=>{let[s,t,l]=e;K(s),X(t),Y(l)})},[]),(0,a.useEffect)(()=>{(async()=>{if(t){el.reset(U),_(null),N(!0),b(!1);return}if(!s){N(!1),b(!1),_(null);return}b(!0),N(!1);try{let e=await (0,c._w)(s);e?(el.reset(e),_(e)):_(null)}catch(e){f({variant:"destructive",title:"Error",description:"Could not load room data."})}finally{b(!1)}})()},[s,t,el,f,p]);let ec=()=>{t?m():I&&(el.reset(I),N(!1))},ed=async e=>{try{let l,a={...e,tags:e.tags||[]},n=e.tags||[];if(n.length>0&&await (0,c.JE)(n,"room"),t)l=await (0,c.TG)(a),f({title:"Room Created!",description:"".concat(e.name," has been added.")});else{if(!s)return;l=s,await (0,c.xX)({...a,id:s}),f({title:"Save Successful",description:"".concat(e.name," has been updated.")})}r(l),N(!1)}catch(e){f({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},eo=async()=>{if(s)try{await (0,c.HN)(s),f({title:"Room Deleted",description:"The room has been removed."}),n()}catch(e){f({variant:"destructive",title:"Deletion Failed",description:"Could not delete the room."})}};return v?(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(k.Zp,{children:[(0,l.jsx)(k.aR,{children:(0,l.jsx)(Z.E,{className:"h-8 w-48"})}),(0,l.jsx)(k.Wu,{children:(0,l.jsx)(Z.E,{className:"h-40 w-full"})})]})}):s||t?!g&&I?(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(k.Zp,{children:[(0,l.jsx)(k.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[ee&&j&&(0,l.jsx)(o.$,{variant:"ghost",size:"icon",onClick:j,className:"shrink-0 -ml-2 -mt-1",children:(0,l.jsx)(V.A,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(k.ZB,{className:"text-3xl font-bold",children:I.name}),(0,l.jsxs)(k.BT,{className:"flex flex-wrap gap-x-4",children:[I.size&&(0,l.jsxs)("span",{children:["Size: ",I.size]}),(0,l.jsxs)("span",{children:["Total Value: ",I.totalTreasureValue]})]})]})]}),(0,l.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>N(!0),children:[(0,l.jsx)(E.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})}),(0,l.jsx)(k.Wu,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[I.description&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Description"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:I.description})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Features"}),I.features.length>0?(0,l.jsx)("ul",{className:"space-y-4",children:I.features.map(e=>(0,l.jsxs)("li",{className:"p-3 bg-card-foreground/5 rounded-lg",children:[(0,l.jsx)("p",{className:"font-semibold",children:e.title}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),e.encounterIds.length>0&&(0,l.jsxs)("div",{className:"mt-2 pl-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,l.jsx)(R.A,{className:"h-4 w-4"})," Linked Encounters"]}),(0,l.jsx)("ul",{className:"list-disc list-inside mt-1",children:e.encounterIds.map(e=>{var s;return(0,l.jsx)("li",{className:"text-sm",children:(0,l.jsx)("a",{href:"#/".concat(es,"/encounters/").concat(e),className:"text-accent hover:underline",children:(null==(s=et.encounters.get(e))?void 0:s.name)||"..."})},e)})})]}),e.treasureIds.length>0&&(0,l.jsxs)("div",{className:"mt-2 pl-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,l.jsx)(B.A,{className:"h-4 w-4"})," Linked Treasures"]}),(0,l.jsx)("ul",{className:"list-disc list-inside mt-1",children:e.treasureIds.map(e=>{var s;return(0,l.jsx)("li",{className:"text-sm",children:(0,l.jsx)("a",{href:"#/".concat(es,"/random/treasures/").concat(e),className:"text-accent hover:underline",children:(null==(s=et.treasures.get(e))?void 0:s.name)||"..."})},e)})})]}),e.alchemicalItemIds.length>0&&(0,l.jsxs)("div",{className:"mt-2 pl-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,l.jsx)($.A,{className:"h-4 w-4"})," Linked Alchemy"]}),(0,l.jsx)("ul",{className:"list-disc list-inside mt-1",children:e.alchemicalItemIds.map(e=>{var s;return(0,l.jsx)("li",{className:"text-sm",children:(0,l.jsx)("a",{href:"#/".concat(es,"/alchemy/").concat(e),className:"text-accent hover:underline",children:(null==(s=et.alchemicalItems.get(e))?void 0:s.name)||"..."})},e)})})]})]},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground",children:"No features defined for this room."})]}),I.tags&&I.tags.length>0&&(0,l.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:I.tags.map(e=>(0,l.jsx)("button",{onClick:s=>h({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,l.jsx)(q.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]})}),(0,l.jsx)(k.wL,{children:(0,l.jsxs)(A.Lt,{children:[(0,l.jsx)(A.tv,{asChild:!0,children:(0,l.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(L.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(A.EO,{children:[(0,l.jsxs)(A.wd,{children:[(0,l.jsx)(A.r7,{children:"Are you sure?"}),(0,l.jsxs)(A.$v,{children:['This will permanently delete "',I.name,'".']})]}),(0,l.jsxs)(A.ck,{children:[(0,l.jsx)(A.Zr,{children:"Cancel"}),(0,l.jsx)(A.Rx,{onClick:eo,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(k.Zp,{children:(0,l.jsx)(F.lV,{...el,children:(0,l.jsxs)("form",{onSubmit:el.handleSubmit(ed),className:"space-y-6",children:[(0,l.jsx)(k.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[ee&&j&&(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:m,className:"shrink-0 -ml-2",children:(0,l.jsx)(V.A,{className:"h-5 w-5"})}),(0,l.jsx)(k.ZB,{children:t?"Create New Room":"Editing: ".concat(el.getValues("name")||"...")})]}),!ee&&(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:ec,className:"text-muted-foreground hover:text-foreground",children:(0,l.jsx)(M.A,{className:"h-5 w-5"})})]})}),(0,l.jsxs)(k.Wu,{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(F.zB,{name:"name",control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsx)(F.lR,{children:"Name"}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(d.p,{...s})}),(0,l.jsx)(F.C5,{})]})}}),(0,l.jsx)(F.zB,{name:"size",control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsx)(F.lR,{children:"Size"}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(d.p,{...s,placeholder:"e.g., 30ft x 40ft"})})]})}})]}),(0,l.jsx)(F.zB,{name:"totalTreasureValue",control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsx)(F.lR,{children:"Total Treasure Value"}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s,readOnly:!0,className:"w-28 bg-muted border-none"})})]})}}),(0,l.jsx)(F.zB,{name:"description",control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsx)(F.lR,{children:"Description"}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(T.T,{...s,rows:4})})]})}}),(0,l.jsx)(F.zB,{name:"tags",control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsxs)(F.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(D.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(w.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"room"})}),(0,l.jsx)(F.C5,{})]})}}),(0,l.jsx)(x.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Room Features"}),(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",onClick:()=>{er({id:crypto.randomUUID(),title:"",description:"",encounterIds:[],treasureIds:[],alchemicalItemIds:[]})},children:[(0,l.jsx)(J.A,{className:"h-4 w-4 mr-2"})," Add Feature"]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[ea.map((e,s)=>(0,l.jsxs)(y.Nt,{className:"border bg-card-foreground/5 rounded-lg p-3",defaultOpen:!el.watch("features.".concat(s,".title")),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(y.R6,{asChild:!0,children:(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-3 text-left w-full",children:[(0,l.jsx)(O.A,{className:"h-5 w-5 text-muted-foreground"}),(0,l.jsx)("span",{className:"text-lg font-semibold text-foreground",children:el.watch("features.".concat(s,".title"))||"New Feature"})]})}),(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>en(s),className:"text-muted-foreground hover:text-destructive shrink-0",children:(0,l.jsx)(L.A,{className:"h-4 w-4"})})]}),(0,l.jsxs)(y.Ke,{className:"mt-4 space-y-4",children:[(0,l.jsx)(F.zB,{name:"features.".concat(s,".title"),control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsx)(F.lR,{children:"Title"}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(d.p,{...s})}),(0,l.jsx)(F.C5,{})]})}}),(0,l.jsx)(F.zB,{name:"features.".concat(s,".description"),control:el.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(F.eI,{children:[(0,l.jsx)(F.lR,{children:"Description"}),(0,l.jsx)(F.MJ,{children:(0,l.jsx)(T.T,{...s,rows:2})}),(0,l.jsx)(F.C5,{})]})}}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 justify-end",children:[(0,l.jsx)(G,{triggerButton:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(R.A,{className:"h-4 w-4 mr-2"})," Encounters"]}),dialogTitle:"Link Encounters",items:W.map(e=>({id:e.id,name:e.name,value:e.totalTR||0})),onSelectItems:e=>el.setValue("features.".concat(s,".encounterIds"),e),initialSelectedIds:el.getValues("features.".concat(s,".encounterIds"))}),(0,l.jsx)(G,{triggerButton:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(B.A,{className:"h-4 w-4 mr-2"})," Treasures"]}),dialogTitle:"Link Treasures",items:H,onSelectItems:e=>el.setValue("features.".concat(s,".treasureIds"),e),initialSelectedIds:el.getValues("features.".concat(s,".treasureIds"))}),(0,l.jsx)(G,{triggerButton:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)($.A,{className:"h-4 w-4 mr-2"})," Alchemy"]}),dialogTitle:"Link Alchemical Items",items:Q.map(e=>({id:e.id,name:e.name,type:e.type})),onSelectItems:e=>el.setValue("features.".concat(s,".alchemicalItemIds"),e),initialSelectedIds:el.getValues("features.".concat(s,".alchemicalItemIds"))})]})]})]},e.id)),0===ea.length&&(0,l.jsx)("p",{className:"text-muted-foreground text-center text-sm py-4",children:"No features added to this room."})]})]})]}),(0,l.jsxs)(k.wL,{className:"flex items-center gap-2",children:[!t&&(0,l.jsxs)(A.Lt,{children:[(0,l.jsx)(A.tv,{asChild:!0,children:(0,l.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(L.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(A.EO,{children:[(0,l.jsxs)(A.wd,{children:[(0,l.jsx)(A.r7,{children:"Are you sure?"}),(0,l.jsxs)(A.$v,{children:['This will permanently delete "',el.getValues("name"),'".']})]}),(0,l.jsxs)(A.ck,{children:[(0,l.jsx)(A.Zr,{children:"Cancel"}),(0,l.jsx)(A.Rx,{onClick:eo,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,l.jsx)("div",{className:"flex-grow"}),!ee&&(0,l.jsx)(o.$,{type:"button",variant:"outline",onClick:ec,children:"Cancel"}),(0,l.jsx)(o.$,{type:"submit",children:t?"Create Room":"Save Changes"})]})]})})})}):(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(k.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,l.jsx)(k.Wu,{className:"text-center pt-6",children:(0,l.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a room to view or create a new one."})})})})}function X(e){let{selectedId:s}=e,[t,c]=(0,a.useState)(s||null),[d,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)(0),[u,h]=(0,a.useState)(""),[j,p]=(0,a.useState)(""),[f,g]=(0,a.useState)("name"),[N,v]=(0,a.useState)("asc"),[w,y]=(0,a.useState)(!1),C=(0,i.a)(),[S,I]=(0,a.useState)("list");(0,a.useEffect)(()=>{y(!0),s&&(c(s),C&&I("editor"))},[s,C]);let z={searchTerm:u,tagFilter:j,sortBy:f,sortOrder:N},k={setSearchTerm:h,setTagFilter:p,setSortBy:g,setSortOrder:v},T=(e,s)=>{s.shiftKey?e.tagFilter&&p(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter):p(e.tagFilter||"")},A=()=>{h(""),p(""),g("name"),v("asc")},F=()=>x(e=>e+1),V=e=>{c(e),o(!1),C&&I("editor")},E=()=>{c(null),o(!0),C&&I("editor")},R=e=>{F(),c(e),o(!1),C&&I("editor")},B=()=>{F(),c(null),o(!1),C&&I("list")},$=()=>{d&&(o(!1),c(null),C&&I("list"))};return w?C?(0,l.jsx)(r.A,{showSidebarTrigger:!1,children:(0,l.jsx)("div",{className:"h-full w-full",children:"list"===S?(0,l.jsx)(b,{onSelectItem:V,onNewItem:E,selectedItemId:t,dataVersion:m,filters:z,setFilters:k,onClearFilters:A}):(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)("div",{className:"p-4 sm:p-6",children:(0,l.jsx)(H,{roomId:t,isCreatingNew:d,onSaveSuccess:R,onDeleteSuccess:B,onEditCancel:$,onFilterByClick:T,onBack:()=>{I("list"),c(null),o(!1)},dataVersion:m},null!=t?t:d?"new":"placeholder")})})})}):(0,l.jsx)(n.SidebarProvider,{children:(0,l.jsx)(r.A,{children:(0,l.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,l.jsx)(n.Bx,{style:{"--sidebar-width":"380px"},children:(0,l.jsx)(b,{onSelectItem:V,onNewItem:E,selectedItemId:t,dataVersion:m,filters:z,setFilters:k,onClearFilters:A})}),(0,l.jsx)(n.sF,{className:"flex-1 overflow-y-auto",children:(0,l.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,l.jsx)(H,{roomId:t,isCreatingNew:d,onSaveSuccess:R,onDeleteSuccess:B,onEditCancel:$,onFilterByClick:T,dataVersion:m},null!=t?t:d?"new":"placeholder")})})]})})}):null}}}]);