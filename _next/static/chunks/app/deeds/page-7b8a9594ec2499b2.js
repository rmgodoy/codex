(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[230],{3062:(e,s,t)=>{"use strict";t.d(s,{FC:()=>l,GW:()=>r,OJ:()=>a,Yh:()=>n,ag:()=>i});let r=["attack","support"],l=["melee","missile","innate","unarmed","spell","item","versatile"],a=["guard","resist","10","special"],n=["potion","powder","oil","bomb"],i=["lesser","greater"]},3930:(e,s,t)=>{"use strict";t.d(s,{W$:()=>n,kO:()=>i,pT:()=>d,rp:()=>a,wz:()=>c,xy:()=>l});var r=t(2489);let l=async()=>{let e=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).getAll();return new Promise((s,t)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>t(e.error)})},a=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).get(e);return new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>t(s.error)})},n=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi),t=(0,r.$C)(),l={...e,id:t},a=s.add(l);return new Promise((e,s)=>{a.onsuccess=()=>e(t),a.onerror=()=>s(a.error)})},i=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).put(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},c=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).delete(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},d=async e=>{if(!e||0===e.length)return[];let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi),t=[],l=e.map(e=>new Promise((r,l)=>{let a=s.get(e);a.onsuccess=()=>{a.result&&t.push(a.result),r()},a.onerror=()=>l(a.error)}));return await Promise.all(l),t}},4437:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>W});var r=t(5155),l=t(2115),a=t(3930),n=t(2523),i=t(285),c=t(6424),d=t(2346),o=t(7481),h=t(4301),x=t(5074),u=t(203),j=t(3926),m=t(9409),p=t(5057),f=t(648);function g(e){let{onSelectDeed:s,onNewDeed:t,selectedDeedId:g,dataVersion:v,filters:w,setFilters:y,onClearFilters:N}=e,[b,C]=(0,l.useState)([]),[S,z]=(0,l.useState)(!0),{toast:T}=(0,o.dj)();(0,l.useEffect)(()=>{(async()=>{z(!0);try{let e=await (0,a.xy)();C(e)}catch(e){console.error("Error fetching deeds:",e),T({variant:"destructive",title:"Error",description:"Could not fetch deeds from database."})}finally{z(!1)}})()},[v,T]);let F=(0,l.useMemo)(()=>{let e=b.filter(e=>{let s=e.name.toLowerCase().includes(w.searchTerm.toLowerCase()),t="all"===w.tierFilter||e.tier===w.tierFilter,r=!0,l=w.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return l.length>0&&(r=!!e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&t&&r}),s={light:1,heavy:2,mighty:3},t=e.sort((e,t)=>{if("tier"===w.sortBy){let r=(s[e.tier]||0)-(s[t.tier]||0);if(0!==r)return r}return e.name.localeCompare(t.name)});return"desc"===w.sortOrder&&t.reverse(),t},[b,w]);return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)(i.$,{onClick:t,className:"w-full",children:[(0,r.jsx)(h.A,{})," New Deed"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(n.p,{placeholder:"Search deeds...",value:w.searchTerm,onChange:e=>y.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(p.J,{children:"Filter"}),(0,r.jsx)(i.$,{variant:"ghost",size:"sm",onClick:N,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,r.jsxs)(m.l6,{value:w.tierFilter,onValueChange:y.setTierFilter,children:[(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Filter by tier"})}),(0,r.jsxs)(m.gC,{children:[(0,r.jsx)(m.eb,{value:"all",children:"All Tiers"}),(0,r.jsx)(m.eb,{value:"light",children:"Light"}),(0,r.jsx)(m.eb,{value:"heavy",children:"Heavy"}),(0,r.jsx)(m.eb,{value:"mighty",children:"Mighty"})]})]}),(0,r.jsx)(f.F,{value:w.tagFilter?w.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>y.setTagFilter(e.join(",")),placeholder:"Tags (e.g. fire, control)",tagSource:"deed"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(p.J,{children:"Sort by"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(m.l6,{value:w.sortBy,onValueChange:e=>y.setSortBy(e),children:[(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Sort by"})}),(0,r.jsxs)(m.gC,{children:[(0,r.jsx)(m.eb,{value:"name",children:"Name"}),(0,r.jsx)(m.eb,{value:"tier",children:"Tier"})]})]}),(0,r.jsxs)(i.$,{variant:"ghost",size:"icon",onClick:()=>y.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===w.sortOrder?(0,r.jsx)(u.A,{className:"h-4 w-4"}):(0,r.jsx)(j.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,r.jsx)(d.w,{}),(0,r.jsx)(c.F,{className:"flex-1",children:(0,r.jsx)("div",{className:"p-4",children:S?(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading deeds..."}):F.length>0?(0,r.jsx)("ul",{className:"space-y-1",children:F.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(g===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,r.jsxs)("span",{className:"text-xs opacity-70",children:["(",e.tier,")"]})]})},e.id))}):(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"No deeds found."})})})]})}var v=t(2177),w=t(221),y=t(5594),N=t(4218),b=t(3062),C=t(6695),S=t(8539),z=t(10),T=t(7759),F=t(2543),k=t(5599),B=t(8763),E=t(7223),D=t(5318),A=t(3054),J=t(8856),V=t(8911),q=t(6126),I=t(7906);let L=y.z.object({start:y.z.string().optional(),base:y.z.string().optional(),hit:y.z.string().optional(),shadow:y.z.string().optional(),end:y.z.string().optional()}),M=y.z.object({name:y.z.string().min(1,"Deed name is required"),tier:y.z.enum(["light","heavy","mighty"]),actionType:y.z.enum(b.GW),deedType:y.z.enum(b.FC),versus:y.z.enum(b.OJ),target:y.z.string().optional(),effects:L,tags:y.z.array(y.z.string()).optional()}),O={name:"",tier:"light",actionType:"attack",deedType:"melee",versus:"guard",target:"",effects:{start:"",base:"",hit:"",shadow:"",end:""},tags:[]};function R(e){let{deedId:s,isCreatingNew:t,template:c,onDeedSaveSuccess:h,onDeedDeleteSuccess:x,onUseAsTemplate:u,onEditCancel:j,dataVersion:p,onFilterByClick:g,onBack:y}=e,{toast:L}=(0,o.dj)(),[R,$]=(0,l.useState)(t),[P,W]=(0,l.useState)(!t&&!!s),[Z,_]=(0,l.useState)(null),G=(0,I.a)(),H=(0,v.mN)({resolver:(0,w.u)(M),defaultValues:c||O});(0,l.useEffect)(()=>{(async()=>{if(t){H.reset(c?{...c,tags:c.tags||[]}:O),_(c||null),$(!0),W(!1);return}if(!s){$(!1),W(!1),_(null);return}W(!0),$(!1);try{let e=await (0,a.rp)(s);if(e){let s={...e,tags:e.tags||[]};H.reset(s),_(e)}else _(null)}catch(e){console.error("Failed to fetch deed data:",e),L({variant:"destructive",title:"Error",description:"Could not load deed data."})}finally{W(!1)}})()},[s,t,c,H,L,p]);let U=()=>{if(t)j();else if(Z){let e={...Z,tags:Z.tags||[]};H.reset(e),$(!1)}},K=async e=>{try{let r={...e,tags:e.tags||[]},l=e.tags||[];if(l.length>0&&await (0,N.JE)(l,"deed"),t){let s=await (0,a.W$)(r);L({title:"Deed Created!",description:"".concat(e.name," has been added to the library.")}),h(s)}else s&&(await (0,a.kO)({...r,id:s}),L({title:"Save Successful",description:"".concat(e.name," has been updated.")}),h(s));$(!1)}catch(e){console.error("Failed to save deed:",e),L({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},Y=async()=>{if(s)try{await (0,a.wz)(s),L({title:"Deed Deleted",description:"The deed has been removed from the library."}),x()}catch(e){console.error("Failed to delete deed:",e),L({variant:"destructive",title:"Deletion Failed",description:"Could not delete the deed."})}};return P?(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(C.Zp,{children:[(0,r.jsxs)(C.aR,{children:[(0,r.jsx)(J.E,{className:"h-8 w-48"}),(0,r.jsx)(J.E,{className:"h-4 w-32"})]}),(0,r.jsxs)(C.Wu,{className:"space-y-6",children:[(0,r.jsx)(J.E,{className:"h-10 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(J.E,{className:"h-10 w-full"}),(0,r.jsx)(J.E,{className:"h-10 w-full"})]}),(0,r.jsx)(d.w,{}),(0,r.jsx)(J.E,{className:"h-20 w-full"}),(0,r.jsx)(J.E,{className:"h-20 w-full"}),(0,r.jsx)(J.E,{className:"h-20 w-full"})]})]})}):s||t?!R&&Z?(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(C.Zp,{children:[(0,r.jsx)(C.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[G&&y&&(0,r.jsx)(i.$,{variant:"ghost",size:"icon",onClick:y,className:"-ml-4 -mt-2",children:(0,r.jsx)(F.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(C.ZB,{className:"text-3xl font-bold",children:Z.name}),(0,r.jsx)(C.BT,{className:"mt-1 capitalize",children:(0,r.jsx)("button",{onClick:e=>g({tierFilter:Z.tier},e),className:"hover:underline p-0 bg-transparent text-inherit",children:Z.tier})})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{Z&&u(Z)},children:[(0,r.jsx)(k.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Template"})]}),(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>$(!0),children:[(0,r.jsx)(B.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Edit"})]})]})]})}),(0,r.jsxs)(C.Wu,{children:[(0,r.jsx)(V.P,{deed:Z}),Z.tags&&Z.tags.length>0&&(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Z.tags.map(e=>(0,r.jsx)("button",{onClick:s=>g({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,r.jsx)(q.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]}),(0,r.jsx)(C.wL,{children:(0,r.jsxs)(z.Lt,{children:[(0,r.jsx)(z.tv,{asChild:!0,children:(0,r.jsx)(i.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(E.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(z.EO,{children:[(0,r.jsxs)(z.wd,{children:[(0,r.jsx)(z.r7,{children:"Are you sure?"}),(0,r.jsxs)(z.$v,{children:['This will permanently delete "',H.getValues("name"),'". This action cannot be undone.']})]}),(0,r.jsxs)(z.ck,{children:[(0,r.jsx)(z.Zr,{children:"Cancel"}),(0,r.jsx)(z.Rx,{onClick:Y,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(C.Zp,{children:(0,r.jsx)(T.lV,{...H,children:(0,r.jsxs)("form",{onSubmit:H.handleSubmit(K),className:"space-y-6",children:[(0,r.jsx)(C.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[G&&y&&(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"icon",onClick:U,className:"-ml-4",children:(0,r.jsx)(F.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(C.ZB,{children:t?G?"New Deed":"Create a New Deed":"Editing: ".concat(H.getValues("name")||"...")}),(0,r.jsx)(C.BT,{children:t?"Fill out the details for your new deed.":"Make your changes and click Save."})]})]}),!G&&(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"icon",onClick:U,className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(D.A,{className:"h-5 w-5"})})]})}),(0,r.jsxs)(C.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(T.zB,{name:"name",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsx)(T.lR,{children:"Deed Name"}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(n.p,{placeholder:"e.g., Inferno",...s})}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(T.zB,{name:"tier",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsx)(T.lR,{children:"Tier"}),(0,r.jsxs)(m.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(T.MJ,{children:(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Select tier"})})}),(0,r.jsxs)(m.gC,{children:[(0,r.jsx)(m.eb,{value:"light",children:"Light"}),(0,r.jsx)(m.eb,{value:"heavy",children:"Heavy"}),(0,r.jsx)(m.eb,{value:"mighty",children:"Mighty"})]})]}),(0,r.jsx)(T.C5,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(T.zB,{name:"deedType",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsx)(T.lR,{children:"Deed Type"}),(0,r.jsxs)(m.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(T.MJ,{children:(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Select deed type"})})}),(0,r.jsx)(m.gC,{children:b.FC.map(e=>(0,r.jsx)(m.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(T.zB,{name:"actionType",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsx)(T.lR,{children:"Action Type"}),(0,r.jsxs)(m.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(T.MJ,{children:(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Select action type"})})}),(0,r.jsx)(m.gC,{children:b.GW.map(e=>(0,r.jsx)(m.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(T.zB,{name:"versus",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsx)(T.lR,{children:"Versus"}),(0,r.jsxs)(m.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(T.MJ,{children:(0,r.jsx)(m.bq,{children:(0,r.jsx)(m.yv,{placeholder:"Select versus"})})}),(0,r.jsx)(m.gC,{children:b.OJ.map(e=>(0,r.jsx)(m.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(T.C5,{})]})}})]}),(0,r.jsx)(T.zB,{name:"target",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsx)(T.lR,{children:"Target"}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(n.p,{placeholder:"e.g., 1 Creature | Blast 4",...s})}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(T.zB,{name:"tags",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsxs)(T.lR,{className:"flex items-center gap-2",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(f.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"deed"})}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(d.w,{}),(0,r.jsx)("h4",{className:"font-semibold text-primary-foreground",children:"Effects"}),(0,r.jsx)(T.zB,{name:"effects.start",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsxs)(T.lR,{children:["Start ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(S.T,{placeholder:"Effect when a creature starts its turn in an area...",...s,rows:2})})]})}}),(0,r.jsx)(T.zB,{name:"effects.base",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsxs)(T.lR,{children:["Base ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(S.T,{placeholder:"Base effect of the deed...",...s,rows:2})})]})}}),(0,r.jsx)(T.zB,{name:"effects.hit",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsxs)(T.lR,{children:["Hit ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(S.T,{placeholder:"The primary effect on a successful hit...",...s,rows:3})}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(T.zB,{name:"effects.shadow",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsxs)(T.lR,{children:["Shadow (Critical) ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(S.T,{placeholder:"The enhanced effect on a critical success...",...s,rows:3})}),(0,r.jsx)(T.C5,{})]})}}),(0,r.jsx)(T.zB,{name:"effects.end",control:H.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(T.eI,{children:[(0,r.jsxs)(T.lR,{children:["End ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(T.MJ,{children:(0,r.jsx)(S.T,{placeholder:"Effect at the end of a creature's turn...",...s,rows:2})})]})}})]}),(0,r.jsxs)(C.wL,{className:"flex items-center gap-2",children:[!t&&(0,r.jsxs)(z.Lt,{children:[(0,r.jsx)(z.tv,{asChild:!0,children:(0,r.jsx)(i.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(E.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(z.EO,{children:[(0,r.jsxs)(z.wd,{children:[(0,r.jsx)(z.r7,{children:"Are you sure?"}),(0,r.jsxs)(z.$v,{children:['This will permanently delete "',H.getValues("name"),'". This action cannot be undone.']})]}),(0,r.jsxs)(z.ck,{children:[(0,r.jsx)(z.Zr,{children:"Cancel"}),(0,r.jsx)(z.Rx,{onClick:Y,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,r.jsx)("div",{className:"flex-grow"}),!G&&(0,r.jsx)(i.$,{type:"button",variant:"outline",onClick:U,children:"Cancel"}),(0,r.jsx)(i.$,{type:"submit",children:t?"Create Deed":"Save Changes"})]})]})})})}):(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(C.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,r.jsxs)(C.Wu,{className:"text-center pt-6",children:[(0,r.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a deed to view"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})})}var $=t(2709),P=t(31);function W(){let[e,s]=(0,l.useState)(null),[t,a]=(0,l.useState)(0),[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[o,h]=(0,l.useState)(""),[x,u]=(0,l.useState)("all"),[j,m]=(0,l.useState)(""),[p,f]=(0,l.useState)("name"),[v,w]=(0,l.useState)("asc"),[y,N]=(0,l.useState)(!1),b=(0,I.a)(),[C,S]=(0,l.useState)("list");(0,l.useEffect)(()=>{N(!0)},[]);let z={searchTerm:o,tierFilter:x,tagFilter:j,sortBy:p,sortOrder:v},T={setSearchTerm:h,setTierFilter:u,setTagFilter:m,setSortBy:f,setSortOrder:w},F=(e,s)=>{s.shiftKey?(e.tierFilter&&u(e.tierFilter),e.tagFilter&&m(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter)):(u(e.tierFilter||"all"),m(e.tagFilter||""))},k=()=>{h(""),u("all"),m(""),f("name"),w("asc")},B=()=>a(e=>e+1),E=e=>{s(e),i(!1),d(null),b&&S("editor")},D=()=>{s(null),i(!0),d(null),b&&S("editor")},A=e=>{let t={...e};t.name="Copy of ".concat(e.name||"deed"),delete t.id,s(null),i(!0),d(t),b&&S("editor")},J=e=>{B(),s(e),i(!1),d(null),b&&S("editor")},V=()=>{B(),s(null),i(!1),d(null),b&&S("list")},q=()=>{n&&(i(!1),s(null),b&&S("list"))};return y?b?(0,r.jsx)($.A,{showSidebarTrigger:!1,children:(0,r.jsx)("div",{className:"h-full w-full",children:"list"===C?(0,r.jsx)(g,{onSelectDeed:E,onNewDeed:D,selectedDeedId:e,dataVersion:t,filters:z,setFilters:T,onClearFilters:k}):(0,r.jsx)("div",{className:"p-4 sm:p-6 h-full w-full overflow-y-auto",children:(0,r.jsx)(R,{deedId:e,isCreatingNew:n,template:c,onDeedSaveSuccess:J,onDeedDeleteSuccess:V,onUseAsTemplate:A,onEditCancel:q,dataVersion:t,onFilterByClick:F,onBack:()=>{S("list"),s(null),i(!1),d(null)}},null!=e?e:n?"new":"placeholder")})})}):(0,r.jsx)(P.GB,{children:(0,r.jsx)($.A,{children:(0,r.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,r.jsx)(P.Bx,{style:{"--sidebar-width":"380px"},children:(0,r.jsx)(g,{onSelectDeed:E,onNewDeed:D,selectedDeedId:e,dataVersion:t,filters:z,setFilters:T,onClearFilters:k})}),(0,r.jsx)(P.sF,{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,r.jsx)(R,{deedId:e,isCreatingNew:n,template:c,onDeedSaveSuccess:J,onDeedDeleteSuccess:V,onUseAsTemplate:A,onEditCancel:q,dataVersion:t,onFilterByClick:F},null!=e?e:n?"new":"placeholder")})})]})})}):null}},5599:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(157).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},8911:(e,s,t)=>{"use strict";t.d(s,{P:()=>n});var r=t(5155),l=t(9434),a=t(5057);let n=e=>{let{deed:s,dmgReplacement:t}=e,n=e=>{if(e)return t?e.replace(/\\dd/g,t):e},i="".concat(s.deedType," ").concat(s.actionType," VS ").concat(s.versus).toUpperCase(),c="".concat(i," | ").concat(s.target);return(0,r.jsxs)("div",{className:(0,l.cn)("rounded-lg border bg-card-foreground/5 border-l-4 p-4 mb-4",{light:"border-sky-400",heavy:"border-amber-400",mighty:"border-fuchsia-400"}[s.tier]),children:[(0,r.jsxs)("div",{className:"flex justify-between items-baseline mb-3",children:[(0,r.jsx)("h4",{className:"text-xl font-bold",children:s.name}),(0,r.jsx)("div",{className:(0,l.cn)("text-xs font-bold uppercase px-2 py-0.5 rounded-full",{light:"text-sky-300 bg-sky-900/50",heavy:"text-amber-300 bg-amber-900/50",mighty:"text-fuchsia-300 bg-fuchsia-900/50"}[s.tier]),children:s.tier})]}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground mb-3 border-b border-t border-border py-2",children:(0,r.jsx)("p",{className:"text-foreground/90",children:c})}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[s.effects.start&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Start"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.start)})]}),s.effects.base&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Base"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.base)})]}),s.effects.hit&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground font-semibold uppercase",children:"Hit"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.hit)})]}),s.effects.shadow&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground font-semibold uppercase",children:"Shadow"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.shadow)})]}),s.effects.end&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"End"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.end)})]})]})]})}},9279:(e,s,t)=>{Promise.resolve().then(t.bind(t,4437))}},e=>{var s=s=>e(e.s=s);e.O(0,[222,120,427,347,239,441,684,358],()=>s(9279)),_N_E=e.O()}]);