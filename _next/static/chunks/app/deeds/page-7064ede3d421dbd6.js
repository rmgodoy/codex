(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[230],{12543:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},13930:(e,s,t)=>{"use strict";t.d(s,{W$:()=>n,kO:()=>i,pT:()=>d,rp:()=>a,wz:()=>c,xy:()=>l});var r=t(82489);let l=async()=>{let e=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).getAll();return new Promise((s,t)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>t(e.error)})},a=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).get(e);return new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>t(s.error)})},n=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi),t=(0,r.$C)(),l={...e,id:t},a=s.add(l);return new Promise((e,s)=>{a.onsuccess=()=>e(t),a.onerror=()=>s(a.error)})},i=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).put(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},c=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).delete(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},d=async e=>{if(!e||0===e.length)return[];let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi),t=[],l=e.map(e=>new Promise((r,l)=>{let a=s.get(e);a.onsuccess=()=>{a.result&&t.push(a.result),r()},a.onerror=()=>l(a.error)}));return await Promise.all(l),t}},15599:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},19279:(e,s,t)=>{Promise.resolve().then(t.bind(t,46818))},20203:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},23062:(e,s,t)=>{"use strict";t.d(s,{FC:()=>l,GW:()=>r,H1:()=>m,OJ:()=>a,Rb:()=>h,Vx:()=>j,Vz:()=>u,Yh:()=>n,_d:()=>p,ag:()=>i,gG:()=>f,gV:()=>o,qY:()=>d,w$:()=>c,zE:()=>x});let r=["attack","support"],l=["melee","missile","innate","unarmed","spell","item","versatile"],a=["guard","resist","10","special"],n=["potion","powder","oil","bomb"],i=["lesser","greater"],c=["weapon","armor","shield","tool"],d=["crude","normal","fine"],o=["normal","magical","artifact"],h=["melee","missile","spell","unarmed"],x=["d4","d6","d8","d10","d12","d20"],u=["one-handed","two-handed","thrown"],m=["head","chest","arms","legs","outer"],j=["head","chest","arms","legs","outer","shield"],p=["None","Light","Heavy"],f=["d4","d6","d8","d10","d12","d20"]},34301:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},46818:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>H});var r=t(95155),l=t(12115),a=t(13930),n=t(62523),i=t(30285),c=t(66424),d=t(22346),o=t(87481),h=t(34301),x=t(75074),u=t(20203),m=t(73926),j=t(59409),p=t(85057),f=t(90648);function g(e){let{onSelectDeed:s,onNewDeed:t,selectedDeedId:g,dataVersion:v,filters:y,setFilters:w,onClearFilters:N}=e,[b,C]=(0,l.useState)([]),[S,k]=(0,l.useState)(!0),{toast:z}=(0,o.dj)();(0,l.useEffect)(()=>{(async()=>{k(!0);try{let e=await (0,a.xy)();C(e)}catch(e){console.error("Error fetching deeds:",e),z({variant:"destructive",title:"Error",description:"Could not fetch deeds from database."})}finally{k(!1)}})()},[v,z]);let T=(0,l.useMemo)(()=>{let e=b.filter(e=>{let s=e.name.toLowerCase().includes(y.searchTerm.toLowerCase()),t="all"===y.tierFilter||e.tier===y.tierFilter,r=!0,l=y.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return l.length>0&&(r=!!e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&t&&r}),s={light:1,heavy:2,mighty:3,tyrant:4,special:5},t=e.sort((e,t)=>{if("tier"===y.sortBy){let r=(s[e.tier]||0)-(s[t.tier]||0);if(0!==r)return r}return e.name.localeCompare(t.name)});return"desc"===y.sortOrder&&t.reverse(),t},[b,y]);return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)(i.$,{onClick:t,className:"w-full",children:[(0,r.jsx)(h.A,{})," New Deed"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(n.p,{placeholder:"Search deeds...",value:y.searchTerm,onChange:e=>w.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(p.J,{children:"Filter"}),(0,r.jsx)(i.$,{variant:"ghost",size:"sm",onClick:N,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,r.jsxs)(j.l6,{value:y.tierFilter,onValueChange:w.setTierFilter,children:[(0,r.jsx)(j.bq,{children:(0,r.jsx)(j.yv,{placeholder:"Filter by tier"})}),(0,r.jsxs)(j.gC,{children:[(0,r.jsx)(j.eb,{value:"all",children:"All Tiers"}),(0,r.jsx)(j.eb,{value:"light",children:"Light"}),(0,r.jsx)(j.eb,{value:"heavy",children:"Heavy"}),(0,r.jsx)(j.eb,{value:"mighty",children:"Mighty"}),(0,r.jsx)(j.eb,{value:"tyrant",children:"Tyrant"}),(0,r.jsx)(j.eb,{value:"special",children:"Special"})]})]}),(0,r.jsx)(f.F,{value:y.tagFilter?y.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>w.setTagFilter(e.join(",")),placeholder:"Tags (e.g. fire, control)",tagSource:"deed"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(p.J,{children:"Sort by"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(j.l6,{value:y.sortBy,onValueChange:e=>w.setSortBy(e),children:[(0,r.jsx)(j.bq,{children:(0,r.jsx)(j.yv,{placeholder:"Sort by"})}),(0,r.jsxs)(j.gC,{children:[(0,r.jsx)(j.eb,{value:"name",children:"Name"}),(0,r.jsx)(j.eb,{value:"tier",children:"Tier"})]})]}),(0,r.jsxs)(i.$,{variant:"ghost",size:"icon",onClick:()=>w.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===y.sortOrder?(0,r.jsx)(u.A,{className:"h-4 w-4"}):(0,r.jsx)(m.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,r.jsx)(d.w,{}),(0,r.jsx)(c.F,{className:"flex-1",children:(0,r.jsx)("div",{className:"p-4",children:S?(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading deeds..."}):T.length>0?(0,r.jsx)("ul",{className:"space-y-1",children:T.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(g===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,r.jsxs)("span",{className:"text-xs opacity-70",children:["(",e.tier,")"]})]})},e.id))}):(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"No deeds found."})})})]})}var v=t(62177),y=t(90221),w=t(55594),N=t(44218),b=t(23062),C=t(66695),S=t(88539),k=t(90010),z=t(17759),T=t(12543),A=t(15599),F=t(18763),B=t(77223),E=t(25318),D=t(53054),V=t(68856),q=t(88911),J=t(26126),M=t(47906);let L=w.z.object({start:w.z.string().optional(),base:w.z.string().optional(),hit:w.z.string().optional(),spark:w.z.string().optional(),shadow:w.z.string().optional(),after:w.z.string().optional()}),R=w.z.object({name:w.z.string().min(1,"Deed name is required"),tier:w.z.enum(["light","heavy","mighty","tyrant","special"]),actionType:w.z.enum(b.GW),deedType:w.z.enum(b.FC),versus:w.z.enum(b.OJ),target:w.z.string().optional(),effects:L,tags:w.z.array(w.z.string()).optional()}),I={name:"",tier:"light",actionType:"attack",deedType:"melee",versus:"guard",target:"",effects:{start:"",base:"",hit:"",spark:"",shadow:"",after:""},tags:[]};function O(e){let{deedId:s,isCreatingNew:t,template:c,onDeedSaveSuccess:h,onDeedDeleteSuccess:x,onUseAsTemplate:u,onEditCancel:m,dataVersion:p,onFilterByClick:g,onBack:w}=e,{toast:L}=(0,o.dj)(),[O,$]=(0,l.useState)(t),[P,H]=(0,l.useState)(!t&&!!s),[W,Z]=(0,l.useState)(null),_=(0,M.a)(),G=(0,v.mN)({resolver:(0,y.u)(R),defaultValues:c||I});(0,l.useEffect)(()=>{(async()=>{if(t){G.reset(c?{...c,tags:c.tags||[]}:I),Z(c||null),$(!0),H(!1);return}if(!s){$(!1),H(!1),Z(null);return}H(!0),$(!1);try{let e=await (0,a.rp)(s);if(e){let s={...e,tags:e.tags||[]};G.reset(s),Z(e)}else Z(null)}catch(e){console.error("Failed to fetch deed data:",e),L({variant:"destructive",title:"Error",description:"Could not load deed data."})}finally{H(!1)}})()},[s,t,c,G,L,p]);let U=()=>{if(t)m();else if(W){let e={...W,tags:W.tags||[]};G.reset(e),$(!1)}},Y=async e=>{try{let r={...e,tags:e.tags||[]},l=e.tags||[];if(l.length>0&&await (0,N.JE)(l,"deed"),t){let s=await (0,a.W$)(r);L({title:"Deed Created!",description:"".concat(e.name," has been added to the library.")}),h(s)}else s&&(await (0,a.kO)({...r,id:s}),L({title:"Save Successful",description:"".concat(e.name," has been updated.")}),h(s));$(!1)}catch(e){console.error("Failed to save deed:",e),L({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},K=async()=>{if(s)try{await (0,a.wz)(s),L({title:"Deed Deleted",description:"The deed has been removed from the library."}),x()}catch(e){console.error("Failed to delete deed:",e),L({variant:"destructive",title:"Deletion Failed",description:"Could not delete the deed."})}};return P?(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(C.Zp,{children:[(0,r.jsxs)(C.aR,{children:[(0,r.jsx)(V.E,{className:"h-8 w-48"}),(0,r.jsx)(V.E,{className:"h-4 w-32"})]}),(0,r.jsxs)(C.Wu,{className:"space-y-6",children:[(0,r.jsx)(V.E,{className:"h-10 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(V.E,{className:"h-10 w-full"}),(0,r.jsx)(V.E,{className:"h-10 w-full"})]}),(0,r.jsx)(d.w,{}),(0,r.jsx)(V.E,{className:"h-20 w-full"}),(0,r.jsx)(V.E,{className:"h-20 w-full"}),(0,r.jsx)(V.E,{className:"h-20 w-full"})]})]})}):s||t?!O&&W?(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(C.Zp,{children:[(0,r.jsx)(C.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[_&&w&&(0,r.jsx)(i.$,{variant:"ghost",size:"icon",onClick:w,className:"-ml-4 -mt-2",children:(0,r.jsx)(T.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(C.ZB,{className:"text-3xl font-bold",children:W.name}),(0,r.jsx)(C.BT,{className:"mt-1 capitalize",children:(0,r.jsx)("button",{onClick:e=>g({tierFilter:W.tier},e),className:"hover:underline p-0 bg-transparent text-inherit",children:W.tier})})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{W&&u(W)},children:[(0,r.jsx)(A.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Template"})]}),(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>$(!0),children:[(0,r.jsx)(F.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Edit"})]})]})]})}),(0,r.jsxs)(C.Wu,{children:[(0,r.jsx)(q.P,{deed:W}),W.tags&&W.tags.length>0&&(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:W.tags.map(e=>(0,r.jsx)("button",{onClick:s=>g({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,r.jsx)(J.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]}),(0,r.jsx)(C.wL,{children:(0,r.jsxs)(k.Lt,{children:[(0,r.jsx)(k.tv,{asChild:!0,children:(0,r.jsx)(i.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(B.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(k.EO,{children:[(0,r.jsxs)(k.wd,{children:[(0,r.jsx)(k.r7,{children:"Are you sure?"}),(0,r.jsxs)(k.$v,{children:['This will permanently delete "',G.getValues("name"),'". This action cannot be undone.']})]}),(0,r.jsxs)(k.ck,{children:[(0,r.jsx)(k.Zr,{children:"Cancel"}),(0,r.jsx)(k.Rx,{onClick:K,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(C.Zp,{children:(0,r.jsx)(z.lV,{...G,children:(0,r.jsxs)("form",{onSubmit:G.handleSubmit(Y),className:"space-y-6",children:[(0,r.jsx)(C.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[_&&w&&(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"icon",onClick:U,className:"-ml-4",children:(0,r.jsx)(T.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(C.ZB,{children:t?_?"New Deed":"Create a New Deed":"Editing: ".concat(G.getValues("name")||"...")}),(0,r.jsx)(C.BT,{children:t?"Fill out the details for your new deed.":"Make your changes and click Save."})]})]}),!_&&(0,r.jsx)(i.$,{type:"button",variant:"ghost",size:"icon",onClick:U,className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(E.A,{className:"h-5 w-5"})})]})}),(0,r.jsxs)(C.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(z.zB,{name:"name",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.lR,{children:"Deed Name"}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(n.p,{placeholder:"e.g., Inferno",...s})}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(z.zB,{name:"tier",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.lR,{children:"Tier"}),(0,r.jsxs)(j.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(z.MJ,{children:(0,r.jsx)(j.bq,{children:(0,r.jsx)(j.yv,{placeholder:"Select tier"})})}),(0,r.jsxs)(j.gC,{children:[(0,r.jsx)(j.eb,{value:"light",children:"Light"}),(0,r.jsx)(j.eb,{value:"heavy",children:"Heavy"}),(0,r.jsx)(j.eb,{value:"mighty",children:"Mighty"}),(0,r.jsx)(j.eb,{value:"tyrant",children:"Tyrant"}),(0,r.jsx)(j.eb,{value:"special",children:"Special"})]})]}),(0,r.jsx)(z.C5,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(z.zB,{name:"deedType",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.lR,{children:"Deed Type"}),(0,r.jsxs)(j.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(z.MJ,{children:(0,r.jsx)(j.bq,{children:(0,r.jsx)(j.yv,{placeholder:"Select deed type"})})}),(0,r.jsx)(j.gC,{children:b.FC.map(e=>(0,r.jsx)(j.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(z.zB,{name:"actionType",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.lR,{children:"Action Type"}),(0,r.jsxs)(j.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(z.MJ,{children:(0,r.jsx)(j.bq,{children:(0,r.jsx)(j.yv,{placeholder:"Select action type"})})}),(0,r.jsx)(j.gC,{children:b.GW.map(e=>(0,r.jsx)(j.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(z.zB,{name:"versus",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.lR,{children:"Versus"}),(0,r.jsxs)(j.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,r.jsx)(z.MJ,{children:(0,r.jsx)(j.bq,{children:(0,r.jsx)(j.yv,{placeholder:"Select versus"})})}),(0,r.jsx)(j.gC,{children:b.OJ.map(e=>(0,r.jsx)(j.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(z.C5,{})]})}})]}),(0,r.jsx)(z.zB,{name:"target",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsx)(z.lR,{children:"Target"}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(n.p,{placeholder:"e.g., 1 Creature | Blast 4",...s})}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(z.zB,{name:"tags",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{className:"flex items-center gap-2",children:[(0,r.jsx)(D.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(f.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"deed"})}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(d.w,{}),(0,r.jsx)("h4",{className:"font-semibold text-primary-foreground",children:"Effects"}),(0,r.jsx)(z.zB,{name:"effects.start",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{children:["Start ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(S.T,{placeholder:"Effect when a creature starts its turn in an area...",...s,rows:2})})]})}}),(0,r.jsx)(z.zB,{name:"effects.base",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{children:["Base ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(S.T,{placeholder:"Base effect of the deed...",...s,rows:2})})]})}}),(0,r.jsx)(z.zB,{name:"effects.hit",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{children:["Hit ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(S.T,{placeholder:"The primary effect on a successful hit...",...s,rows:3})}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(z.zB,{name:"effects.spark",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{children:["Spark (Critical Hit) ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(S.T,{placeholder:"The effect on a critical hit...",...s,rows:2})})]})}}),(0,r.jsx)(z.zB,{name:"effects.shadow",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{children:["Shadow (Critical Failure) ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(S.T,{placeholder:"The effect on a critical failure...",...s,rows:3})}),(0,r.jsx)(z.C5,{})]})}}),(0,r.jsx)(z.zB,{name:"effects.after",control:G.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(z.eI,{children:[(0,r.jsxs)(z.lR,{children:["After ",(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,r.jsx)(z.MJ,{children:(0,r.jsx)(S.T,{placeholder:"Effect at the end of a creature's turn...",...s,rows:2})})]})}})]}),(0,r.jsxs)(C.wL,{className:"flex items-center gap-2",children:[!t&&(0,r.jsxs)(k.Lt,{children:[(0,r.jsx)(k.tv,{asChild:!0,children:(0,r.jsx)(i.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(B.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(k.EO,{children:[(0,r.jsxs)(k.wd,{children:[(0,r.jsx)(k.r7,{children:"Are you sure?"}),(0,r.jsxs)(k.$v,{children:['This will permanently delete "',G.getValues("name"),'". This action cannot be undone.']})]}),(0,r.jsxs)(k.ck,{children:[(0,r.jsx)(k.Zr,{children:"Cancel"}),(0,r.jsx)(k.Rx,{onClick:K,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,r.jsx)("div",{className:"flex-grow"}),!_&&(0,r.jsx)(i.$,{type:"button",variant:"outline",onClick:U,children:"Cancel"}),(0,r.jsx)(i.$,{type:"submit",children:t?"Create Deed":"Save Changes"})]})]})})})}):(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(C.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,r.jsxs)(C.Wu,{className:"text-center pt-6",children:[(0,r.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a deed to view"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})})}var $=t(62709),P=t(20031);function H(){let[e,s]=(0,l.useState)(null),[t,a]=(0,l.useState)(0),[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[o,h]=(0,l.useState)(""),[x,u]=(0,l.useState)("all"),[m,j]=(0,l.useState)(""),[p,f]=(0,l.useState)("name"),[v,y]=(0,l.useState)("asc"),[w,N]=(0,l.useState)(!1),b=(0,M.a)(),[C,S]=(0,l.useState)("list");(0,l.useEffect)(()=>{N(!0)},[]);let k={searchTerm:o,tierFilter:x,tagFilter:m,sortBy:p,sortOrder:v},z={setSearchTerm:h,setTierFilter:u,setTagFilter:j,setSortBy:f,setSortOrder:y},T=(e,s)=>{s.shiftKey?(e.tierFilter&&u(e.tierFilter),e.tagFilter&&j(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter)):(u(e.tierFilter||"all"),j(e.tagFilter||""))},A=()=>{h(""),u("all"),j(""),f("name"),y("asc")},F=()=>a(e=>e+1),B=e=>{s(e),i(!1),d(null),b&&S("editor")},E=()=>{s(null),i(!0),d(null),b&&S("editor")},D=e=>{let t={...e};t.name="Copy of ".concat(e.name||"deed"),delete t.id,s(null),i(!0),d(t),b&&S("editor")},V=e=>{F(),s(e),i(!1),d(null),b&&S("editor")},q=()=>{F(),s(null),i(!1),d(null),b&&S("list")},J=()=>{n&&(i(!1),s(null),b&&S("list"))};return w?b?(0,r.jsx)($.A,{showSidebarTrigger:!1,children:(0,r.jsx)("div",{className:"h-full w-full",children:"list"===C?(0,r.jsx)(g,{onSelectDeed:B,onNewDeed:E,selectedDeedId:e,dataVersion:t,filters:k,setFilters:z,onClearFilters:A}):(0,r.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,r.jsx)("div",{className:"p-4 sm:p-6",children:(0,r.jsx)(O,{deedId:e,isCreatingNew:n,template:c,onDeedSaveSuccess:V,onDeedDeleteSuccess:q,onUseAsTemplate:D,onEditCancel:J,dataVersion:t,onFilterByClick:T,onBack:()=>{S("list"),s(null),i(!1),d(null)}},null!=e?e:n?"new":"placeholder")})})})}):(0,r.jsx)(P.GB,{children:(0,r.jsx)($.A,{children:(0,r.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,r.jsx)(P.Bx,{style:{"--sidebar-width":"380px"},children:(0,r.jsx)(g,{onSelectDeed:B,onNewDeed:E,selectedDeedId:e,dataVersion:t,filters:k,setFilters:z,onClearFilters:A})}),(0,r.jsx)(P.sF,{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,r.jsx)(O,{deedId:e,isCreatingNew:n,template:c,onDeedSaveSuccess:V,onDeedDeleteSuccess:q,onUseAsTemplate:D,onEditCancel:J,dataVersion:t,onFilterByClick:T},null!=e?e:n?"new":"placeholder")})})]})})}):null}},53054:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},68856:(e,s,t)=>{"use strict";t.d(s,{E:()=>a});var r=t(95155),l=t(59434);function a(e){let{className:s,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-muted",s),...t})}},73926:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},75074:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},88911:(e,s,t)=>{"use strict";t.d(s,{P:()=>n});var r=t(95155),l=t(59434),a=t(85057);let n=e=>{let{deed:s,dmgReplacement:t}=e,n=e=>{if(e)return t?e.replace(/\\dd/g,t):e},i="".concat(s.deedType," ").concat(s.actionType," VS ").concat(s.versus).toUpperCase(),c="".concat(i," | ").concat(s.target);return(0,r.jsxs)("div",{className:(0,l.cn)("rounded-lg border bg-card-foreground/5 border-l-4 p-4 mb-4",{light:"border-sky-400",heavy:"border-amber-400",mighty:"border-fuchsia-400",tyrant:"border-red-600",special:"border-yellow-400"}[s.tier]),children:[(0,r.jsxs)("div",{className:"flex justify-between items-baseline mb-3",children:[(0,r.jsx)("h4",{className:"text-xl font-bold",children:s.name}),(0,r.jsx)("div",{className:(0,l.cn)("text-xs font-bold uppercase px-2 py-0.5 rounded-full",{light:"text-sky-300 bg-sky-900/50",heavy:"text-amber-300 bg-amber-900/50",mighty:"text-fuchsia-300 bg-fuchsia-900/50",tyrant:"text-red-300 bg-red-900/50",special:"text-yellow-300 bg-yellow-900/50"}[s.tier]),children:s.tier})]}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground mb-3 border-b border-t border-border py-2",children:(0,r.jsx)("p",{className:"text-foreground/90",children:c})}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[s.effects.start&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Start"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.start)})]}),s.effects.base&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Base"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.base)})]}),s.effects.hit&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground font-semibold uppercase",children:"Hit"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.hit)})]}),s.effects.spark&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Spark (Critical Hit)"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.spark)})]}),s.effects.shadow&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground font-semibold uppercase",children:"Shadow (Critical Failure)"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.shadow)})]}),s.effects.after&&(0,r.jsxs)("div",{children:[(0,r.jsx)(a.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"After"}),(0,r.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.after)})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[222,194,160,49,347,516,441,684,358],()=>s(19279)),_N_E=e.O()}]);