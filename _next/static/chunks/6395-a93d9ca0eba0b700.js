"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6395],{46395:(e,s,t)=>{t.r(s),t.d(s,{default:()=>U});var l=t(95155),a=t(12115),r=t(99982),n=t(20031),i=t(47906),c=t(92745),d=t(62523),o=t(30285),m=t(66424),x=t(22346),u=t(87481),h=t(34301),j=t(75074),p=t(20203),f=t(73926),g=t(85057),N=t(59409),v=t(90648);function w(e){let{onSelectItem:s,onNewItem:t,selectedItemId:r,dataVersion:n,filters:i,setFilters:w,onClearFilters:y}=e,[b,C]=(0,a.useState)([]),[S,I]=(0,a.useState)(!0),{toast:z}=(0,u.dj)();(0,a.useEffect)(()=>{(async()=>{I(!0);try{C(await (0,c.SP)())}catch(e){z({variant:"destructive",title:"Error",description:"Could not fetch rooms from database."})}finally{I(!1)}})()},[n,z]);let k=(0,a.useMemo)(()=>{let e=b.filter(e=>{let s=e.name.toLowerCase().includes(i.searchTerm.toLowerCase()),t=!0,l=i.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return l.length>0&&(t=!!e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&t}).sort((e,s)=>e.name.localeCompare(s.name));return"desc"===i.sortOrder&&e.reverse(),e},[b,i]);return(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)(o.$,{onClick:t,className:"w-full",children:[(0,l.jsx)(h.A,{})," New Room"]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.p,{placeholder:"Search rooms...",value:i.searchTerm,onChange:e=>w.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(g.J,{children:"Filter"}),(0,l.jsx)(o.$,{variant:"ghost",size:"sm",onClick:y,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,l.jsx)(v.F,{value:i.tagFilter?i.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>w.setTagFilter(e.join(",")),placeholder:"Tags (e.g. dungeon, trap)",tagSource:"room"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(g.J,{children:"Sort by"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(N.l6,{value:i.sortBy,onValueChange:e=>w.setSortBy(e),children:[(0,l.jsx)(N.bq,{children:(0,l.jsx)(N.yv,{placeholder:"Sort by"})}),(0,l.jsx)(N.gC,{children:(0,l.jsx)(N.eb,{value:"name",children:"Name"})})]}),(0,l.jsxs)(o.$,{variant:"ghost",size:"icon",onClick:()=>w.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===i.sortOrder?(0,l.jsx)(p.A,{className:"h-4 w-4"}):(0,l.jsx)(f.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,l.jsx)(x.w,{}),(0,l.jsx)(m.F,{className:"flex-1",children:(0,l.jsx)("div",{className:"p-4",children:S?(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading rooms..."}):k.length>0?(0,l.jsx)("ul",{className:"space-y-1",children:k.map(e=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(r===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:e.name})},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"No rooms found."})})})]})}var y=t(62177),b=t(90221),C=t(55594),S=t(66695),I=t(88539),z=t(90010),k=t(17759),T=t(12543),F=t(18763),A=t(73503),V=t(98917),E=t(22945),B=t(77223),R=t(25318),$=t(53054),L=t(18046),M=t(21887),D=t(68856),J=t(26126),O=t(54165),Z=t(47262),_=t(8643);let q=C.z.object({id:C.z.string(),title:C.z.string().min(1,"Feature title is required"),description:C.z.string().min(1,"Feature description is required"),encounterIds:C.z.array(C.z.string()),treasureIds:C.z.array(C.z.string()),alchemicalItemIds:C.z.array(C.z.string())}),W=C.z.object({name:C.z.string().min(1,"Room name is required"),description:C.z.string().optional(),size:C.z.string().optional(),tags:C.z.array(C.z.string()).optional(),features:C.z.array(q),totalTreasureValue:C.z.coerce.number()}),P=e=>{let{triggerButton:s,dialogTitle:t,items:r,onSelectItems:n,initialSelectedIds:i=[]}=e,[c,x]=(0,a.useState)(!1),[u,h]=(0,a.useState)(new Set(i)),[j,p]=(0,a.useState)(""),f=(0,a.useMemo)(()=>{let e=r.filter(e=>e.name.toLowerCase().includes(j.toLowerCase()));return e.sort((e,s)=>{let t=u.has(e.id),l=u.has(s.id);return t&&!l?-1:!t&&l?1:e.name.localeCompare(s.name)}),e},[r,j,u]),g=e=>{h(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})};return(0,l.jsxs)(O.lG,{open:c,onOpenChange:e=>{e&&h(new Set(i)),x(e)},children:[(0,l.jsx)(O.zM,{asChild:!0,children:s}),(0,l.jsxs)(O.Cf,{className:"max-w-lg h-[70vh] flex flex-col",children:[(0,l.jsx)(O.c7,{children:(0,l.jsx)(O.L3,{children:t})}),(0,l.jsx)(d.p,{placeholder:"Search...",value:j,onChange:e=>p(e.target.value),className:"mb-4 shrink-0"}),(0,l.jsx)(m.F,{className:"flex-1 border rounded-md p-2",children:(0,l.jsx)("div",{className:"space-y-1",children:f.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-md",children:[(0,l.jsx)(Z.S,{id:"item-".concat(e.id),onCheckedChange:()=>g(e.id),checked:u.has(e.id)}),(0,l.jsxs)("label",{htmlFor:"item-".concat(e.id),className:"flex-1",children:[(0,l.jsx)("p",{className:"font-semibold",children:e.name}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[void 0!==e.value&&"Value: ".concat(e.value),e.type&&"Type: ".concat(e.type)]})]})]},e.id))})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 pt-4 shrink-0",children:[(0,l.jsx)(o.$,{variant:"ghost",onClick:()=>x(!1),children:"Cancel"}),(0,l.jsx)(o.$,{onClick:()=>{n(Array.from(u)),x(!1)},children:"Confirm"})]})]})]})},G={name:"",description:"",size:"",tags:[],features:[],totalTreasureValue:0};function K(e){let{roomId:s,isCreatingNew:t,onSaveSuccess:r,onDeleteSuccess:n,onEditCancel:m,onFilterByClick:h,onBack:j,dataVersion:p}=e,{toast:f}=(0,u.dj)(),[g,N]=(0,a.useState)(t),[w,C]=(0,a.useState)(!t&&!!s),[O,Z]=(0,a.useState)(null),[q,K]=(0,a.useState)([]),[U,H]=(0,a.useState)([]),[X,Q]=(0,a.useState)([]),Y=(0,i.a)(),ee=(0,a.useMemo)(()=>({encounters:new Map(q.map(e=>[e.id,e])),treasures:new Map(U.map(e=>[e.id,e])),alchemicalItems:new Map(X.map(e=>[e.id,e]))}),[q,U,X]),es=(0,y.mN)({resolver:(0,b.u)(W),defaultValues:G}),{fields:et,append:el,remove:ea}=(0,y.jz)({control:es.control,name:"features"}),er=es.watch("features");(0,a.useEffect)(()=>{if(g){let e=er.reduce((e,s)=>e+s.treasureIds.reduce((e,s)=>{let t=ee.treasures.get(s);return e+((null==t?void 0:t.value)||0)},0),0);es.getValues("totalTreasureValue")!==e&&es.setValue("totalTreasureValue",e,{shouldValidate:!0})}},[er,ee.treasures,es,g]),(0,a.useEffect)(()=>{Promise.all([(0,c.eS)(),(0,c.h4)(),(0,c.vV)()]).then(e=>{let[s,t,l]=e;K(s),H(t),Q(l)})},[]),(0,a.useEffect)(()=>{(async()=>{if(t){es.reset(G),Z(null),N(!0),C(!1);return}if(!s){N(!1),C(!1),Z(null);return}C(!0),N(!1);try{let e=await (0,c._w)(s);e?(es.reset(e),Z(e)):Z(null)}catch(e){f({variant:"destructive",title:"Error",description:"Could not load room data."})}finally{C(!1)}})()},[s,t,es,f,p]);let en=()=>{t?m():O&&(es.reset(O),N(!1))},ei=async e=>{try{let l,a={...e,tags:e.tags||[]},n=e.tags||[];if(n.length>0&&await (0,c.JE)(n,"room"),t)l=await (0,c.TG)(a),f({title:"Room Created!",description:"".concat(e.name," has been added.")});else{if(!s)return;l=s,await (0,c.xX)({...a,id:s}),f({title:"Save Successful",description:"".concat(e.name," has been updated.")})}r(l),N(!1)}catch(e){f({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},ec=async()=>{if(s)try{await (0,c.HN)(s),f({title:"Room Deleted",description:"The room has been removed."}),n()}catch(e){f({variant:"destructive",title:"Deletion Failed",description:"Could not delete the room."})}};return w?(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(S.Zp,{children:[(0,l.jsx)(S.aR,{children:(0,l.jsx)(D.E,{className:"h-8 w-48"})}),(0,l.jsx)(S.Wu,{children:(0,l.jsx)(D.E,{className:"h-40 w-full"})})]})}):s||t?!g&&O?(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(S.Zp,{children:[(0,l.jsx)(S.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[Y&&j&&(0,l.jsx)(o.$,{variant:"ghost",size:"icon",onClick:j,className:"shrink-0 -ml-2 -mt-1",children:(0,l.jsx)(T.A,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(S.ZB,{className:"text-3xl font-bold",children:O.name}),(0,l.jsxs)(S.BT,{className:"flex flex-wrap gap-x-4",children:[O.size&&(0,l.jsxs)("span",{children:["Size: ",O.size]}),(0,l.jsxs)("span",{children:["Total Value: ",O.totalTreasureValue]})]})]})]}),(0,l.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>N(!0),children:[(0,l.jsx)(F.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})}),(0,l.jsx)(S.Wu,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[O.description&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Description"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:O.description})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Features"}),O.features.length>0?(0,l.jsx)("ul",{className:"space-y-4",children:O.features.map(e=>(0,l.jsxs)("li",{className:"p-3 bg-card-foreground/5 rounded-lg",children:[(0,l.jsx)("p",{className:"font-semibold",children:e.title}),e.encounterIds.length>0&&(0,l.jsxs)("div",{className:"mt-2 pl-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,l.jsx)(A.A,{className:"h-4 w-4"})," Linked Encounters"]}),(0,l.jsx)("ul",{className:"list-disc list-inside mt-1",children:e.encounterIds.map(e=>{var s;return(0,l.jsx)("li",{className:"text-sm text-accent",children:(null==(s=ee.encounters.get(e))?void 0:s.name)||"..."},e)})})]}),e.treasureIds.length>0&&(0,l.jsxs)("div",{className:"mt-2 pl-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,l.jsx)(V.A,{className:"h-4 w-4"})," Linked Treasures"]}),(0,l.jsx)("ul",{className:"list-disc list-inside mt-1",children:e.treasureIds.map(e=>{var s;return(0,l.jsx)("li",{className:"text-sm text-accent",children:(null==(s=ee.treasures.get(e))?void 0:s.name)||"..."},e)})})]}),e.alchemicalItemIds.length>0&&(0,l.jsxs)("div",{className:"mt-2 pl-4",children:[(0,l.jsxs)("h4",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,l.jsx)(E.A,{className:"h-4 w-4"})," Linked Alchemy"]}),(0,l.jsx)("ul",{className:"list-disc list-inside mt-1",children:e.alchemicalItemIds.map(e=>{var s;return(0,l.jsx)("li",{className:"text-sm text-accent",children:(null==(s=ee.alchemicalItems.get(e))?void 0:s.name)||"..."},e)})})]})]},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground",children:"No features defined for this room."})]}),O.tags&&O.tags.length>0&&(0,l.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:O.tags.map(e=>(0,l.jsx)("button",{onClick:s=>h({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,l.jsx)(J.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]})}),(0,l.jsx)(S.wL,{children:(0,l.jsxs)(z.Lt,{children:[(0,l.jsx)(z.tv,{asChild:!0,children:(0,l.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(B.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(z.EO,{children:[(0,l.jsxs)(z.wd,{children:[(0,l.jsx)(z.r7,{children:"Are you sure?"}),(0,l.jsxs)(z.$v,{children:['This will permanently delete "',O.name,'".']})]}),(0,l.jsxs)(z.ck,{children:[(0,l.jsx)(z.Zr,{children:"Cancel"}),(0,l.jsx)(z.Rx,{onClick:ec,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(S.Zp,{children:(0,l.jsx)(k.lV,{...es,children:(0,l.jsxs)("form",{onSubmit:es.handleSubmit(ei),className:"space-y-6",children:[(0,l.jsx)(S.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[Y&&j&&(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:m,className:"shrink-0 -ml-2",children:(0,l.jsx)(T.A,{className:"h-5 w-5"})}),(0,l.jsx)(S.ZB,{children:t?"Create New Room":"Editing: ".concat(es.getValues("name")||"...")})]}),!Y&&(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:en,className:"text-muted-foreground hover:text-foreground",children:(0,l.jsx)(R.A,{className:"h-5 w-5"})})]})}),(0,l.jsxs)(S.Wu,{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(k.zB,{name:"name",control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsx)(k.lR,{children:"Name"}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(d.p,{...s})}),(0,l.jsx)(k.C5,{})]})}}),(0,l.jsx)(k.zB,{name:"size",control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsx)(k.lR,{children:"Size"}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(d.p,{...s,placeholder:"e.g., 30ft x 40ft"})})]})}})]}),(0,l.jsx)(k.zB,{name:"totalTreasureValue",control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsx)(k.lR,{children:"Total Treasure Value"}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s,readOnly:!0,className:"w-28 bg-muted border-none"})})]})}}),(0,l.jsx)(k.zB,{name:"description",control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsx)(k.lR,{children:"Description"}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(I.T,{...s,rows:4})})]})}}),(0,l.jsx)(k.zB,{name:"tags",control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsxs)(k.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)($.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(v.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"room"})}),(0,l.jsx)(k.C5,{})]})}}),(0,l.jsx)(x.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Room Features"}),(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",onClick:()=>{el({id:crypto.randomUUID(),title:"",description:"",encounterIds:[],treasureIds:[],alchemicalItemIds:[]})},children:[(0,l.jsx)(L.A,{className:"h-4 w-4 mr-2"})," Add Feature"]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[et.map((e,s)=>(0,l.jsxs)(_.Nt,{className:"border bg-card-foreground/5 rounded-lg p-3",defaultOpen:!es.watch("features.".concat(s,".title")),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(_.R6,{asChild:!0,children:(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-3 text-left w-full",children:[(0,l.jsx)(M.A,{className:"h-5 w-5 text-muted-foreground"}),(0,l.jsx)("span",{className:"text-lg font-semibold text-primary-foreground",children:es.watch("features.".concat(s,".title"))||"New Feature"})]})}),(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ea(s),className:"text-muted-foreground hover:text-destructive shrink-0",children:(0,l.jsx)(B.A,{className:"h-4 w-4"})})]}),(0,l.jsxs)(_.Ke,{className:"mt-4 space-y-4",children:[(0,l.jsx)(k.zB,{name:"features.".concat(s,".title"),control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsx)(k.lR,{children:"Title"}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(d.p,{...s})}),(0,l.jsx)(k.C5,{})]})}}),(0,l.jsx)(k.zB,{name:"features.".concat(s,".description"),control:es.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(k.eI,{children:[(0,l.jsx)(k.lR,{children:"Description"}),(0,l.jsx)(k.MJ,{children:(0,l.jsx)(I.T,{...s,rows:2})}),(0,l.jsx)(k.C5,{})]})}}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 justify-end",children:[(0,l.jsx)(P,{triggerButton:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 mr-2"})," Encounters"]}),dialogTitle:"Link Encounters",items:q.map(e=>({id:e.id,name:e.name,value:e.totalTR||0})),onSelectItems:e=>es.setValue("features.".concat(s,".encounterIds"),e),initialSelectedIds:es.getValues("features.".concat(s,".encounterIds"))}),(0,l.jsx)(P,{triggerButton:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(V.A,{className:"h-4 w-4 mr-2"})," Treasures"]}),dialogTitle:"Link Treasures",items:U,onSelectItems:e=>es.setValue("features.".concat(s,".treasureIds"),e),initialSelectedIds:es.getValues("features.".concat(s,".treasureIds"))}),(0,l.jsx)(P,{triggerButton:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(E.A,{className:"h-4 w-4 mr-2"})," Alchemy"]}),dialogTitle:"Link Alchemical Items",items:X.map(e=>({id:e.id,name:e.name,type:e.type})),onSelectItems:e=>es.setValue("features.".concat(s,".alchemicalItemIds"),e),initialSelectedIds:es.getValues("features.".concat(s,".alchemicalItemIds"))})]})]})]},e.id)),0===et.length&&(0,l.jsx)("p",{className:"text-muted-foreground text-center text-sm py-4",children:"No features added to this room."})]})]})]}),(0,l.jsxs)(S.wL,{className:"flex items-center gap-2",children:[!t&&(0,l.jsxs)(z.Lt,{children:[(0,l.jsx)(z.tv,{asChild:!0,children:(0,l.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(B.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(z.EO,{children:[(0,l.jsxs)(z.wd,{children:[(0,l.jsx)(z.r7,{children:"Are you sure?"}),(0,l.jsxs)(z.$v,{children:['This will permanently delete "',es.getValues("name"),'".']})]}),(0,l.jsxs)(z.ck,{children:[(0,l.jsx)(z.Zr,{children:"Cancel"}),(0,l.jsx)(z.Rx,{onClick:ec,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,l.jsx)("div",{className:"flex-grow"}),!Y&&(0,l.jsx)(o.$,{type:"button",variant:"outline",onClick:en,children:"Cancel"}),(0,l.jsx)(o.$,{type:"submit",children:t?"Create Room":"Save Changes"})]})]})})})}):(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(S.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,l.jsx)(S.Wu,{className:"text-center pt-6",children:(0,l.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a room to view or create a new one."})})})})}function U(){let[e,s]=(0,a.useState)(null),[t,c]=(0,a.useState)(!1),[d,o]=(0,a.useState)(0),[m,x]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[j,p]=(0,a.useState)("name"),[f,g]=(0,a.useState)("asc"),[N,v]=(0,a.useState)(!1),y=(0,i.a)(),[b,C]=(0,a.useState)("list");(0,a.useEffect)(()=>{v(!0)},[]);let S={searchTerm:m,tagFilter:u,sortBy:j,sortOrder:f},I={setSearchTerm:x,setTagFilter:h,setSortBy:p,setSortOrder:g},z=(e,s)=>{s.shiftKey?e.tagFilter&&h(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter):h(e.tagFilter||"")},k=()=>{x(""),h(""),p("name"),g("asc")},T=()=>o(e=>e+1),F=e=>{s(e),c(!1),y&&C("editor")},A=()=>{s(null),c(!0),y&&C("editor")},V=e=>{T(),s(e),c(!1),y&&C("editor")},E=()=>{T(),s(null),c(!1),y&&C("list")},B=()=>{t&&(c(!1),s(null),y&&C("list"))};return N?y?(0,l.jsx)(r.A,{showSidebarTrigger:!1,children:(0,l.jsx)("div",{className:"h-full w-full",children:"list"===b?(0,l.jsx)(w,{onSelectItem:F,onNewItem:A,selectedItemId:e,dataVersion:d,filters:S,setFilters:I,onClearFilters:k}):(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)("div",{className:"p-4 sm:p-6",children:(0,l.jsx)(K,{roomId:e,isCreatingNew:t,onSaveSuccess:V,onDeleteSuccess:E,onEditCancel:B,onFilterByClick:z,onBack:()=>{C("list"),s(null),c(!1)},dataVersion:d},null!=e?e:t?"new":"placeholder")})})})}):(0,l.jsx)(n.SidebarProvider,{children:(0,l.jsx)(r.A,{children:(0,l.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,l.jsx)(n.Bx,{style:{"--sidebar-width":"380px"},children:(0,l.jsx)(w,{onSelectItem:F,onNewItem:A,selectedItemId:e,dataVersion:d,filters:S,setFilters:I,onClearFilters:k})}),(0,l.jsx)(n.sF,{className:"flex-1 overflow-y-auto",children:(0,l.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,l.jsx)(K,{roomId:e,isCreatingNew:t,onSaveSuccess:V,onDeleteSuccess:E,onEditCancel:B,onFilterByClick:z,dataVersion:d},null!=e?e:t?"new":"placeholder")})})]})})}):null}}}]);