"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[371],{50371:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ee});var s=a(95155),l=a(12115),n=a(80644),r=a(52873),i=a(7860),c=a(83013),d=a(76959),o=a(1077),x=a(99982),h=a(66695),m=a(30285),u=a(87481),j=a(62177),p=a(90221),v=a(55594),f=a(92745),g=a(54165),w=a(17759),N=a(62523),y=a(88539),b=a(14636),C=a(90648),D=a(59434),S=a(51920),A=a(25318),k=a(50286),z=a(91721),E=a(83662),P=a(965),$=a(73158),_=a(58049);function F(e){let{className:t,classNames:a,showOutsideDays:l=!0,...n}=e;return(0,s.jsx)(_.hv,{showOutsideDays:l,className:(0,D.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,D.cn)((0,m.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,D.cn)((0,m.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,s.jsx)(P.A,{className:(0,D.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,s.jsx)($.A,{className:(0,D.cn)("h-4 w-4",t),...a})}},...n})}F.displayName="Calendar";var I=a(66424);function M(e){let{items:t,onSelectItem:a,trigger:n,title:r}=e,[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(""),x=(0,l.useMemo)(()=>t.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())),[t,d]),h=e=>{a(e),c(!1),o("")};return(0,s.jsxs)(g.lG,{open:i,onOpenChange:c,children:[(0,s.jsx)(g.zM,{asChild:!0,children:n}),(0,s.jsxs)(g.Cf,{className:"max-w-md h-[60vh] flex flex-col",children:[(0,s.jsx)(g.c7,{children:(0,s.jsx)(g.L3,{children:r})}),(0,s.jsx)(N.p,{placeholder:"Search...",value:d,onChange:e=>o(e.target.value),className:"mb-4 shrink-0"}),(0,s.jsx)(I.F,{className:"flex-1 border rounded-md p-2",children:x.map(e=>(0,s.jsx)(m.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>h(e),children:e.name},e.id))})]})]})}var T=a(59409),L=a(19209);function O(e){let{children:t,onLocationSelect:a}=e,[n,r]=(0,l.useState)(!1),[i,c]=(0,l.useState)([]),[d,o]=(0,l.useState)(null),[x,h]=(0,l.useState)(null),[u,j]=(0,l.useState)(null);return(0,l.useEffect)(()=>{n&&(0,f.xW)().then(e=>{c(e),e.length>0&&o(e[0].id)})},[n]),(0,l.useEffect)(()=>{d?(0,f.zU)(d).then(e=>{h(e||null),j(null)}):h(null)},[d]),(0,s.jsxs)(g.lG,{open:n,onOpenChange:r,children:[(0,s.jsx)(g.zM,{asChild:!0,children:t}),(0,s.jsxs)(g.Cf,{className:"sm:max-w-4xl h-[90vh] sm:h-[80vh] flex flex-col",children:[(0,s.jsx)(g.c7,{children:(0,s.jsx)(g.L3,{children:"Select a Location"})}),(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 border-b",children:[(0,s.jsxs)(T.l6,{value:d||"",onValueChange:o,children:[(0,s.jsx)(T.bq,{className:"w-[250px]",children:(0,s.jsx)(T.yv,{placeholder:"Select a map..."})}),(0,s.jsx)(T.gC,{children:i.map(e=>(0,s.jsx)(T.eb,{value:e.id,children:e.name},e.id))})]}),(0,s.jsx)("div",{className:"flex-1 text-right text-sm text-muted-foreground",children:u?"Selected: Q:".concat(u.q,", R:").concat(u.r):"Click a tile to select it"})]}),(0,s.jsx)("div",{className:"flex-1 relative bg-background/50",children:x?(0,s.jsx)(L.A,{grid:x.tiles,hexSize:20,className:"w-full h-full",onHexClick:j,selectedHex:u,onGridUpdate:()=>{},activeTool:"data",paintMode:"brush",paintColor:"",paintIcon:null,paintIconColor:"",isCtrlPressed:!1,isEyedropperActive:!1,onEyedropperClick:()=>{}}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:(0,s.jsx)("p",{children:"Select a map to view it."})})}),(0,s.jsxs)(g.Es,{children:[(0,s.jsx)(m.$,{variant:"ghost",onClick:()=>r(!1),children:"Cancel"}),(0,s.jsx)(m.$,{onClick:()=>{d&&u&&(a({mapId:d,hex:u}),r(!1))},disabled:!u,children:"Confirm Location"})]})]})]})}let R=v.z.object({title:v.z.string().min(1,"Title is required."),description:v.z.string().optional(),tags:v.z.array(v.z.string()).optional(),startDate:v.z.date({required_error:"A start date is required."}),endDate:v.z.date().optional(),location:v.z.object({mapId:v.z.string(),hex:v.z.object({q:v.z.number(),r:v.z.number(),s:v.z.number()})}).optional()}).superRefine((e,t)=>{e.endDate&&e.startDate>e.endDate&&t.addIssue({path:["endDate"],message:"End date cannot be before start date."})});function G(e){let{isOpen:t,onOpenChange:a,onSaveSuccess:n,event:r,defaultCalendarId:i,initialDate:d}=e,{toast:o}=(0,u.dj)(),[x,h]=(0,l.useState)([]),[v,P]=(0,l.useState)([]),[$,_]=(0,l.useState)([]),[T,L]=(0,l.useState)([]),[G,q]=(0,l.useState)(null),[B,U]=(0,l.useState)(null);(0,l.useEffect)(()=>{Promise.all([(0,f.OG)(),(0,f.vq)(),(0,f.xW)(),(0,f.Qg)()]).then(e=>{let[t,a,s,l]=e;h(t),P(a),L(s),_(l)})},[]);let J=(0,j.mN)({resolver:(0,p.u)(R),defaultValues:{title:"",description:"",tags:[],startDate:new Date,endDate:void 0,location:void 0}}),{watch:W}=J,Z=W("startDate");(0,l.useEffect)(()=>{if(r&&t)if(J.reset({title:r.title,description:r.description,tags:r.tags||[],startDate:new Date(r.startDate),endDate:new Date(r.endDate),location:r.location}),r.party?q(r.party):q(null),r.location&&T.length>0){var e;let t=(null==(e=T.find(e=>e.id===r.location.mapId))?void 0:e.name)||"Unknown Map";U({...r.location,mapName:t})}else U(null);else!r&&t&&(J.reset({title:"",description:"",tags:[],startDate:d,endDate:void 0,location:void 0}),q(null),U(null))},[r,t,J,d,T]);let V=async e=>{let t;G&&(t={type:G.type,id:G.id,name:G.name});let a={title:e.title,calendarId:i,description:e.description||"",startDate:e.startDate.toISOString(),endDate:(e.endDate||e.startDate).toISOString(),tags:e.tags||[],party:t,location:B?{mapId:B.mapId,hex:B.hex}:void 0};try{e.tags&&await (0,f.JE)(e.tags,"calendar"),r?(await (0,f._1)({...a,id:r.id}),o({title:"Event Updated"})):(await (0,f.UU)(a),o({title:"Event Created"})),n()}catch(e){o({variant:"destructive",title:"Save Failed",description:"Could not save event."})}};return(0,s.jsx)(g.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(g.Cf,{className:"max-h-[90vh] flex flex-col p-0",children:[(0,s.jsxs)(g.c7,{className:"p-6 pb-4",children:[(0,s.jsx)(g.L3,{children:r?"Edit Event":"Add New Event"}),(0,s.jsx)(g.rr,{children:r?"Editing event on ".concat((0,c.GP)(new Date(r.startDate),"PPP")):"Create a new event."})]}),(0,s.jsx)(I.F,{className:"flex-1 px-6",children:(0,s.jsx)(w.lV,{...J,children:(0,s.jsxs)("form",{id:"event-form",onSubmit:J.handleSubmit(V),className:"space-y-4 pb-4",children:[(0,s.jsx)(w.zB,{name:"title",control:J.control,render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsx)(w.lR,{children:"Title"}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(N.p,{...t})}),(0,s.jsx)(w.C5,{})]})}}),(0,s.jsx)(w.zB,{name:"description",control:J.control,render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsx)(w.lR,{children:"Description"}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(y.T,{...t})})]})}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(w.zB,{name:"startDate",control:J.control,render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{className:"flex flex-col",children:[(0,s.jsx)(w.lR,{children:"Start Date"}),(0,s.jsxs)(b.AM,{children:[(0,s.jsx)(b.Wv,{asChild:!0,children:(0,s.jsx)(w.MJ,{children:(0,s.jsxs)(m.$,{variant:"outline",className:(0,D.cn)("w-full pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),children:[t.value?(0,c.GP)(t.value,"PPP"):(0,s.jsx)("span",{children:"Pick a date"}),(0,s.jsx)(S.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,s.jsx)(b.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(F,{mode:"single",selected:t.value,onSelect:t.onChange,defaultMonth:t.value,disabled:e=>e<new Date("0001-01-01T00:00:00"),initialFocus:!0})})]}),(0,s.jsx)(w.C5,{})]})}}),(0,s.jsx)(w.zB,{name:"endDate",control:J.control,render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{className:"flex flex-col",children:[(0,s.jsx)(w.lR,{children:"End Date (Optional)"}),(0,s.jsxs)(b.AM,{children:[(0,s.jsx)(b.Wv,{asChild:!0,children:(0,s.jsx)(w.MJ,{children:(0,s.jsxs)(m.$,{variant:"outline",className:(0,D.cn)("w-full pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),children:[t.value?(0,c.GP)(t.value,"PPP"):(0,s.jsx)("span",{children:"Pick a date"}),(0,s.jsx)(S.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,s.jsx)(b.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(F,{mode:"single",selected:t.value,onSelect:t.onChange,defaultMonth:t.value||Z,disabled:e=>e<(Z||new Date("0001-01-01T00:00:00")),initialFocus:!0})})]}),(0,s.jsx)(w.C5,{})]})}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.lR,{children:"Responsible Party (Optional)"}),G?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 mt-2 border rounded-md",children:[(0,s.jsxs)("p",{className:"font-semibold",children:[G.name," ",(0,s.jsxs)("span",{className:"text-sm text-muted-foreground capitalize",children:["(",G.type,")"]})]}),(0,s.jsx)(m.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>q(null),children:(0,s.jsx)(A.A,{className:"h-4 w-4"})})]}):(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[(0,s.jsx)(M,{items:v,onSelectItem:e=>q({...e,type:"faction"}),trigger:(0,s.jsxs)(m.$,{type:"button",variant:"outline",className:"w-full",children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Faction"]}),title:"Select a Faction"}),(0,s.jsx)(M,{items:x,onSelectItem:e=>q({...e,type:"creature"}),trigger:(0,s.jsxs)(m.$,{type:"button",variant:"outline",className:"w-full",children:[(0,s.jsx)(z.A,{className:"h-4 w-4 mr-2"}),"Creature"]}),title:"Select a Creature"}),(0,s.jsx)(M,{items:$,onSelectItem:e=>q({...e,type:"npc"}),trigger:(0,s.jsxs)(m.$,{type:"button",variant:"outline",className:"w-full",children:[(0,s.jsx)(z.A,{className:"h-4 w-4 mr-2"}),"NPC"]}),title:"Select an NPC"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.lR,{children:"Location (Optional)"}),B?(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 mt-2 border rounded-md",children:[(0,s.jsxs)("p",{className:"font-semibold text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Map:"})," ",B.mapName,(0,s.jsx)("span",{className:"text-muted-foreground ml-2",children:"Tile:"})," Q:",B.hex.q,", R:",B.hex.r]}),(0,s.jsx)(m.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>U(null),children:(0,s.jsx)(A.A,{className:"h-4 w-4"})})]}):(0,s.jsx)(O,{onLocationSelect:e=>{var t;let{mapId:a,hex:s}=e,l=(null==(t=T.find(e=>e.id===a))?void 0:t.name)||"Unknown Map";U({mapId:a,mapName:l,hex:s})},children:(0,s.jsxs)(m.$,{type:"button",variant:"outline",className:"w-full mt-2",children:[(0,s.jsx)(E.A,{className:"h-4 w-4 mr-2"})," Select Location on Map"]})})]}),(0,s.jsx)(w.zB,{name:"tags",control:J.control,render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsx)(w.lR,{children:"Tags"}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(C.F,{value:t.value||[],onChange:t.onChange,tagSource:"calendar",placeholder:"Add tags..."})})]})}})]})})}),(0,s.jsxs)(g.Es,{className:"p-6 pt-4 border-t",children:[(0,s.jsx)(m.$,{type:"button",variant:"ghost",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(m.$,{type:"submit",form:"event-form",children:"Save Event"})]})]})})}var q=a(90010),B=a(26126),U=a(56013),J=a(18046),W=a(10518),Z=a(18763),V=a(77223),Q=a(2868),H=a(52874),K=a(20031),Y=a(22346);function X(e){let{calendars:t,onCalendarsUpdate:a}=e,[n,r]=(0,l.useState)(!1),[i,c]=(0,l.useState)(""),[d,o]=(0,l.useState)(null),[x,h]=(0,l.useState)(""),{toast:j}=(0,u.dj)(),p=async()=>{if(i.trim())try{let e=await (0,H.ep)({name:i.trim()});j({title:"Calendar Created",description:'"'.concat(i,'" has been added.')}),c(""),a(e),r(!1)}catch(e){j({variant:"destructive",title:"Error",description:"Failed to create calendar."})}},v=e=>{o(e.id),h(e.name)},f=()=>{o(null),h("")},w=async()=>{if(d&&x.trim())try{await (0,H.md)({id:d,name:x.trim()}),j({title:"Calendar Renamed"}),a(),f()}catch(e){j({variant:"destructive",title:"Error",description:"Failed to rename calendar."})}},y=async e=>{try{await (0,H.A$)(e),j({title:"Calendar Deleted"}),a()}catch(e){j({variant:"destructive",title:"Error",description:"Failed to delete calendar and its events."})}};return(0,s.jsxs)(g.lG,{open:n,onOpenChange:r,children:[(0,s.jsx)(g.zM,{asChild:!0,children:(0,s.jsx)(m.$,{variant:"ghost",size:"icon",children:(0,s.jsx)(U.A,{className:"h-5 w-5"})})}),(0,s.jsxs)(g.Cf,{children:[(0,s.jsxs)(g.c7,{children:[(0,s.jsx)(g.L3,{children:"Manage Calendars"}),(0,s.jsx)(g.rr,{children:"Add, rename, or delete your calendars."})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(N.p,{placeholder:"New calendar name...",value:i,onChange:e=>c(e.target.value)}),(0,s.jsxs)(m.$,{onClick:p,disabled:!i.trim(),children:[(0,s.jsx)(J.A,{className:"h-4 w-4"})," Add"]})]}),(0,s.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.map(e=>(0,s.jsx)("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50 gap-2",children:d===e.id?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.p,{value:x,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&w()},className:"h-8",autoFocus:!0}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.$,{size:"icon",className:"h-7 w-7",onClick:w,"aria-label":"Save",children:(0,s.jsx)(W.A,{className:"h-4 w-4"})}),(0,s.jsx)(m.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:f,"aria-label":"Cancel",children:(0,s.jsx)(A.A,{className:"h-4 w-4"})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"flex-1 truncate",title:e.name,children:e.name}),(0,s.jsxs)("div",{className:"flex items-center shrink-0",children:[(0,s.jsx)(m.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>v(e),"aria-label":"Edit",children:(0,s.jsx)(Z.A,{className:"h-4 w-4"})}),(0,s.jsxs)(q.Lt,{children:[(0,s.jsx)(q.tv,{asChild:!0,children:(0,s.jsx)(m.$,{variant:"ghost",size:"icon",className:"h-7 w-7","aria-label":"Delete",children:(0,s.jsx)(V.A,{className:"h-4 w-4 text-destructive"})})}),(0,s.jsxs)(q.EO,{children:[(0,s.jsxs)(q.wd,{children:[(0,s.jsx)(q.r7,{children:"Are you sure?"}),(0,s.jsxs)(q.$v,{children:['This will permanently delete the "',e.name,'" calendar and all of its events.']})]}),(0,s.jsxs)(q.ck,{children:[(0,s.jsx)(q.Zr,{children:"Cancel"}),(0,s.jsx)(q.Rx,{onClick:()=>y(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]})]})},e.id))})]})]})]})}function ee(){var e;let[t,a]=(0,l.useState)([]),[j,p]=(0,l.useState)([]),[v,f]=(0,l.useState)("all"),[g,w]=(0,l.useState)(new Date),[N,y]=(0,l.useState)(new Date),[b,C]=(0,l.useState)(!1),[D,S]=(0,l.useState)(null),{toast:A}=(0,u.dj)(),k=async e=>{try{let t=await (0,H.FO)();if(0===t.length){let e=await (0,H.ep)({name:"Default"}),t=[{id:e,name:"Default"}];p(t),f(e),a([]);let s=new Date("0001-01-01T00:00:00");w(s),y(s);return}p(t);let s=e;t.find(t=>t.id===e)||"all"===e||(s="all",f("all"));let l=await (0,Q.bj)(s);if(a(l),l.length>0){let e=[...l].sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()),t=(0,n.o)(new Date(e[0].startDate));w(t),y(t)}else{let e=new Date("0001-01-01T00:00:00");w(e),y(e)}}catch(e){A({variant:"destructive",title:"Error",description:"Failed to load calendar data."})}},z=e=>{e?f(e):k(v)};(0,l.useEffect)(()=>{k(v)},[v]);let P=e=>{S(e),C(!0)},$=async e=>{try{await (0,Q.At)(e),A({title:"Event Deleted"}),z()}catch(e){A({variant:"destructive",title:"Error",description:"Failed to delete event."})}},_=(0,l.useMemo)(()=>g?t.filter(e=>(0,r.v)(g,{start:(0,n.o)(new Date(e.startDate)),end:(0,n.o)(new Date(e.endDate))})).sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()):[],[t,g]),F=(0,l.useMemo)(()=>t.flatMap(e=>(0,i.k)({start:(0,n.o)(new Date(e.startDate)),end:(0,n.o)(new Date(e.endDate))})),[t]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(K.SidebarProvider,{children:[(0,s.jsx)(x.A,{children:(0,s.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,s.jsx)(K.Bx,{style:{"--sidebar-width":"380px"},children:(0,s.jsxs)("div",{className:"p-4 space-y-4 h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(T.l6,{value:v,onValueChange:f,children:[(0,s.jsx)(T.bq,{className:"flex-1",children:(0,s.jsx)(T.yv,{placeholder:"Select a calendar"})}),(0,s.jsxs)(T.gC,{children:[(0,s.jsx)(T.eb,{value:"all",children:"All Calendars"}),j.map(e=>(0,s.jsx)(T.eb,{value:e.id,children:e.name},e.id))]})]}),(0,s.jsx)(X,{calendars:j,onCalendarsUpdate:z})]}),(0,s.jsx)(m.$,{onClick:()=>{S(null),C(!0)},children:"Add Event"}),(0,s.jsx)(Y.w,{}),(0,s.jsxs)(h.Zp,{className:"flex-1 flex flex-col min-h-0",children:[(0,s.jsx)(h.aR,{children:(0,s.jsxs)(h.ZB,{children:["Events for ",g?(0,c.GP)(g,"PPP"):"..."]})}),(0,s.jsx)(h.Wu,{className:"flex-1 min-h-0",children:(0,s.jsx)(I.F,{className:"h-full",children:_.length>0?(0,s.jsx)("div",{className:"space-y-4 pr-4",children:_.map(e=>(0,s.jsxs)(h.Zp,{className:"bg-card-foreground/5",children:[(0,s.jsx)(h.aR,{className:"pb-2",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{children:(0,s.jsx)(h.ZB,{className:"text-lg",children:e.title})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>P(e),children:(0,s.jsx)(Z.A,{className:"h-4 w-4"})}),(0,s.jsxs)(q.Lt,{children:[(0,s.jsx)(q.tv,{asChild:!0,children:(0,s.jsx)(m.$,{variant:"ghost",size:"icon",className:"h-7 w-7",children:(0,s.jsx)(V.A,{className:"h-4 w-4 text-destructive"})})}),(0,s.jsxs)(q.EO,{children:[(0,s.jsxs)(q.wd,{children:[(0,s.jsx)(q.r7,{children:"Are you sure?"}),(0,s.jsxs)(q.$v,{children:['This will permanently delete "',e.title,'".']})]}),(0,s.jsxs)(q.ck,{children:[(0,s.jsx)(q.Zr,{children:"Cancel"}),(0,s.jsx)(q.Rx,{onClick:()=>$(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]})]})}),(0,s.jsxs)(h.Wu,{children:[(0,s.jsxs)(h.BT,{className:"text-xs",children:["From: ",(0,c.GP)(new Date(e.startDate),"P")," To: ",(0,c.GP)(new Date(e.endDate),"P")]}),e.description&&(0,s.jsx)("p",{className:"text-sm mt-2",children:e.description}),e.party&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Party: ",(0,s.jsxs)("span",{className:"font-semibold text-accent",children:[e.party.name," (",e.party.type,")"]})]}),e.location&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[(0,s.jsx)(E.A,{className:"h-3 w-3"})," Location set"]}),e.tags&&e.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map(e=>(0,s.jsx)(B.E,{variant:"secondary",children:e},e))})]})]},e.id))}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No events for this day."})})})]})]})}),(0,s.jsx)(K.sF,{className:"flex-1 flex flex-col overflow-hidden bg-background/50",children:(0,s.jsx)(o.Ay,{onChange:e=>{e instanceof Date&&w(e)},value:g,activeStartDate:N,onActiveStartDateChange:e=>{let{activeStartDate:t}=e;return t&&y(t)},minDate:new Date("0001-01-01T00:00:00"),maxDate:new Date(new Date().getFullYear()+100,11,31),tileContent:e=>{let{date:t,view:a}=e;return"month"===a&&F.some(e=>(0,d.r)(e,t))?(0,s.jsx)("div",{className:"event-dot"}):null},className:"w-full h-full",weekStartsOn:1,next2Label:null,prev2Label:null})})]})}),(0,s.jsx)(G,{isOpen:b,onOpenChange:C,onSaveSuccess:()=>{z(),C(!1),S(null)},event:D,defaultCalendarId:"all"===v?(null==(e=j[0])?void 0:e.id)||"":v,initialDate:g||new Date})]})})}}}]);