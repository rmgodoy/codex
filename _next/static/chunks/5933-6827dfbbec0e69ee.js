"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5933],{7146:(e,t,a)=>{a.d(t,{Xk:()=>r,YS:()=>l,bi:()=>i,fh:()=>o,rX:()=>c,t1:()=>h,z0:()=>n});let r=e=>{let t=[];for(let a=-e;a<=e;a++){let r=Math.max(-e,-a-e),n=Math.min(e,-a+e);for(let e=r;e<=n;e++)t.push({q:a,r:e,s:-a-e})}return t.map(e=>({hex:e,data:{}}))},n=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],n=new Map(a.map(e=>["".concat(e.hex.q,",").concat(e.hex.r),e])),l=-Math.floor(e/2),o=l+e-1;for(let e=l;e<=o;e++){let a=-Math.floor(t/2)+-Math.floor(e/2),n=a+t-1;for(let t=a;t<=n;t++){let a=-e-t;r.push({q:e,r:t,s:a})}}return r.map(e=>{let t="".concat(e.q,",").concat(e.r);return n.get(t)||{hex:e,data:{}}})},l=(e,t)=>{let a=[];for(let e=-t;e<=t;e++){let r=Math.max(-t,-e-t),n=Math.min(t,-e+t);for(let t=r;t<=n;t++)a.push({q:e,r:t,s:-e-t})}let r=new Map(e.map(e=>["".concat(e.hex.q,",").concat(e.hex.r),e]));return a.map(e=>{let t="".concat(e.q,",").concat(e.r),a=r.get(t);return a||{hex:e,data:{}}})},o=(e,t)=>({x:t*(1.5*e.q),y:t*(Math.sqrt(3)/2*e.q+Math.sqrt(3)*e.r)}),c=(e,t,a)=>{let r=Math.PI/180*(60*a);return{x:e.x+t*Math.cos(r),y:e.y+t*Math.sin(r)}},s=(e,t,a)=>{let r=Math.round(e),n=Math.round(t),l=Math.round(a),o=Math.abs(r-e),c=Math.abs(n-t),s=Math.abs(l-a);return o>c&&o>s?r=-n-l:c>s?n=-r-l:l=-r-n,{q:r,r:n,s:l}},i=(e,t,a)=>{let r=2/3*e/a,n=(-1/3*e+Math.sqrt(3)/3*t)/a;return s(r,n,-r-n)},u=[{q:1,r:0,s:-1},{q:1,r:-1,s:0},{q:0,r:-1,s:1},{q:-1,r:0,s:1},{q:-1,r:1,s:0},{q:0,r:1,s:-1}],h=e=>u.map(t=>({q:e.q+t.q,r:e.r+t.r,s:e.s+t.s}))},19209:(e,t,a)=>{a.d(t,{A:()=>c});var r=a(95155),n=a(12115),l=a(7146);let o=(e,t,a,r,n)=>{let l=.9*r,o=l/24,{x:c,y:s}=t;e.save(),e.translate(c-l/2,s-l/2),e.scale(o,o),e.strokeStyle=n,e.lineWidth=1.5/o;let i=[];switch(a){case"Home":i=["m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z","M9 22V12h6v10"];break;case"Trees":i=["M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z","M7 16v6","M13 19v3","M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5"];break;case"Mountain":i=["m8 3 4 8 5-5 5 15H2L8 3z"];break;case"Castle":i=["M22 20v-9H2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2Z","M18 11V4H6v7","M15 22v-4a3 3 0 0 0-3-3a3 3 0 0 0-3 3v4","M22 11V9","M2 11V9","M6 4V2","M18 4V2","M10 4V2","M14 4V2"];break;case"TowerControl":i=["M18.2 12.27 20 6H4l1.8 6.27a1 1 0 0 0 .95.73h10.5a1 1 0 0 0 .96-.73Z","M8 13v9","M16 22v-9","m9 6 1 7","m15 6-1 7","M12 6V2","M13 2h-2"];break;case"Tent":i=["M3.5 21 14 3","M20.5 21 10 3","M15.5 21 12 15l-3.5 6","M2 21h20"];break;case"Waves":i=["M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1","M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1","M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"];break;case"MapPin":i=["M12 17v5","M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1 1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z"];break;case"Landmark":i=["M10 18v-7","M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z","M14 18v-7","M18 18v-7","M3 22h18","M6 18v-7"];break;case"Skull":i={paths:["m12.5 17-.5-1-.5 1h1z","M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"],circles:[{cx:15,cy:12,r:1},{cx:9,cy:12,r:1}]}}Array.isArray(i)?i.forEach(t=>{let a=new Path2D(t);e.stroke(a)}):(i.paths.forEach(t=>{let a=new Path2D(t);e.stroke(a)}),i.circles.forEach(t=>{e.beginPath(),e.arc(t.cx,t.cy,t.r,0,2*Math.PI),e.fillStyle=n,e.fill()})),e.restore()},c=e=>{let{mapData:t,hexSize:a=25,className:c,style:s,onGridUpdate:i,onHexClick:u,onAddPointToPath:h,activeTool:d,paintMode:f,paintColor:m,paintIcon:p,paintIconColor:g,selectedHex:x,isCtrlPressed:M,isAltPressed:y,isShiftPressed:b,isEyedropperActive:v,onEyedropperClick:k,pathDrawingId:w}=e,q=(0,n.useRef)(null),C=(0,n.useRef)(null),z=(0,n.useRef)(null),[E,P]=(0,n.useState)({background:"#1A0024",border:"#4B0082",accent:"#8A2BE2",foreground:"#E0D6F0"}),[S,N]=(0,n.useState)({x:0,y:0,zoom:1}),R=(0,n.useRef)(S),[V,D]=(0,n.useState)(!1),X=(0,n.useRef)({x:0,y:0}),[Y,j]=(0,n.useState)(0),[A,T]=(0,n.useState)(!1),[H,L]=(0,n.useState)(!1),[B,W]=(0,n.useState)(null),F=(0,n.useMemo)(()=>new Map(t.tiles.map(e=>["".concat(e.hex.q,",").concat(e.hex.r),e])),[t.tiles]);(0,n.useEffect)(()=>{R.current=S},[S]),(0,n.useEffect)(()=>{{let e=getComputedStyle(document.documentElement);P({background:"hsl(".concat(e.getPropertyValue("--background").trim(),")"),border:"hsl(".concat(e.getPropertyValue("--border").trim(),")"),accent:"hsl(".concat(e.getPropertyValue("--accent").trim(),")"),foreground:"hsl(".concat(e.getPropertyValue("--foreground").trim(),")")})}},[]);let I=(0,n.useCallback)(e=>{let t=q.current;if(!t)return{x:0,y:0};let a=t.getBoundingClientRect(),r="touches"in e?e.touches[0].clientX:e.clientX,n="touches"in e?e.touches[0].clientY:e.clientY;return{x:r-a.left,y:n-a.top}},[]),Z=(0,n.useCallback)((e,t)=>{let a=q.current;if(!a)return{x:0,y:0};let r=R.current,n=a.getBoundingClientRect();return{x:(e-(n.width/2+r.x))/r.zoom,y:(t-(n.height/2+r.y))/r.zoom}},[]),_=(0,n.useCallback)((e,t)=>{let{x:r,y:n}=Z(e,t);return(0,l.bi)(r,n,a)},[a,Z]),J=(0,n.useCallback)(()=>{let e=q.current;if(!e)return;let r=e.getContext("2d");if(!r)return;let n=R.current,{width:o,height:c}=e.getBoundingClientRect();(e.width!==o||e.height!==c)&&(e.width=o,e.height=c),r.fillStyle=E.background,r.fillRect(0,0,o,c),r.save(),r.translate(o/2+n.x,c/2+n.y),r.scale(n.zoom,n.zoom);let s=n.zoom>.4?C.current:z.current;if(s&&s.width>0&&s.height>0){let e=s.width,t=s.height;r.drawImage(s,-e/2,-t/2)}if(t.paths&&t.paths.length>0&&t.paths.forEach(e=>{if(!(e.points.length<2)){r.beginPath(),r.moveTo(e.points[0].x,e.points[0].y);for(let t=1;t<e.points.length;t++)r.lineTo(e.points[t].x,e.points[t].y);r.strokeStyle=e.color,r.lineWidth=e.strokeWidth/n.zoom,r.lineCap="round",r.lineJoin="round",r.stroke()}}),w){let e=t.paths.find(e=>e.id===w);e&&e.points.length>0&&e.points.forEach(t=>{r.beginPath(),r.arc(t.x,t.y,4/n.zoom,0,2*Math.PI),r.fillStyle=e.color,r.fill(),r.strokeStyle="rgba(255, 255, 255, 0.8)",r.lineWidth=1/n.zoom,r.stroke()})}if(x){let e=(0,l.fh)(x,a);r.beginPath();for(let t=0;t<6;t++){let n=(0,l.rX)(e,a,t);0===t?r.moveTo(n.x,n.y):r.lineTo(n.x,n.y)}r.closePath(),r.strokeStyle=E.accent,r.lineWidth=3/n.zoom,r.stroke()}r.restore()},[a,E,x,t.paths,w]);(0,n.useEffect)(()=>{let e,r;if(!t.tiles.length||!q.current)return;let n=1/0,c=-1/0,s=1/0,i=-1/0;if(t.tiles.forEach(e=>{let{hex:t}=e;n=Math.min(n,t.q),c=Math.max(c,t.q),s=Math.min(s,t.r),i=Math.max(i,t.r)}),!isFinite(n))return;let u=c-n+1,h=i-s+1;if("rectangular"===t.shape?(e=(1.5*u+2)*a,r=(h+u/2)*Math.sqrt(3)*a):(e=(1.5*u+.5)*a,r=(h+u/2+.5)*a*Math.sqrt(3)),e<=0||r<=0)return;C.current||(C.current=document.createElement("canvas"));let d=C.current;d.width=e,d.height=r;let f=d.getContext("2d");z.current||(z.current=document.createElement("canvas"));let m=z.current;m.width=e,m.height=r;let p=m.getContext("2d");if(!f||!p)return;f.clearRect(0,0,e,r),p.clearRect(0,0,e,r),f.translate(e/2,r/2),p.translate(e/2,r/2);let g=new Map,x=new Map,M=[],y=new Path2D;t.tiles.forEach(e=>{let{hex:t,data:r}=e,n=(0,l.fh)(t,a),o=new Path2D;for(let e=0;e<6;e++){let t=(0,l.rX)(n,a,e);0===e?o.moveTo(t.x,t.y):o.lineTo(t.x,t.y)}o.closePath(),y.addPath(o);let c=r.color||E.background;g.has(c)||g.set(c,new Path2D),g.get(c).addPath(o),r.icon&&M.push({center:n,icon:r.icon,iconColor:r.iconColor||E.foreground});let s=r.color||E.background;x.has(s)||x.set(s,new Path2D),x.get(s).addPath(o)}),g.forEach((e,t)=>{f.fillStyle=t,f.fill(e)}),f.strokeStyle=E.border,f.lineWidth=1,f.stroke(y),M.forEach(e=>{let{center:t,icon:r,iconColor:n}=e;o(f,t,r,a,n)}),x.forEach((e,t)=>{p.fillStyle=t,p.fill(e)}),J()},[t.tiles,t.shape,t.width,t.height,a,E,J]),(0,n.useEffect)(()=>{J()},[S,J,t.paths,w]);let U=(0,n.useCallback)(e=>{let a=F.get("".concat(e.q,",").concat(e.r));if(!a)return;let r=a.data.color,n=a.data.icon;if(r===m&&n===p)return;let o=new Set,c=[e],s=new Set(["".concat(e.q,",").concat(e.r)]);for(o.add("".concat(e.q,",").concat(e.r));c.length>0;){let e=c.shift();for(let t of(0,l.t1)(e)){let e="".concat(t.q,",").concat(t.r);if(!s.has(e)){s.add(e);let a=F.get(e);a&&a.data.color===r&&a.data.icon===n&&(o.add(e),c.push(t))}}}o.size>0&&i(t.tiles.map(e=>o.has("".concat(e.hex.q,",").concat(e.hex.r))?{...e,data:{...e.data,color:m,icon:p,iconColor:g}}:e))},[t.tiles,F,m,p,g,i]),G=(0,n.useCallback)((e,a)=>{i(t.tiles.map(t=>t.hex.q===e.q&&t.hex.r===e.r?"erase"===a?{...t,data:{...t.data,color:void 0,icon:void 0,iconColor:void 0}}:{...t,data:{...t.data,color:m,icon:p,iconColor:g}}:t))},[t.tiles,m,p,g,i]),K=(0,n.useCallback)(e=>{e.preventDefault();let{x:t,y:a}=I(e);if(2===e.button||1===e.button){D(!0),X.current={x:t,y:a};return}if("path"===d&&w)return void h(Z(t,a));let r=_(t,a);if(r){if(v||y&&"paint"===d&&"brush"===f)return void k(r);if("paint"===d){let e="brush"===f&&M,t="brush"===f&&b;e||"bucket"===f?U(r):(t||"brush"===f||"erase"===f)&&(L(!0),G(r,t?"erase":f),W(r))}else u(r)}},[I,_,u,f,G,U,d,M,y,b,v,k,w,h,Z]),O=(0,n.useCallback)(e=>{let{x:t,y:a}=I(e);if(V){let e=t-X.current.x,r=a-X.current.y;X.current={x:t,y:a},R.current.x+=e,R.current.y+=r,requestAnimationFrame(J);return}if(H&&"paint"===d){let e=_(t,a);e&&(!B||e.q!==B.q||e.r!==B.r)&&(G(e,b?"erase":f),W(e))}},[V,I,f,H,G,d,J,B,b,_]),Q=(0,n.useCallback)(e=>{e.preventDefault();let t=e.touches,{x:a,y:r}=I(e);if(1===t.length){if("path"===d&&w)return void h(Z(a,r));let e=_(a,r);if(v){e&&k(e);return}D(!0),X.current={x:a,y:r},"paint"===d&&("brush"===f||"erase"===f)?e&&(L(!0),G(e,f),W(e)):e&&u(e)}else if(2===t.length){D(!0),T(!0);let e=t[0],a=t[1];j(Math.hypot(e.clientX-a.clientX,e.clientY-a.clientY));let r=q.current.getBoundingClientRect();X.current={x:(e.clientX+a.clientX)/2-r.left,y:(e.clientY+a.clientY)/2-r.top}}},[I,_,v,k,d,f,G,u,w,h,Z]),$=(0,n.useCallback)(e=>{e.preventDefault();let t=e.touches,a=q.current.getBoundingClientRect();if(1!==t.length||A){if(2===t.length&&V){let e=t[0],r=t[1],n=Math.hypot(e.clientX-r.clientX,e.clientY-r.clientY),l={x:(e.clientX+r.clientX)/2-a.left,y:(e.clientY+r.clientY)/2-a.top},o=n/Y,c=Math.max(.1,Math.min(5,R.current.zoom*o)),s=(l.x-(a.width/2+R.current.x))/R.current.zoom,i=(l.y-(a.height/2+R.current.y))/R.current.zoom,u=l.x-s*c-a.width/2,h=l.y-i*c-a.height/2;R.current={x:u,y:h,zoom:c},N({x:u,y:h,zoom:c}),j(n),X.current=l}}else{let{x:t,y:a}=I(e),r=t-X.current.x,n=a-X.current.y;if(H&&"paint"===d){let e=_(t,a);e&&(!B||e.q!==B.q||e.r!==B.r)&&(G(e,f),W(e))}else V&&(R.current.x+=r,R.current.y+=n,requestAnimationFrame(J));X.current={x:t,y:a}}},[V,A,H,Y,J,I,_,G,f,B,d]),ee=(0,n.useCallback)(e=>{D(!1),T(!1),L(!1),W(null)},[]);return(0,r.jsx)("canvas",{ref:q,className:c,style:s,onMouseDown:K,onMouseUp:e=>{0===e.button&&(L(!1),W(null)),(2===e.button||1===e.button)&&V&&(D(!1),N({...R.current}))},onMouseMove:O,onMouseLeave:()=>{V&&(D(!1),N({...R.current})),L(!1),W(null)},onWheel:e=>{e.preventDefault();let t=R.current,a=e.deltaY<0?1.1*t.zoom:t.zoom/1.1,r=q.current;if(!r)return;let n=r.getBoundingClientRect(),l=e.clientX-n.left,o=e.clientY-n.top,c=(l-(n.width/2+t.x))/t.zoom,s=(o-(n.height/2+t.y))/t.zoom,i=l-c*a-n.width/2,u=o-s*a-n.height/2,h=Math.max(.1,Math.min(5,a));R.current={x:i,y:u,zoom:h},N({x:i,y:u,zoom:h})},onTouchStart:Q,onTouchMove:$,onTouchEnd:ee,onContextMenu:e=>e.preventDefault()})}},54165:(e,t,a)=>{a.d(t,{Cf:()=>d,Es:()=>m,L3:()=>p,c7:()=>f,lG:()=>s,rr:()=>g,zM:()=>i});var r=a(95155),n=a(12115),l=a(45821),o=a(25318),c=a(59434);let s=l.bL,i=l.l9,u=l.ZL;l.bm;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.hJ,{ref:t,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});h.displayName=l.hJ.displayName;let d=n.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,r.jsxs)(u,{children:[(0,r.jsx)(h,{}),(0,r.jsxs)(l.UC,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s,children:[n,(0,r.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});d.displayName=l.UC.displayName;let f=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let m=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};m.displayName="DialogFooter";let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});p.displayName=l.hE.displayName;let g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.VY,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...n})});g.displayName=l.VY.displayName}}]);