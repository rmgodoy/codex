"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5520],{2868:(e,r,t)=>{t.d(r,{At:()=>c,UU:()=>s,_1:()=>n,bj:()=>o});var a=t(82489);let o=async e=>{let r=(await (0,a.Lf)()).transaction(a.$,"readonly").objectStore(a.$);if(!e||"all"===e){let e=r.getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})}let t=r.index("by_calendar").getAll(IDBKeyRange.only(e));return new Promise((e,r)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>r(t.error)})},s=async e=>{let r=(await (0,a.Lf)()).transaction(a.$,"readwrite").objectStore(a.$),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},n=async e=>{let r=(await (0,a.Lf)()).transaction(a.$,"readwrite").objectStore(a.$).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},c=async e=>{let r=(await (0,a.Lf)()).transaction(a.$,"readwrite").objectStore(a.$).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})}},22346:(e,r,t)=>{t.d(r,{w:()=>c});var a=t(95155),o=t(12115),s=t(87489),n=t(59434);let c=o.forwardRef((e,r)=>{let{className:t,orientation:o="horizontal",decorative:c=!0,...l}=e;return(0,a.jsx)(s.b,{ref:r,decorative:c,orientation:o,className:(0,n.cn)("shrink-0 bg-border","horizontal"===o?"h-[1px] w-full":"h-full w-[1px]",t),...l})});c.displayName=s.b.displayName},52874:(e,r,t)=>{t.d(r,{A$:()=>c,FO:()=>o,ep:()=>s,md:()=>n});var a=t(82489);let o=async()=>{let e=(await (0,a.Lf)()).transaction(a.qo,"readonly").objectStore(a.qo).getAll();return new Promise((r,t)=>{e.onsuccess=()=>{r(e.result.sort((e,r)=>e.name.localeCompare(r.name)))},e.onerror=()=>t(e.error)})},s=async e=>{let r=(await (0,a.Lf)()).transaction(a.qo,"readwrite").objectStore(a.qo),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},n=async e=>{let r=(await (0,a.Lf)()).transaction(a.qo,"readwrite").objectStore(a.qo).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},c=async e=>{let r=(await (0,a.Lf)()).transaction([a.qo,a.$],"readwrite"),t=r.objectStore(a.qo),o=r.objectStore(a.$),s=o.index("by_calendar");return new Promise((a,n)=>{t.delete(e).onerror=n;let c=s.openKeyCursor(IDBKeyRange.only(e));c.onsuccess=()=>{let e=c.result;e&&(o.delete(e.primaryKey),e.continue())},c.onerror=n,r.oncomplete=()=>a(),r.onerror=()=>n(r.error)})}},66424:(e,r,t)=>{t.d(r,{F:()=>c});var a=t(95155),o=t(12115),s=t(47655),n=t(59434);let c=o.forwardRef((e,r)=>{let{className:t,children:o,...c}=e;return(0,a.jsxs)(s.bL,{ref:r,className:(0,n.cn)("relative overflow-hidden",t),...c,children:[(0,a.jsx)(s.LM,{className:"h-full w-full rounded-[inherit]",children:o}),(0,a.jsx)(l,{}),(0,a.jsx)(s.OK,{})]})});c.displayName=s.bL.displayName;let l=o.forwardRef((e,r)=>{let{className:t,orientation:o="vertical",...c}=e;return(0,a.jsx)(s.VM,{ref:r,orientation:o,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===o&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===o&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...c,children:(0,a.jsx)(s.lr,{className:"relative flex-1 rounded-full bg-border"})})});l.displayName=s.VM.displayName},66695:(e,r,t)=>{t.d(r,{BT:()=>i,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>c,wL:()=>u});var a=t(95155),o=t(12115),s=t(59434);let n=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...o})});n.displayName="Card";let c=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...o})});c.displayName="CardHeader";let l=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",t),...o})});l.displayName="CardTitle";let i=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...o})});i.displayName="CardDescription";let d=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...o})});d.displayName="CardContent";let u=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...o})});u.displayName="CardFooter"},85057:(e,r,t)=>{t.d(r,{J:()=>i});var a=t(95155),o=t(12115),s=t(40968),n=t(74466),c=t(59434);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(s.b,{ref:r,className:(0,c.cn)(l(),t),...o})});i.displayName=s.b.displayName},88972:(e,r,t)=>{t.d(r,{A:()=>A});var a=t(95155),o=t(12115),s=t(28341),n=t(82643),c=t(16923),l=t(68718),i=t(30285),d=t(76215),u=t(73158),m=t(10518),f=t(70154),w=t(59434);let p=d.bL,h=d.l9;d.YJ,d.ZL,d.Pb,d.z6,o.forwardRef((e,r)=>{let{className:t,inset:o,children:s,...n}=e;return(0,a.jsxs)(d.ZP,{ref:r,className:(0,w.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",o&&"pl-8",t),...n,children:[s,(0,a.jsx)(u.A,{className:"ml-auto"})]})}).displayName=d.ZP.displayName,o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(d.G5,{ref:r,className:(0,w.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})}).displayName=d.G5.displayName;let y=o.forwardRef((e,r)=>{let{className:t,sideOffset:o=4,...s}=e;return(0,a.jsx)(d.ZL,{children:(0,a.jsx)(d.UC,{ref:r,sideOffset:o,className:(0,w.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})})});y.displayName=d.UC.displayName;let x=o.forwardRef((e,r)=>{let{className:t,inset:o,...s}=e;return(0,a.jsx)(d.q7,{ref:r,className:(0,w.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",o&&"pl-8",t),...s})});x.displayName=d.q7.displayName,o.forwardRef((e,r)=>{let{className:t,children:o,checked:s,...n}=e;return(0,a.jsxs)(d.H_,{ref:r,className:(0,w.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(d.VF,{children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})}),o]})}).displayName=d.H_.displayName,o.forwardRef((e,r)=>{let{className:t,children:o,...s}=e;return(0,a.jsxs)(d.hN,{ref:r,className:(0,w.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(d.VF,{children:(0,a.jsx)(f.A,{className:"h-2 w-2 fill-current"})})}),o]})}).displayName=d.hN.displayName,o.forwardRef((e,r)=>{let{className:t,inset:o,...s}=e;return(0,a.jsx)(d.JU,{ref:r,className:(0,w.cn)("px-2 py-1.5 text-sm font-semibold",o&&"pl-8",t),...s})}).displayName=d.JU.displayName,o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(d.wv,{ref:r,className:(0,w.cn)("-mx-1 my-1 h-px bg-muted",t),...o})}).displayName=d.wv.displayName;var b=t(38382),j=t(22346),g=t(66424),N=t(20031),P=t(90010),L=t(87481),v=t(92745),S=t(38914),C=t(47906);let R="codex";function A(e){let{children:r,showSidebarTrigger:t=!0,showImportExport:d=!0}=e,{worldSlug:u,worldName:m}=(0,S.q)(),f=(0,o.useRef)(null),{toast:w}=(0,L.dj)(),[A,$]=(0,o.useState)(""),k=(0,C.a)();(0,o.useEffect)(()=>{let e=()=>{$(window.location.hash)};return e(),window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)},[]);let W=async e=>{var r;let t=null==(r=e.target.files)?void 0:r[0];if(!t||!u)return;let a=new FileReader;a.onload=async e=>{try{var r;let t=null==(r=e.target)?void 0:r.result;if("string"!=typeof t)throw Error("File content could not be read as text.");let a=JSON.parse(t);await (0,v.Qx)(a),w({title:"Import Successful",description:"Data has been overwritten. The application will now reload."}),setTimeout(()=>{window.location.reload()},1500)}catch(e){console.error("Import failed:",e),w({variant:"destructive",title:"Import Failed",description:e.message||"Please check the file format and content."})}finally{f.current&&(f.current.value="")}},a.readAsText(t)},U=async()=>{if(u)try{let e=await (0,v.P7)(u),r="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(e,null,2))),t=document.createElement("a");t.href=r,t.download="tresspasser_world_".concat(m||u,".json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),w({title:"Export Successful",description:'"'.concat(m||u,'" data has been downloaded.')})}catch(e){console.error("Export failed:",e),w({variant:"destructive",title:"Export Failed",description:"Could not export the data."})}},z=(0,o.useMemo)(()=>{let e=A.split("/").filter(e=>e&&"#"!==e).slice(1).join("/"),r="";if(e){let t=e.toLowerCase();t.startsWith("random/encounter-tables")?r="Encounter Tables":t.startsWith("random/treasures")?r="Treasures":t.startsWith("random/commoners")?r="Commoners":t.startsWith("alchemy")?r="Alchemy":t.startsWith("rooms")?r="Rooms":t.startsWith("dungeons")?r="Dungeons":t.startsWith("items")?r="Items":t.startsWith("npcs")?r="NPCs":t.startsWith("factions")?r="Factions":t.startsWith("calendar")?r="Calendar":t.startsWith("maps")?r="Maps":t.startsWith("pantheon")?r="Pantheon":t.startsWith("bestiary")?r="Bestiary":t.startsWith("deeds")?r="Deeds":t.startsWith("encounters")&&(r="Encounters")}return k?r||m||"Codex":m&&r?"".concat(m," | ").concat(r):m||"Codex"},[A,m,u,k]),E=[{href:"".concat(R,"/#/").concat(u,"/alchemy"),label:"Alchemy",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/bestiary"),label:"Bestiary",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/deeds"),label:"Deeds",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/encounters"),label:"Encounters",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/items"),label:"Items",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/npcs"),label:"NPCs",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/factions"),label:"Factions",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/pantheon"),label:"Pantheon",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/rooms"),label:"Rooms",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/random/treasures"),label:"Treasures",group:"Compendium"},{href:"".concat(R,"/#/").concat(u,"/random/encounter-tables"),label:"Encounter Tables",group:"Random"},{href:"".concat(R,"/#/").concat(u,"/random/commoners"),label:"Commoners",group:"Random"},{href:"".concat(R,"/#/").concat(u,"/dungeons"),label:"Dungeons"},{href:"".concat(R,"/#/").concat(u,"/calendar"),label:"Calendar"},{href:"".concat(R,"/#/").concat(u,"/maps"),label:"Maps"}].sort((e,r)=>e.label.localeCompare(r.label)),_=E.filter(e=>"Compendium"===e.group),T=E.filter(e=>"Random"===e.group),q=E.filter(e=>!e.group),X=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(p,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsx)(i.$,{variant:"ghost",children:"Compendium"})}),(0,a.jsx)(y,{children:_.map(e=>(0,a.jsx)("a",{href:e.href,children:(0,a.jsx)(x,{children:e.label})},e.href))})]}),(0,a.jsxs)(p,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsx)(i.$,{variant:"ghost",children:"Random"})}),(0,a.jsx)(y,{children:T.map(e=>(0,a.jsx)("a",{href:e.href,children:(0,a.jsx)(x,{children:e.label})},e.href))})]}),q.map(e=>(0,a.jsx)("a",{href:e.href,children:(0,a.jsx)(i.$,{variant:A.endsWith(e.href.split("/").pop())?"secondary":"ghost",children:e.label})},e.href))]}),D=(0,a.jsxs)(b.cj,{children:[(0,a.jsx)(b.CG,{asChild:!0,children:(0,a.jsxs)(i.$,{variant:"ghost",size:"icon",children:[(0,a.jsx)(s.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,a.jsxs)(b.h,{side:"right",className:"p-0 flex flex-col",children:[(0,a.jsx)(b.Fm,{className:"p-4 border-b",children:(0,a.jsx)(b.qp,{children:"Menu"})}),(0,a.jsx)(g.F,{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,a.jsx)("p",{className:"font-bold text-lg",children:"Compendium"}),_.map(e=>(0,a.jsx)("a",{href:e.href,children:(0,a.jsx)(i.$,{variant:A.endsWith(e.href.split("/").pop())?"secondary":"ghost",className:"w-full justify-start",children:e.label})},e.href)),(0,a.jsx)(j.w,{className:"my-2"}),(0,a.jsx)("p",{className:"font-bold text-lg",children:"Random"}),T.map(e=>(0,a.jsx)("a",{href:e.href,children:(0,a.jsx)(i.$,{variant:A.endsWith(e.href.split("/").pop())?"secondary":"ghost",className:"w-full justify-start",children:e.label})},e.href)),(0,a.jsx)(j.w,{className:"my-2"}),q.map(e=>(0,a.jsx)("a",{href:e.href,children:(0,a.jsx)(i.$,{variant:A.endsWith(e.href.split("/").pop())?"secondary":"ghost",className:"w-full justify-start",children:e.label})},e.href))]})})]})]}),F=!!u;return(0,a.jsxs)("div",{className:"flex flex-col h-screen",style:{width:"100%"},children:[(0,a.jsxs)("header",{className:"py-4 px-6 md:px-8 border-b border-border flex items-center justify-between shrink-0 bg-background/80 backdrop-blur-sm sticky top-0 z-20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[F&&t&&(0,a.jsx)(N.x2,{}),(0,a.jsxs)("a",{href:"/#",className:"flex items-center gap-3",children:[(0,a.jsx)(n.A,{className:"text-primary h-8 w-8"}),(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-headline font-bold text-primary-foreground whitespace-nowrap",children:z})]}),F&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.w,{orientation:"vertical",className:"h-6 mx-2 hidden md:block"}),(0,a.jsx)("nav",{className:"hidden md:flex items-center gap-1",children:X})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[d&&u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",ref:f,onChange:W,accept:".json",className:"hidden"}),(0,a.jsxs)(P.Lt,{children:[(0,a.jsx)(P.tv,{asChild:!0,children:(0,a.jsxs)(i.$,{variant:"ghost",size:"icon",title:"Import Data",children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Import Data"})]})}),(0,a.jsxs)(P.EO,{children:[(0,a.jsxs)(P.wd,{children:[(0,a.jsx)(P.r7,{children:"Import Data?"}),(0,a.jsx)(P.$v,{children:"This will overwrite all existing data in the current world with data from the selected JSON file. This action cannot be undone."})]}),(0,a.jsxs)(P.ck,{children:[(0,a.jsx)(P.Zr,{children:"Cancel"}),(0,a.jsx)(P.Rx,{onClick:()=>{var e;return null==(e=f.current)?void 0:e.click()},children:"Proceed"})]})]})]}),(0,a.jsxs)(i.$,{variant:"ghost",size:"icon",title:"Export Data",onClick:U,children:[(0,a.jsx)(l.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Export Data"})]})]}),F&&(0,a.jsx)("div",{className:"md:hidden",children:D})]})]}),(0,a.jsx)("main",{className:"flex-1 min-h-0",children:r})]})}},90010:(e,r,t)=>{t.d(r,{$v:()=>h,EO:()=>m,Lt:()=>l,Rx:()=>y,Zr:()=>x,ck:()=>w,r7:()=>p,tv:()=>i,wd:()=>f});var a=t(95155),o=t(12115),s=t(62278),n=t(59434),c=t(30285);let l=s.bL,i=s.l9,d=s.ZL,u=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(s.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...o,ref:r})});u.displayName=s.hJ.displayName;let m=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(u,{}),(0,a.jsx)(s.UC,{ref:r,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o})]})});m.displayName=s.UC.displayName;let f=e=>{let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",r),...t})};f.displayName="AlertDialogHeader";let w=e=>{let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};w.displayName="AlertDialogFooter";let p=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(s.hE,{ref:r,className:(0,n.cn)("text-lg font-semibold",t),...o})});p.displayName=s.hE.displayName;let h=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(s.VY,{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...o})});h.displayName=s.VY.displayName;let y=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(s.rc,{ref:r,className:(0,n.cn)((0,c.r)(),t),...o})});y.displayName=s.rc.displayName;let x=o.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,a.jsx)(s.ZD,{ref:r,className:(0,n.cn)((0,c.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...o})});x.displayName=s.ZD.displayName},92745:(e,r,t)=>{t.d(r,{wo:()=>U,UU:()=>ey.UU,RW:()=>c,W$:()=>m,yV:()=>K,Fs:()=>x,vg:()=>P,sB:()=>eo,B5:()=>Z,Ys:()=>eP,NV:()=>ei,SE:()=>ew,TG:()=>q,JE:()=>H,Dp:()=>R,gL:()=>E,PW:()=>i,wz:()=>w,OO:()=>O,ZJ:()=>j,p6:()=>v,Bx:()=>en,LD:()=>B,GY:()=>ev,Pb:()=>eu,Sj:()=>eh,HN:()=>D,vm:()=>$,uT:()=>a.uT,P7:()=>ex,rD:()=>W,vV:()=>k,bj:()=>ey.bj,OG:()=>o,xy:()=>d,J0:()=>F,MY:()=>g,eS:()=>h,vq:()=>et,i7:()=>J,xW:()=>eg,Qg:()=>ec,Wt:()=>em,SP:()=>_,r:()=>V,h4:()=>S,s2:()=>s,C8:()=>n,hP:()=>ej,rp:()=>u,pT:()=>p,RT:()=>G,eq:()=>y,Uh:()=>N,vR:()=>ea,u_:()=>Q,zU:()=>eN,ES:()=>el,Bf:()=>ef,_w:()=>T,X_:()=>er,qp:()=>C,Qx:()=>eb,Uj:()=>a.Uj,XN:()=>a.XN,S9:()=>z,_1:()=>ey._1,ZK:()=>l,kO:()=>f,sO:()=>I,H$:()=>b,R1:()=>L,mu:()=>es,fk:()=>M,cA:()=>eL,T2:()=>ed,mo:()=>ep,xX:()=>X,Ld:()=>A});var a=t(82489);let o=async()=>{let e=(await (0,a.Lf)()).transaction(a.RN,"readonly").objectStore(a.RN).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},s=async e=>{let r=(await (0,a.Lf)()).transaction(a.RN,"readonly").objectStore(a.RN).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},n=async e=>{if(!e||0===e.length)return[];let r=(await (0,a.Lf)()).transaction(a.RN,"readonly").objectStore(a.RN),t=[],o=e.map(e=>new Promise((a,o)=>{let s=r.get(e);s.onsuccess=()=>{s.result&&t.push(s.result),a()},s.onerror=()=>o(s.error)}));return await Promise.all(o),t},c=async e=>{let r=(await (0,a.Lf)()).transaction(a.RN,"readwrite").objectStore(a.RN),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},l=async e=>{let r=(await (0,a.Lf)()).transaction(a.RN,"readwrite").objectStore(a.RN).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},i=async e=>{let r=(await (0,a.Lf)()).transaction(a.RN,"readwrite").objectStore(a.RN).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},d=async()=>{let e=(await (0,a.Lf)()).transaction(a.qi,"readonly").objectStore(a.qi).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},u=async e=>{let r=(await (0,a.Lf)()).transaction(a.qi,"readonly").objectStore(a.qi).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},m=async e=>{let r=(await (0,a.Lf)()).transaction(a.qi,"readwrite").objectStore(a.qi),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},f=async e=>{let r=(await (0,a.Lf)()).transaction(a.qi,"readwrite").objectStore(a.qi).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},w=async e=>{let r=(await (0,a.Lf)()).transaction(a.qi,"readwrite").objectStore(a.qi).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},p=async e=>{if(!e||0===e.length)return[];let r=(await (0,a.Lf)()).transaction(a.qi,"readonly").objectStore(a.qi),t=[],o=e.map(e=>new Promise((a,o)=>{let s=r.get(e);s.onsuccess=()=>{s.result&&t.push(s.result),a()},s.onerror=()=>o(s.error)}));return await Promise.all(o),t},h=async()=>{let e=(await (0,a.Lf)()).transaction(a.l_,"readonly").objectStore(a.l_).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},y=async e=>{let r=(await (0,a.Lf)()).transaction(a.l_,"readonly").objectStore(a.l_).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},x=async e=>{let r=(await (0,a.Lf)()).transaction(a.l_,"readwrite").objectStore(a.l_),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},b=async e=>{let r=(await (0,a.Lf)()).transaction(a.l_,"readwrite").objectStore(a.l_).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},j=async e=>{let r=(await (0,a.Lf)()).transaction(a.l_,"readwrite").objectStore(a.l_).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},g=async()=>{let e=(await (0,a.Lf)()).transaction(a.yX,"readonly").objectStore(a.yX).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},N=async e=>{let r=(await (0,a.Lf)()).transaction(a.yX,"readonly").objectStore(a.yX).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},P=async e=>{let r=(await (0,a.Lf)()).transaction(a.yX,"readwrite").objectStore(a.yX),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},L=async e=>{let r=(await (0,a.Lf)()).transaction(a.yX,"readwrite").objectStore(a.yX).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},v=async e=>{let r=(await (0,a.Lf)()).transaction(a.yX,"readwrite").objectStore(a.yX).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},S=async()=>{let e=(await (0,a.Lf)()).transaction(a.zG,"readonly").objectStore(a.zG).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},C=async e=>{let r=(await (0,a.Lf)()).transaction(a.zG,"readonly").objectStore(a.zG).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},R=async e=>{let r=(await (0,a.Lf)()).transaction(a.zG,"readwrite").objectStore(a.zG),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},A=async e=>{let r=(await (0,a.Lf)()).transaction(a.zG,"readwrite").objectStore(a.zG).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},$=async e=>{let r=(await (0,a.Lf)()).transaction(a.zG,"readwrite").objectStore(a.zG).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},k=async()=>{let e=(await (0,a.Lf)()).transaction(a.rP,"readonly").objectStore(a.rP).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},W=async e=>{let r=(await (0,a.Lf)()).transaction(a.rP,"readonly").objectStore(a.rP).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},U=async e=>{let r=(await (0,a.Lf)()).transaction(a.rP,"readwrite").objectStore(a.rP),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},z=async e=>{let r=(await (0,a.Lf)()).transaction(a.rP,"readwrite").objectStore(a.rP).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},E=async e=>{let r=(await (0,a.Lf)()).transaction(a.rP,"readwrite").objectStore(a.rP).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},_=async()=>{let e=(await (0,a.Lf)()).transaction(a.NK,"readonly").objectStore(a.NK).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},T=async e=>{let r=(await (0,a.Lf)()).transaction(a.NK,"readonly").objectStore(a.NK).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},q=async e=>{let r=(await (0,a.Lf)()).transaction(a.NK,"readwrite").objectStore(a.NK),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},X=async e=>{let r=(await (0,a.Lf)()).transaction(a.NK,"readwrite").objectStore(a.NK).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},D=async e=>{let r=(await (0,a.Lf)()).transaction(a.NK,"readwrite").objectStore(a.NK).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},F=async()=>{let e=(await (0,a.Lf)()).transaction(a.Qu,"readonly").objectStore(a.Qu).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},G=async e=>{let r=(await (0,a.Lf)()).transaction(a.Qu,"readonly").objectStore(a.Qu).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},K=async e=>{let r=(await (0,a.Lf)()).transaction(a.Qu,"readwrite").objectStore(a.Qu),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},I=async e=>{let r=(await (0,a.Lf)()).transaction(a.Qu,"readwrite").objectStore(a.Qu).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},O=async e=>{let r=(await (0,a.Lf)()).transaction(a.Qu,"readwrite").objectStore(a.Qu).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},J=async()=>{let e=(await (0,a.Lf)()).transaction(a.TP,"readonly").objectStore(a.TP).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},Q=async e=>{let r=(await (0,a.Lf)()).transaction(a.TP,"readonly").objectStore(a.TP).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},Z=async e=>{let r=(await (0,a.Lf)()).transaction(a.TP,"readwrite").objectStore(a.TP),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},M=async e=>{let r=(await (0,a.Lf)()).transaction(a.TP,"readwrite").objectStore(a.TP).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},B=async e=>{let r=(await (0,a.Lf)()).transaction(a.TP,"readwrite").objectStore(a.TP).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},V=async()=>{let e=(await (0,a.Lf)()).transaction(a.C2,"readonly").objectStore(a.C2).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},Y=async e=>{let r=(await (0,a.Lf)()).transaction(a.C2,"readwrite").objectStore(a.C2).add(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>{var a;(null==(a=r.error)?void 0:a.name)!=="ConstraintError"?t(r.error):e()}})},H=async(e,r)=>{e&&0!==e.length&&await Promise.all(e.map(e=>Y({name:e,source:r})))},ee=async(e,r)=>{let t=r.transaction(e,"readonly").objectStore(e).getAll();return new Promise((e,r)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>r(t.error)})},er=async(e,r)=>{let t,o=await (0,a.Lf)();switch(e){case"creature":t=a.RN;break;case"deed":t=a.qi;break;case"encounter":t=a.l_;break;case"encounterTable":t=a.yX;break;case"treasure":t=a.zG;break;case"alchemicalItem":t=a.rP;break;case"room":t=a.NK;break;case"item":t=a.TP;break;case"faction":t=a.U3;break;case"npc":t=a.Xc;break;case"pantheon":t=a.W7;break;default:return[]}let s=await ee(t,o),n=new Map;for(let e of s)if(e.tags&&Array.isArray(e.tags))for(let r of e.tags)n.set(r,(n.get(r)||0)+1);return Array.from(n.entries()).sort((e,r)=>r[1]-e[1]).map(e=>e[0]).slice(0,r)},et=async()=>{let e=(await (0,a.Lf)()).transaction(a.U3,"readonly").objectStore(a.U3).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},ea=async e=>{let r=(await (0,a.Lf)()).transaction(a.U3,"readonly").objectStore(a.U3).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},eo=async e=>{let r=(await (0,a.Lf)()).transaction(a.U3,"readwrite").objectStore(a.U3),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},es=async e=>{let r=(await (0,a.Lf)()).transaction(a.U3,"readwrite").objectStore(a.U3).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},en=async e=>{let r=(await (0,a.Lf)()).transaction(a.U3,"readwrite").objectStore(a.U3).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},ec=async()=>{let e=(await (0,a.Lf)()).transaction(a.Xc,"readonly").objectStore(a.Xc).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},el=async e=>{let r=(await (0,a.Lf)()).transaction(a.Xc,"readonly").objectStore(a.Xc).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},ei=async e=>{let r=(await (0,a.Lf)()).transaction(a.Xc,"readwrite").objectStore(a.Xc),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},ed=async e=>{let r=(await (0,a.Lf)()).transaction(a.Xc,"readwrite").objectStore(a.Xc).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},eu=async e=>{let r=(await (0,a.Lf)()).transaction(a.Xc,"readwrite").objectStore(a.Xc).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},em=async()=>{let e=(await (0,a.Lf)()).transaction(a.W7,"readonly").objectStore(a.W7).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},ef=async e=>{let r=(await (0,a.Lf)()).transaction(a.W7,"readonly").objectStore(a.W7).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},ew=async e=>{let r=(await (0,a.Lf)()).transaction(a.W7,"readwrite").objectStore(a.W7),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},ep=async e=>{let r=(await (0,a.Lf)()).transaction(a.W7,"readwrite").objectStore(a.W7).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},eh=async e=>{let r=(await (0,a.Lf)()).transaction(a.W7,"readwrite").objectStore(a.W7).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})};t(52874);var ey=t(2868);let ex=async e=>{(0,a.YJ)(e);let r=await (0,a.Lf)(),t=a.Ni,o=r.transaction(t,"readonly"),s=t.map(e=>new Promise((r,t)=>{let a=o.objectStore(e).getAll();a.onsuccess=()=>r({name:e,data:a.result}),a.onerror=()=>t(a.error)})),n=await Promise.all(s),c={};return n.forEach(e=>{c[e.name]=e.data}),c},eb=async e=>{let r=await (0,a.Lf)();if("object"!=typeof e||null===e)return Promise.reject(Error("Invalid import file format. Expected an object with arrays of data."));let t=a.Ni,o=r.transaction(t,"readwrite"),s={};t.forEach(e=>{s[e]=o.objectStore(e),s[e].clear()});let n=new Map,c=(e,r)=>{e&&Array.isArray(e)&&e.forEach(e=>{let t="".concat(e,"|").concat(r);n.has(t)||n.set(t,{name:e,source:r})})},l=(e,r)=>{r&&Array.isArray(r)&&r.forEach(r=>{s[e].put(r),"tags"in r&&c(r.tags,e)})};return t.forEach(r=>{l(r,e[r])}),n.forEach(e=>{s.tags.put(e)}),new Promise((e,r)=>{o.oncomplete=()=>e(),o.onerror=()=>r(o.error)})},ej=async e=>{if(!e||0===e.length)return[];let r=await n(e);if(0===r.length)return[];let t=[...new Set(r.flatMap(e=>e.deeds))],a=new Map((await p(t)).map(e=>[e.id,e]));return r.map(e=>{let r=[];return"string"==typeof e.abilities&&e.abilities.length>0?r=e.abilities.split("\n\n").map(e=>{let r=e.match(RegExp("\\*\\*(.*?):\\*\\*\\s*(.*)","s"));return r&&r[1]&&r[2]?{id:crypto.randomUUID(),name:r[1],description:r[2].trim()}:!r&&e.trim()?{id:crypto.randomUUID(),name:"Ability",description:e.trim()}:null}).filter(e=>null!==e):Array.isArray(e.abilities)&&(r=e.abilities.map(e=>({...e,id:e.id||crypto.randomUUID()}))),{...e,abilities:r,deeds:e.deeds.map(e=>a.get(e)).filter(e=>!!e)}})},eg=async()=>{let e=(await (0,a.Lf)()).transaction(a.ux,"readonly").objectStore(a.ux).getAll();return new Promise((r,t)=>{e.onsuccess=()=>r(e.result),e.onerror=()=>t(e.error)})},eN=async e=>{let r=(await (0,a.Lf)()).transaction(a.ux,"readonly").objectStore(a.ux).get(e);return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},eP=async e=>{let r=(await (0,a.Lf)()).transaction(a.ux,"readwrite").objectStore(a.ux),t=(0,a.$C)(),o={...e,id:t},s=r.add(o);return new Promise((e,r)=>{s.onsuccess=()=>e(t),s.onerror=()=>r(s.error)})},eL=async e=>{let r=(await (0,a.Lf)()).transaction(a.ux,"readwrite").objectStore(a.ux).put(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})},ev=async e=>{let r=(await (0,a.Lf)()).transaction(a.ux,"readwrite").objectStore(a.ux).delete(e);return new Promise((e,t)=>{r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})}}}]);