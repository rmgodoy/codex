(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[181],{12543:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},13930:(e,s,a)=>{"use strict";a.d(s,{W$:()=>n,kO:()=>i,pT:()=>d,rp:()=>t,wz:()=>c,xy:()=>l});var r=a(82489);let l=async()=>{let e=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).getAll();return new Promise((s,a)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>a(e.error)})},t=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).get(e);return new Promise((e,a)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>a(s.error)})},n=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi),a=(0,r.$C)(),l={...e,id:a},t=s.add(l);return new Promise((e,s)=>{t.onsuccess=()=>e(a),t.onerror=()=>s(t.error)})},i=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).put(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})},c=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).delete(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})},d=async e=>{if(!e||0===e.length)return[];let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi),a=[],l=e.map(e=>new Promise((r,l)=>{let t=s.get(e);t.onsuccess=()=>{t.result&&a.push(t.result),r()},t.onerror=()=>l(t.error)}));return await Promise.all(l),a}},14337:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]])},15599:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},20203:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},23062:(e,s,a)=>{"use strict";a.d(s,{FC:()=>l,GW:()=>r,H1:()=>x,OJ:()=>t,Rb:()=>m,Vx:()=>p,Vz:()=>u,Yh:()=>n,_d:()=>j,ag:()=>i,gG:()=>g,gV:()=>o,qY:()=>d,w$:()=>c,zE:()=>h});let r=["attack","support"],l=["melee","missile","innate","unarmed","spell","item","versatile"],t=["guard","resist","10","special"],n=["potion","powder","oil","bomb"],i=["lesser","greater"],c=["weapon","armor","shield","tool"],d=["crude","normal","fine"],o=["normal","magical","artifact"],m=["melee","missile","spell","unarmed"],h=["d4","d6","d8","d10","d12","d20"],u=["one-handed","two-handed","thrown"],x=["head","chest","arms","legs","outer"],p=["head","chest","arms","legs","outer","shield"],j=["None","Light","Heavy"],g=["d4","d6","d8","d10","d12","d20"]},33689:(e,s,a)=>{"use strict";a.d(s,{B5:()=>n,LD:()=>c,fk:()=>i,i7:()=>l,u_:()=>t});var r=a(82489);let l=async()=>{let e=(await (0,r.Lf)()).transaction(r.TP,"readonly").objectStore(r.TP).getAll();return new Promise((s,a)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>a(e.error)})},t=async e=>{let s=(await (0,r.Lf)()).transaction(r.TP,"readonly").objectStore(r.TP).get(e);return new Promise((e,a)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>a(s.error)})},n=async e=>{let s=(await (0,r.Lf)()).transaction(r.TP,"readwrite").objectStore(r.TP),a=(0,r.$C)(),l={...e,id:a},t=s.add(l);return new Promise((e,s)=>{t.onsuccess=()=>e(a),t.onerror=()=>s(t.error)})},i=async e=>{let s=(await (0,r.Lf)()).transaction(r.TP,"readwrite").objectStore(r.TP).put(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})},c=async e=>{let s=(await (0,r.Lf)()).transaction(r.TP,"readwrite").objectStore(r.TP).delete(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})}},34301:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},53054:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},54165:(e,s,a)=>{"use strict";a.d(s,{Cf:()=>h,Es:()=>x,L3:()=>p,c7:()=>u,lG:()=>c,rr:()=>j,zM:()=>d});var r=a(95155),l=a(12115),t=a(45821),n=a(25318),i=a(59434);let c=t.bL,d=t.l9,o=t.ZL;t.bm;let m=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.hJ,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l})});m.displayName=t.hJ.displayName;let h=l.forwardRef((e,s)=>{let{className:a,children:l,...c}=e;return(0,r.jsxs)(o,{children:[(0,r.jsx)(m,{}),(0,r.jsxs)(t.UC,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[l,(0,r.jsxs)(t.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=t.UC.displayName;let u=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};u.displayName="DialogHeader";let x=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};x.displayName="DialogFooter";let p=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.hE,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...l})});p.displayName=t.hE.displayName;let j=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.VY,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})});j.displayName=t.VY.displayName},57662:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>_});var r=a(95155),l=a(12115),t=a(62709),n=a(20031),i=a(47906),c=a(33689),d=a(23062),o=a(62523),m=a(30285),h=a(66424),u=a(22346),x=a(87481),p=a(34301),j=a(75074),g=a(20203),f=a(73926),y=a(85057),v=a(59409),w=a(90648);function N(e){let{onSelectItem:s,onNewItem:a,selectedItemId:t,dataVersion:n,filters:i,setFilters:N,onClearFilters:b}=e,[C,T]=(0,l.useState)([]),[z,S]=(0,l.useState)(!0),{toast:A}=(0,x.dj)();(0,l.useEffect)(()=>{(async()=>{S(!0);try{T(await (0,c.i7)())}catch(e){A({variant:"destructive",title:"Error",description:"Could not fetch items from database."})}finally{S(!1)}})()},[n,A]);let D=(0,l.useMemo)(()=>{let e=C.filter(e=>{let s=e.name.toLowerCase().includes(i.searchTerm.toLowerCase()),a="all"===i.typeFilter||e.type===i.typeFilter,r="all"===i.qualityFilter||e.quality===i.qualityFilter,l="all"===i.magicTierFilter||e.magicTier===i.magicTierFilter,t=!0,n=i.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return n.length>0&&(t=!!e.tags&&n.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&a&&r&&l&&t}),s={crude:0,normal:1,fine:2,magical:3},a=e.sort((e,a)=>{if("quality"===i.sortBy){let r=(s[e.quality]||0)-(s[a.quality]||0);if(0!==r)return r}if("price"===i.sortBy){let s=(e.price||0)-(a.price||0);if(0!==s)return s}if("type"===i.sortBy){let s=e.type.localeCompare(a.type);if(0!==s)return s}return e.name.localeCompare(a.name)});return"desc"===i.sortOrder&&a.reverse(),a},[C,i]);return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)(m.$,{onClick:a,className:"w-full",children:[(0,r.jsx)(p.A,{})," New Item"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(o.p,{placeholder:"Search items...",value:i.searchTerm,onChange:e=>N.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(y.J,{children:"Filter"}),(0,r.jsx)(m.$,{variant:"ghost",size:"sm",onClick:b,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,r.jsxs)(v.l6,{value:i.typeFilter,onValueChange:N.setTypeFilter,children:[(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{placeholder:"Filter by type"})}),(0,r.jsxs)(v.gC,{children:[(0,r.jsx)(v.eb,{value:"all",children:"All Types"}),d.w$.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,r.jsxs)(v.l6,{value:i.qualityFilter,onValueChange:N.setQualityFilter,children:[(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{placeholder:"Filter by quality"})}),(0,r.jsxs)(v.gC,{children:[(0,r.jsx)(v.eb,{value:"all",children:"All Qualities"}),d.qY.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,r.jsxs)(v.l6,{value:i.magicTierFilter,onValueChange:e=>N.setMagicTierFilter(e),children:[(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{placeholder:"Filter by Tier"})}),(0,r.jsxs)(v.gC,{children:[(0,r.jsx)(v.eb,{value:"all",children:"All Tiers"}),d.gV.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,r.jsx)(w.F,{value:i.tagFilter?i.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>N.setTagFilter(e.join(",")),placeholder:"Tags (e.g. consumable)",tagSource:"item"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.J,{children:"Sort by"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(v.l6,{value:i.sortBy,onValueChange:e=>N.setSortBy(e),children:[(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{placeholder:"Sort by"})}),(0,r.jsxs)(v.gC,{children:[(0,r.jsx)(v.eb,{value:"name",children:"Name"}),(0,r.jsx)(v.eb,{value:"type",children:"Type"}),(0,r.jsx)(v.eb,{value:"price",children:"Price"}),(0,r.jsx)(v.eb,{value:"quality",children:"Quality"})]})]}),(0,r.jsxs)(m.$,{variant:"ghost",size:"icon",onClick:()=>N.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===i.sortOrder?(0,r.jsx)(g.A,{className:"h-4 w-4"}):(0,r.jsx)(f.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,r.jsx)(u.w,{}),(0,r.jsx)(h.F,{className:"flex-1",children:(0,r.jsx)("div",{className:"p-4",children:z?(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading items..."}):D.length>0?(0,r.jsx)("ul",{className:"space-y-1",children:D.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(t===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name,(0,r.jsxs)("span",{className:"text-xs opacity-70 capitalize",children:[" (",e.type,"normal"!==e.magicTier?", ".concat(e.magicTier):"",")"]})]})},e.id))}):(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"No items found."})})})]})}var b=a(62177),C=a(90221),T=a(55594),z=a(13930),S=a(44218),A=a(66695),D=a(88539),I=a(90010),q=a(17759),k=a(12543),R=a(15599),E=a(18763),F=a(77223),M=a(25318),P=a(14337),B=a(53054),V=a(68856),L=a(26126),J=a(54165);let $=T.z.object({name:T.z.string().min(1,"Item name is required"),type:T.z.enum(d.w$),price:T.z.coerce.number().min(0,"Price must be a non-negative number"),quality:T.z.enum(d.qY),description:T.z.string().min(1,"Description is required"),magicTier:T.z.enum(d.gV),enchantment:T.z.string().optional(),assignedDeedId:T.z.string().optional(),magicalTrait:T.z.string().optional(),tags:T.z.array(T.z.string()).optional(),damageDie:T.z.enum(d.zE).optional(),weaponType:T.z.enum(d.Rb).optional(),range:T.z.coerce.number().optional(),property:T.z.enum(d.Vz).optional(),weaponEffect:T.z.string().optional(),placement:T.z.enum(d.Vx).optional(),weight:T.z.enum(d._d).optional(),AR:T.z.string().optional(),armorDie:T.z.enum(d.gG).optional()}).superRefine((e,s)=>{var a,r,l;"weapon"===e.type&&(e.damageDie||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Damage Die is required for weapons.",path:["damageDie"]}),e.weaponType||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Weapon Type is required for weapons.",path:["weaponType"]}),("missile"===e.weaponType||"spell"===e.weaponType)&&(void 0===e.range||e.range<1)&&s.addIssue({code:T.z.ZodIssueCode.custom,message:"Range is required for this weapon type.",path:["range"]}),e.property||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Property is required for weapons.",path:["property"]})),("armor"===e.type||"shield"===e.type)&&(e.placement||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Placement is required.",path:["placement"]}),(null==(l=e.AR)?void 0:l.trim())||s.addIssue({code:T.z.ZodIssueCode.custom,message:"AR is required.",path:["AR"]}),e.armorDie||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Armor Die is required.",path:["armorDie"]})),"armor"===e.type&&"shield"===e.placement&&s.addIssue({code:T.z.ZodIssueCode.custom,message:"Shield placement is for shields only.",path:["placement"]}),"shield"===e.type&&"shield"!==e.placement&&s.addIssue({code:T.z.ZodIssueCode.custom,message:"Shields must have shield placement.",path:["placement"]}),"magical"!==e.magicTier&&"artifact"!==e.magicTier||(null==(a=e.enchantment)?void 0:a.trim())||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Enchantment is required for magical items and artifacts.",path:["enchantment"]}),"artifact"!==e.magicTier||(null==(r=e.magicalTrait)?void 0:r.trim())||s.addIssue({code:T.z.ZodIssueCode.custom,message:"Magical Trait is required for artifacts.",path:["magicalTrait"]})}),Z=e=>{let{onSelectDeed:s,allDeeds:a,children:t}=e,[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(""),[m,u]=(0,l.useState)("all"),[x,p]=(0,l.useState)(""),j=(0,l.useMemo)(()=>a.filter(e=>{let s=e.name.toLowerCase().includes(c.toLowerCase()),a="all"===m||e.tier===m,r=x.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean),l=0===r.length||e.tags&&r.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)));return s&&a&&l}),[a,c,m,x]),g=e=>{s(e),i(!1)};return(0,r.jsxs)(J.lG,{open:n,onOpenChange:e=>{e||(d(""),u("all"),p("")),i(e)},children:[(0,r.jsx)(J.zM,{asChild:!0,children:t}),(0,r.jsxs)(J.Cf,{className:"sm:max-w-2xl h-[70vh] flex flex-col",children:[(0,r.jsx)(J.c7,{children:(0,r.jsx)(J.L3,{children:"Select a Deed"})}),(0,r.jsxs)("div",{className:"flex gap-2 mb-4 flex-wrap",children:[(0,r.jsx)(o.p,{placeholder:"Search deeds...",value:c,onChange:e=>d(e.target.value),className:"flex-1 min-w-[150px]"}),(0,r.jsxs)(v.l6,{value:m,onValueChange:u,children:[(0,r.jsx)(v.bq,{className:"w-full sm:w-[120px]",children:(0,r.jsx)(v.yv,{placeholder:"Filter tier"})}),(0,r.jsxs)(v.gC,{children:[(0,r.jsx)(v.eb,{value:"all",children:"All Tiers"}),(0,r.jsx)(v.eb,{value:"light",children:"Light"}),(0,r.jsx)(v.eb,{value:"heavy",children:"Heavy"}),(0,r.jsx)(v.eb,{value:"mighty",children:"Mighty"})]})]}),(0,r.jsx)("div",{className:"flex-1 min-w-[150px]",children:(0,r.jsx)(w.F,{value:x?x.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>p(e.join(",")),placeholder:"Filter by tags...",tagSource:"deed"})})]}),(0,r.jsx)(h.F,{className:"flex-1 border rounded-md p-4",children:(0,r.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,r.jsx)("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-accent cursor-pointer",onClick:()=>g(e),children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"font-semibold",children:[e.name," ",(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.tier,")"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.effects.hit})]})},e.id))})})]})]})},O={name:"",type:"weapon",price:0,quality:"normal",magicTier:"normal",description:"",tags:[],property:"one-handed",weaponType:"melee",damageDie:"d4",AR:"0",armorDie:"d4",weight:"None",placement:"head"};function W(e){let{itemId:s,isCreatingNew:a,template:t,onSaveSuccess:n,onDeleteSuccess:h,onUseAsTemplate:p,onEditCancel:j,onBack:g}=e,{toast:f}=(0,x.dj)(),[N,T]=(0,l.useState)(a),[J,W]=(0,l.useState)(!a&&!!s),[_,G]=(0,l.useState)(null),H=(0,i.a)(),[Y,Q]=(0,l.useState)([]),[U,K]=(0,l.useState)({}),[X,ee]=(0,l.useState)({}),[es,ea]=(0,l.useState)({}),er=(0,l.useMemo)(()=>a&&t?{...O,...t}:O,[a,t]),el=(0,b.mN)({resolver:(0,C.u)($),defaultValues:er}),{watch:et,setValue:en,getValues:ei}=el,ec=et("type"),ed=et("weaponType"),eo=et("magicTier"),em=(0,l.useRef)(ec),eh=et("assignedDeedId"),[eu,ex]=(0,l.useState)(null);(0,l.useEffect)(()=>{(0,z.xy)().then(Q)},[]),(0,l.useEffect)(()=>{eh&&Y.length>0?ex(Y.find(e=>e.id===eh)||null):ex(null)},[eh,Y]),(0,l.useEffect)(()=>{N&&("magical"===eo||"artifact"===eo)&&en("quality","fine")},[eo,N,en]),(0,l.useEffect)(()=>{let e=em.current;if(e===ec||!N)return;let s=ei();"weapon"===e?K({damageDie:s.damageDie,weaponType:s.weaponType,range:s.range,property:s.property,weaponEffect:s.weaponEffect}):"armor"===e?ee({placement:s.placement,weight:s.weight,AR:s.AR,armorDie:s.armorDie}):"shield"===e&&ea({placement:s.placement,weight:s.weight,AR:s.AR,armorDie:s.armorDie}),["damageDie","weaponType","range","property","weaponEffect","placement","weight","AR","armorDie"].forEach(e=>en(e,void 0)),"weapon"===ec?Object.entries(U).forEach(e=>{let[s,a]=e;return en(s,a)}):"armor"===ec?Object.entries(X).forEach(e=>{let[s,a]=e;return en(s,a)}):"shield"===ec&&(Object.entries(es).forEach(e=>{let[s,a]=e;return en(s,a)}),en("placement","shield",{shouldValidate:!0}),en("weight","None",{shouldValidate:!0})),em.current=ec},[ec,ei,en,N,U,X,es]),(0,l.useEffect)(()=>{(async()=>{if(a){el.reset(er),t?(G(t||null),K(t),ee(t),ea(t)):(K({property:"one-handed",weaponType:"melee",damageDie:"d4"}),ee({placement:"head",weight:"None",AR:"0",armorDie:"d4"}),ea({placement:"shield",weight:"None",AR:"0",armorDie:"d4"})),em.current=(null==t?void 0:t.type)||"weapon",T(!0),W(!1);return}if(!s){T(!1),W(!1),G(null);return}W(!0),T(!1);try{let e=await (0,c.u_)(s);e?(el.reset(e),G(e),K(e),"armor"===e.type?(ee(e),ea({})):"shield"===e.type?(ea(e),ee({})):(ee({}),ea({})),em.current=e.type):G(null)}catch(e){f({variant:"destructive",title:"Error",description:"Could not load item data."})}finally{W(!1)}})()},[s,a,el,f,er,t]);let ep=()=>{a?j():_&&(el.reset(_),K(_),"armor"===_.type?(ee(_),ea({})):"shield"===_.type?(ea(_),ee({})):(ee({}),ea({})),em.current=_.type,T(!1))},ej=async e=>{try{let r,l={name:e.name,type:e.type,price:e.price,quality:e.quality,description:e.description,magicTier:e.magicTier,tags:e.tags||[]};switch(e.type){case"weapon":l.damageDie=e.damageDie,l.weaponType=e.weaponType,l.range=e.range,l.property=e.property,l.weaponEffect=e.weaponEffect;break;case"armor":case"shield":l.placement=e.placement,l.weight=e.weight,l.AR=e.AR,l.armorDie=e.armorDie}("magical"===e.magicTier||"artifact"===e.magicTier)&&(l.enchantment=e.enchantment),"artifact"===e.magicTier&&(l.assignedDeedId=e.assignedDeedId,l.magicalTrait=e.magicalTrait);let t=e.tags||[];if(t.length>0&&await (0,S.JE)(t,"item"),a)r=await (0,c.B5)(l),f({title:"Item Created!",description:"".concat(e.name," has been added.")});else{if(!s)return;r=s,await (0,c.fk)({...l,id:s}),f({title:"Save Successful",description:"".concat(e.name," has been updated.")})}n(r),T(!1)}catch(e){f({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},eg=async()=>{if(s)try{await (0,c.LD)(s),f({title:"Item Deleted",description:"The item has been removed."}),h()}catch(e){f({variant:"destructive",title:"Deletion Failed",description:"Could not delete the item."})}};if(J)return(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(A.Zp,{children:[(0,r.jsx)(A.aR,{children:(0,r.jsx)(V.E,{className:"h-8 w-48"})}),(0,r.jsx)(A.Wu,{children:(0,r.jsx)(V.E,{className:"h-40 w-full"})})]})});if(!s&&!a)return(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(A.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,r.jsx)(A.Wu,{className:"text-center pt-6",children:(0,r.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select an item to view or create a new one."})})})});let ef=e=>{en("assignedDeedId",e.id,{shouldValidate:!0})};return!N&&_?(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(A.Zp,{children:[(0,r.jsx)(A.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[H&&g&&(0,r.jsx)(m.$,{variant:"ghost",size:"icon",onClick:g,className:"shrink-0 -ml-2 -mt-1",children:(0,r.jsx)(k.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(A.ZB,{className:"text-3xl font-bold",children:_.name}),(0,r.jsxs)(A.BT,{className:"capitalize flex flex-wrap gap-x-4",children:[(0,r.jsxs)("span",{children:[_.magicTier," ",_.type]}),(0,r.jsxs)("span",{children:["Quality: ",_.quality]}),(0,r.jsxs)("span",{children:["Price: ",_.price,"gp"]})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(m.$,{variant:"outline",size:"sm",onClick:()=>{_&&p(_)},children:[(0,r.jsx)(R.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Template"})]}),(0,r.jsxs)(m.$,{variant:"outline",size:"sm",onClick:()=>T(!0),children:[(0,r.jsx)(E.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})]})}),(0,r.jsx)(A.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(()=>{let e;if(!_)return null;switch(_.type){case"weapon":let s=("missile"===_.weaponType||"spell"===_.weaponType)&&_.range?"".concat(_.weaponType," (").concat(_.range,")"):_.weaponType;e=(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"Weapon Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Damage:"})," ",_.damageDie]}),(0,r.jsxs)("div",{className:"capitalize",children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Type:"})," ",s]}),(0,r.jsxs)("div",{className:"capitalize",children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Property:"})," ",_.property]})]}),_.weaponEffect&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Effect:"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:_.weaponEffect})]})]});break;case"armor":case"shield":e=(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"Armor/Shield Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Placement:"})," ",_.placement]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Weight:"})," ",_.weight]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"AR:"})," ",_.AR]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Armor Die:"})," ",_.armorDie]})]})]});break;default:e=null}let a=_.assignedDeedId?Y.find(e=>e.id===_.assignedDeedId):null;return(0,r.jsxs)(r.Fragment,{children:[_.description&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"Description"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:_.description})]}),e&&(0,r.jsx)(u.w,{}),e,("magical"===_.magicTier||"artifact"===_.magicTier)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.w,{}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"magical"===_.magicTier?"Magical Properties":"Artifact Properties"}),_.enchantment&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Enchantment:"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:_.enchantment})]}),"artifact"===_.magicTier&&_.magicalTrait&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Magical Trait:"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:_.magicalTrait})]}),a&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Granted Deed:"}),(0,r.jsx)("p",{className:"text-accent",children:a.name})]})]})]})]})})(),_.tags&&_.tags.length>0&&(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:_.tags.map(e=>(0,r.jsx)(L.E,{variant:"secondary",children:e},e))})})]})}),(0,r.jsx)(A.wL,{children:(0,r.jsxs)(I.Lt,{children:[(0,r.jsx)(I.tv,{asChild:!0,children:(0,r.jsx)(m.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(F.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(I.EO,{children:[(0,r.jsxs)(I.wd,{children:[(0,r.jsx)(I.r7,{children:"Are you sure?"}),(0,r.jsxs)(I.$v,{children:['This will permanently delete "',_.name,'".']})]}),(0,r.jsxs)(I.ck,{children:[(0,r.jsx)(I.Zr,{children:"Cancel"}),(0,r.jsx)(I.Rx,{onClick:eg,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(A.Zp,{children:(0,r.jsx)(q.lV,{...el,children:(0,r.jsxs)("form",{onSubmit:el.handleSubmit(ej),className:"space-y-6",children:[(0,r.jsx)(A.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[H&&g&&(0,r.jsx)(m.$,{type:"button",variant:"ghost",size:"icon",onClick:j,className:"shrink-0 -ml-2",children:(0,r.jsx)(k.A,{className:"h-5 w-5"})}),(0,r.jsx)(A.ZB,{children:a?"Create New Item":"Editing: ".concat(el.getValues("name")||"...")})]}),!H&&(0,r.jsx)(m.$,{type:"button",variant:"ghost",size:"icon",onClick:ep,className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(M.A,{className:"h-5 w-5"})})]})}),(0,r.jsxs)(A.Wu,{className:"space-y-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Base Properties"}),(0,r.jsx)(q.zB,{name:"name",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Item Name"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(o.p,{...s})}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"description",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Description"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(D.T,{...a,value:null!=(s=a.value)?s:"",rows:4})}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)(q.zB,{name:"type",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Type"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.w$.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"magicTier",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Tier"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.gV.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"quality",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Quality"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,disabled:"normal"!==eo,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.qY.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"price",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Price (gp)"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(o.p,{type:"number",...a,value:null!=(s=a.value)?s:""})}),(0,r.jsx)(q.C5,{})]})}})]}),(()=>{switch(ec){case"weapon":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.w,{}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Weapon Properties"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[(0,r.jsx)(q.zB,{name:"damageDie",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Damage Die"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.zE.map(e=>(0,r.jsx)(v.eb,{value:e,children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"weaponType",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Weapon Type"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.Rb.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),("missile"===ed||"spell"===ed)&&(0,r.jsx)(q.zB,{name:"range",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Range"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(o.p,{type:"number",...a,value:null!=(s=a.value)?s:"",placeholder:"e.g., 30"})}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"property",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Property"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.Vz.map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}})]}),(0,r.jsx)(q.zB,{name:"weaponEffect",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Weapon Effect"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(D.T,{...a,value:null!=(s=a.value)?s:"",rows:3})})]})}})]});case"armor":case"shield":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.w,{}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Armor/Shield Properties"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)(q.zB,{name:"placement",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Placement"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,disabled:"shield"===ec,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:("shield"===ec?["shield"]:d.H1).map(e=>(0,r.jsx)(v.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"weight",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Weight"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,disabled:"shield"===ec,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d._d.map(e=>(0,r.jsx)(v.eb,{value:e,children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"AR",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"AR"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(o.p,{...a,value:null!=(s=a.value)?s:"",placeholder:"e.g., +1"})}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsx)(q.zB,{name:"armorDie",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Armor Die"}),(0,r.jsxs)(v.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(q.MJ,{children:(0,r.jsx)(v.bq,{children:(0,r.jsx)(v.yv,{})})}),(0,r.jsx)(v.gC,{children:d.gG.map(e=>(0,r.jsx)(v.eb,{value:e,children:e},e))})]}),(0,r.jsx)(q.C5,{})]})}})]})]});default:return null}})(),("magical"===eo||"artifact"===eo)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.w,{}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Magical Properties"}),(0,r.jsx)(q.zB,{name:"enchantment",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Enchantment"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(D.T,{...a,value:null!=(s=a.value)?s:"",rows:4})}),(0,r.jsx)(q.C5,{})]})}})]}),"artifact"===eo&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.zB,{name:"magicalTrait",control:el.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsx)(q.lR,{children:"Magical Trait"}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(D.T,{...a,value:null!=(s=a.value)?s:"",rows:2})}),(0,r.jsx)(q.C5,{})]})}}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(y.J,{children:"Granted Deed"}),eu?(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-3",children:[(0,r.jsxs)("p",{className:"font-semibold",children:[eu.name," ",(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",eu.tier,")"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(Z,{onSelectDeed:ef,allDeeds:Y,children:(0,r.jsx)(m.$,{type:"button",variant:"outline",size:"sm",children:"Change"})}),(0,r.jsx)(m.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>{en("assignedDeedId",void 0,{shouldValidate:!0})},children:(0,r.jsx)(M.A,{className:"h-4 w-4"})})]})]}):(0,r.jsx)(Z,{onSelectDeed:ef,allDeeds:Y,children:(0,r.jsxs)(m.$,{type:"button",variant:"outline",size:"sm",className:"w-full",children:[(0,r.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Select a Deed"]})}),(0,r.jsx)(q.zB,{name:"assignedDeedId",control:el.control,render:()=>(0,r.jsx)(q.C5,{})})]})]}),(0,r.jsx)(u.w,{}),(0,r.jsx)(q.zB,{name:"tags",control:el.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(q.eI,{children:[(0,r.jsxs)(q.lR,{className:"flex items-center gap-2",children:[(0,r.jsx)(B.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,r.jsx)(q.MJ,{children:(0,r.jsx)(w.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"item"})}),(0,r.jsx)(q.C5,{})]})}})]}),(0,r.jsxs)(A.wL,{className:"flex items-center gap-2",children:[!a&&(0,r.jsxs)(I.Lt,{children:[(0,r.jsx)(I.tv,{asChild:!0,children:(0,r.jsx)(m.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(F.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(I.EO,{children:[(0,r.jsxs)(I.wd,{children:[(0,r.jsx)(I.r7,{children:"Are you sure?"}),(0,r.jsxs)(I.$v,{children:['This will permanently delete "',el.getValues("name"),'".']})]}),(0,r.jsxs)(I.ck,{children:[(0,r.jsx)(I.Zr,{children:"Cancel"}),(0,r.jsx)(I.Rx,{onClick:eg,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,r.jsx)("div",{className:"flex-grow"}),!H&&(0,r.jsx)(m.$,{type:"button",variant:"outline",onClick:ep,children:"Cancel"}),(0,r.jsx)(m.$,{type:"submit",children:a?"Create Item":"Save Changes"})]})]})})})})}function _(){let[e,s]=(0,l.useState)(null),[a,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(null),[m,h]=(0,l.useState)(0),[u,x]=(0,l.useState)(""),[p,j]=(0,l.useState)("all"),[g,f]=(0,l.useState)("all"),[y,v]=(0,l.useState)("all"),[w,b]=(0,l.useState)(""),[C,T]=(0,l.useState)("name"),[z,S]=(0,l.useState)("asc"),[A,D]=(0,l.useState)(!1),I=(0,i.a)(),[q,k]=(0,l.useState)("list");(0,l.useEffect)(()=>{D(!0)},[]);let R={searchTerm:u,typeFilter:p,qualityFilter:g,magicTierFilter:y,tagFilter:w,sortBy:C,sortOrder:z},E={setSearchTerm:x,setTypeFilter:j,setQualityFilter:f,setMagicTierFilter:v,setTagFilter:b,setSortBy:T,setSortOrder:S},F=()=>{x(""),j("all"),f("all"),v("all"),b(""),T("name"),S("asc")},M=()=>h(e=>e+1),P=e=>{s(e),c(!1),o(null),I&&k("editor")},B=()=>{s(null),c(!0),o(null),I&&k("editor")},V=e=>{let a={...e},r=(e.name||"item").replace(/^(Copy of\s*)+/,"");a.name="Copy of ".concat(r),delete a.id,s(null),c(!0),o(a),I&&k("editor")},L=e=>{M(),s(e),c(!1),o(null),I&&k("editor")},J=()=>{M(),s(null),c(!1),o(null),I&&k("list")},$=()=>{a&&(c(!1),s(null),I&&k("list"))};return A?I?(0,r.jsx)(t.A,{showSidebarTrigger:!1,children:(0,r.jsx)("div",{className:"h-full w-full",children:"list"===q?(0,r.jsx)(N,{onSelectItem:P,onNewItem:B,selectedItemId:e,dataVersion:m,filters:R,setFilters:E,onClearFilters:F}):(0,r.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,r.jsx)("div",{className:"p-4 sm:p-6",children:(0,r.jsx)(W,{itemId:e,isCreatingNew:a,template:d,onSaveSuccess:L,onDeleteSuccess:J,onUseAsTemplate:V,onEditCancel:$,onBack:()=>{k("list"),s(null),c(!1),o(null)}},null!=e?e:a?"new":"placeholder")})})})}):(0,r.jsx)(n.GB,{children:(0,r.jsx)(t.A,{children:(0,r.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,r.jsx)(n.Bx,{style:{"--sidebar-width":"380px"},children:(0,r.jsx)(N,{onSelectItem:P,onNewItem:B,selectedItemId:e,dataVersion:m,filters:R,setFilters:E,onClearFilters:F})}),(0,r.jsx)(n.sF,{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,r.jsx)(W,{itemId:e,isCreatingNew:a,template:d,onSaveSuccess:L,onDeleteSuccess:J,onUseAsTemplate:V,onEditCancel:$},null!=e?e:a?"new":"placeholder")})})]})})}):null}},68856:(e,s,a)=>{"use strict";a.d(s,{E:()=>t});var r=a(95155),l=a(59434);function t(e){let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-muted",s),...a})}},70656:(e,s,a)=>{Promise.resolve().then(a.bind(a,57662))},73926:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},75074:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[222,194,160,49,347,516,441,684,358],()=>s(70656)),_N_E=e.O()}]);