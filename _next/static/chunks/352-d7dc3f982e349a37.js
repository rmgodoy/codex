"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[352],{2868:(e,t,r)=>{r.d(t,{At:()=>c,UU:()=>o,_1:()=>l,bj:()=>n});var a=r(82489);let n=async e=>{let t=(await (0,a.Lf)()).transaction(a.$,"readonly").objectStore(a.$);if(!e||"all"===e){let e=t.getAll();return new Promise((t,r)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>r(e.error)})}let r=t.index("by_calendar").getAll(IDBKeyRange.only(e));return new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)})},o=async e=>{let t=(await (0,a.Lf)()).transaction(a.$,"readwrite").objectStore(a.$),r=(0,a.$C)(),n={...e,id:r},o=t.add(n);return new Promise((e,t)=>{o.onsuccess=()=>e(r),o.onerror=()=>t(o.error)})},l=async e=>{let t=(await (0,a.Lf)()).transaction(a.$,"readwrite").objectStore(a.$).put(e);return new Promise((e,r)=>{t.onsuccess=()=>e(),t.onerror=()=>r(t.error)})},c=async e=>{let t=(await (0,a.Lf)()).transaction(a.$,"readwrite").objectStore(a.$).delete(e);return new Promise((e,r)=>{t.onsuccess=()=>e(),t.onerror=()=>r(t.error)})}},7146:(e,t,r)=>{r.d(t,{Xk:()=>a,YS:()=>n,bi:()=>s,fh:()=>o,rX:()=>l,t1:()=>u});let a=e=>{let t=[];for(let r=-e;r<=e;r++){let a=Math.max(-e,-r-e),n=Math.min(e,-r+e);for(let e=a;e<=n;e++)t.push({q:r,r:e,s:-r-e})}return t.map(e=>({hex:e,data:{}}))},n=(e,t)=>{let r=[];for(let e=-t;e<=t;e++){let a=Math.max(-t,-e-t),n=Math.min(t,-e+t);for(let t=a;t<=n;t++)r.push({q:e,r:t,s:-e-t})}let a=new Map(e.map(e=>["".concat(e.hex.q,",").concat(e.hex.r),e]));return r.map(e=>{let t="".concat(e.q,",").concat(e.r),r=a.get(t);return r||{hex:e,data:{}}})},o=(e,t)=>({x:t*(1.5*e.q),y:t*(Math.sqrt(3)/2*e.q+Math.sqrt(3)*e.r)}),l=(e,t,r)=>{let a=Math.PI/180*(60*r);return{x:e.x+t*Math.cos(a),y:e.y+t*Math.sin(a)}},c=(e,t,r)=>{let a=Math.round(e),n=Math.round(t),o=Math.round(r),l=Math.abs(a-e),c=Math.abs(n-t),s=Math.abs(o-r);return l>c&&l>s?a=-n-o:c>s?n=-a-o:o=-a-n,{q:a,r:n,s:o}},s=(e,t,r)=>{let a=2/3*e/r,n=(-1/3*e+Math.sqrt(3)/3*t)/r;return c(a,n,-a-n)},i=[{q:1,r:0,s:-1},{q:1,r:-1,s:0},{q:0,r:-1,s:1},{q:-1,r:0,s:1},{q:-1,r:1,s:0},{q:0,r:1,s:-1}],u=e=>i.map(t=>({q:e.q+t.q,r:e.r+t.r,s:e.s+t.s}))},15510:(e,t,r)=>{r.d(t,{UU:()=>s,mu:()=>c,sB:()=>l,vR:()=>o,vq:()=>n});var a=r(82489);let n=async()=>{let e=(await (0,a.Lf)()).transaction(a.U3,"readonly").objectStore(a.U3).getAll();return new Promise((t,r)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>r(e.error)})},o=async e=>{let t=(await (0,a.Lf)()).transaction(a.U3,"readonly").objectStore(a.U3).get(e);return new Promise((e,r)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>r(t.error)})},l=async e=>{let t=(await (0,a.Lf)()).transaction(a.U3,"readwrite").objectStore(a.U3),r=(0,a.$C)(),n={...e,id:r},o=t.add(n);return new Promise((e,t)=>{o.onsuccess=()=>e(r),o.onerror=()=>t(o.error)})},c=async e=>{let t=(await (0,a.Lf)()).transaction(a.U3,"readwrite").objectStore(a.U3).put(e);return new Promise((e,r)=>{t.onsuccess=()=>e(),t.onerror=()=>r(t.error)})},s=async e=>{let t=(await (0,a.Lf)()).transaction(a.U3,"readwrite").objectStore(a.U3).delete(e);return new Promise((e,r)=>{t.onsuccess=()=>e(),t.onerror=()=>r(t.error)})}},19209:(e,t,r)=>{r.d(t,{A:()=>c});var a=r(95155),n=r(12115),o=r(7146);let l=(e,t,r,a,n)=>{let o=.9*a,l=o/24,{x:c,y:s}=t;e.save(),e.translate(c-o/2,s-o/2),e.scale(l,l),e.strokeStyle=n,e.lineWidth=1.5/l;let i=[];switch(r){case"Home":i=["m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z","M9 22V12h6v10"];break;case"Trees":i=["M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z","M7 16v6","M13 19v3","M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5"];break;case"Mountain":i=["m8 3 4 8 5-5 5 15H2L8 3z"];break;case"Castle":i=["M22 20v-9H2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2Z","M18 11V4H6v7","M15 22v-4a3 3 0 0 0-3-3a3 3 0 0 0-3 3v4","M22 11V9","M2 11V9","M6 4V2","M18 4V2","M10 4V2","M14 4V2"];break;case"TowerControl":i=["M18.2 12.27 20 6H4l1.8 6.27a1 1 0 0 0 .95.73h10.5a1 1 0 0 0 .96-.73Z","M8 13v9","M16 22v-9","m9 6 1 7","m15 6-1 7","M12 6V2","M13 2h-2"];break;case"Tent":i=["M3.5 21 14 3","M20.5 21 10 3","M15.5 21 12 15l-3.5 6","M2 21h20"];break;case"Waves":i=["M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1","M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1","M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"];break;case"MapPin":i=["M12 17v5","M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1 1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z"];break;case"Landmark":i=["M10 18v-7","M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z","M14 18v-7","M18 18v-7","M3 22h18","M6 18v-7"];break;case"Skull":i={paths:["m12.5 17-.5-1-.5 1h1z","M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"],circles:[{cx:15,cy:12,r:1},{cx:9,cy:12,r:1}]}}Array.isArray(i)?i.forEach(t=>{let r=new Path2D(t);e.stroke(r)}):(i.paths.forEach(t=>{let r=new Path2D(t);e.stroke(r)}),i.circles.forEach(t=>{e.beginPath(),e.arc(t.cx,t.cy,t.r,0,2*Math.PI),e.fillStyle=n,e.fill()})),e.restore()},c=e=>{let{grid:t,hexSize:r=25,className:c,onGridUpdate:s,onHexHover:i,onHexClick:u,activeTool:d,paintMode:h,paintColor:f,paintIcon:m,paintIconColor:x,selectedHex:g,isCtrlPressed:y,isEyedropperActive:p,onEyedropperClick:b}=e,M=(0,n.useRef)(null),w=(0,n.useRef)(null),v=(0,n.useRef)(null),[k,C]=(0,n.useState)({background:"#1A0024",border:"#4B0082",accent:"#8A2BE2",foreground:"#E0D6F0"}),[P,q]=(0,n.useState)({x:0,y:0,zoom:1}),S=(0,n.useRef)(P),[z,j]=(0,n.useState)(!1),[E,L]=(0,n.useState)({x:0,y:0}),[N,A]=(0,n.useState)(0),[R,Y]=(0,n.useState)(!1),[U,V]=(0,n.useState)(!1),[X,D]=(0,n.useState)(null),T=(0,n.useMemo)(()=>new Map(t.map(e=>["".concat(e.hex.q,",").concat(e.hex.r),e])),[t]);(0,n.useEffect)(()=>{S.current=P},[P]),(0,n.useEffect)(()=>{{let e=getComputedStyle(document.documentElement);C({background:"hsl(".concat(e.getPropertyValue("--background").trim(),")"),border:"hsl(".concat(e.getPropertyValue("--border").trim(),")"),accent:"hsl(".concat(e.getPropertyValue("--accent").trim(),")"),foreground:"hsl(".concat(e.getPropertyValue("--foreground").trim(),")")})}},[]);let B=(0,n.useCallback)((e,t)=>{let a=M.current;if(!a)return null;let n=S.current,l=a.getBoundingClientRect(),c=(e-(l.width/2+n.x))/n.zoom,s=(t-(l.height/2+n.y))/n.zoom;return(0,o.bi)(c,s,r)},[r]),$=(0,n.useCallback)(()=>{let e=M.current;if(!e)return;let t=e.getContext("2d");if(!t)return;let a=S.current,{width:n,height:l}=e.getBoundingClientRect();(e.width!==n||e.height!==l)&&(e.width=n,e.height=l),t.fillStyle=k.background,t.fillRect(0,0,n,l),t.save(),t.translate(n/2+a.x,l/2+a.y),t.scale(a.zoom,a.zoom);let c=a.zoom>.4?w.current:v.current;if(c&&c.width>0&&c.height>0){let e=c.width,r=c.height;t.drawImage(c,-e/2,-r/2)}let s=B(E.x,E.y);if(("paint"===d||p)&&s){let e=(0,o.fh)(s,r);t.beginPath();for(let a=0;a<6;a++){let n=(0,o.rX)(e,r,a);0===a?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y)}t.closePath(),t.fillStyle=k.accent,t.globalAlpha=.3,t.fill(),t.globalAlpha=1}if(g){let e=(0,o.fh)(g,r);t.beginPath();for(let a=0;a<6;a++){let n=(0,o.rX)(e,r,a);0===a?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y)}t.closePath(),t.strokeStyle=k.accent,t.lineWidth=3/a.zoom,t.stroke()}t.restore()},[B,r,k,E,g,d,p]);(0,n.useEffect)(()=>{if(!t.length||!M.current)return;let e=1/0,a=-1/0,n=1/0,c=-1/0;if(t.forEach(t=>{let{hex:r}=t;e=Math.min(e,r.q),a=Math.max(a,r.q),n=Math.min(n,r.r),c=Math.max(c,r.r)}),!isFinite(e))return;let s=(a-e+1)*r*1.5+.5*r,i=(c-n+1)*r*Math.sqrt(3)+r*Math.sqrt(3)/2;if(s<=0||i<=0)return;w.current||(w.current=document.createElement("canvas"));let u=w.current;u.width=s,u.height=i;let d=u.getContext("2d");v.current||(v.current=document.createElement("canvas"));let h=v.current;h.width=s,h.height=i;let f=h.getContext("2d");if(!d||!f)return;d.clearRect(0,0,s,i),f.clearRect(0,0,s,i),d.translate(s/2,i/2),f.translate(s/2,i/2);let m=new Map,x=new Map,g=[],y=new Path2D;t.forEach(e=>{let{hex:t,data:a}=e,n=(0,o.fh)(t,r),l=new Path2D;for(let e=0;e<6;e++){let t=(0,o.rX)(n,r,e);0===e?l.moveTo(t.x,t.y):l.lineTo(t.x,t.y)}l.closePath(),y.addPath(l);let c=a.color||k.background;m.has(c)||m.set(c,new Path2D),m.get(c).addPath(l),a.icon&&g.push({center:n,icon:a.icon,iconColor:a.iconColor||k.foreground});let s=a.color||k.background;x.has(s)||x.set(s,new Path2D),x.get(s).addPath(l)}),m.forEach((e,t)=>{d.fillStyle=t,d.fill(e)}),d.strokeStyle=k.border,d.lineWidth=1,d.stroke(y),g.forEach(e=>{let{center:t,icon:a,iconColor:n}=e;l(d,t,a,r,n)}),x.forEach((e,t)=>{f.fillStyle=t,f.fill(e)}),$()},[t,r,k,$]),(0,n.useEffect)(()=>{$()},[P,$]);let H=(0,n.useCallback)(e=>{let r=T.get("".concat(e.q,",").concat(e.r));if(!r)return;let a=r.data.color,n=r.data.icon;if(a===f&&n===m)return;let l=new Set,c=[e],i=new Set(["".concat(e.q,",").concat(e.r)]);for(l.add("".concat(e.q,",").concat(e.r));c.length>0;){let e=c.shift();for(let t of(0,o.t1)(e)){let e="".concat(t.q,",").concat(t.r);if(!i.has(e)){i.add(e);let r=T.get(e);r&&r.data.color===a&&r.data.icon===n&&(l.add(e),c.push(t))}}}l.size>0&&s(t.map(e=>l.has("".concat(e.hex.q,",").concat(e.hex.r))?{...e,data:{...e.data,color:f,icon:m,iconColor:x}}:e))},[t,T,f,m,x,s]),W=(0,n.useCallback)(e=>{s(t.map(t=>t.hex.q===e.q&&t.hex.r===e.r?"erase"===h?{...t,data:{...t.data,color:void 0,icon:void 0,iconColor:void 0}}:{...t,data:{...t.data,color:f,icon:m,iconColor:x}}:t))},[t,f,m,x,s,h]),_=(0,n.useCallback)(e=>{e.preventDefault();let t=M.current.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top,n=B(r,a);if(n){if(p)return void b(n);if(2===e.button||1===e.button){j(!0),L({x:r,y:a});return}"paint"===d?"brush"===h&&y||"bucket"===h?H(n):("brush"===h||"erase"===h)&&(V(!0),W(n),D(n)):u(n)}},[B,u,h,W,H,d,y,p,b]),F=(0,n.useCallback)(e=>{let t=M.current.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top;if(z){let e=r-E.x,t=a-E.y;L({x:r,y:a}),S.current.x+=e,S.current.y+=t,requestAnimationFrame($);return}L({x:r,y:a});let n=B(r,a);i(n),"paint"===d&&("brush"===h||"erase"===h)&&U&&n&&(!X||n.q!==X.q||n.r!==X.r)&&(W(n),D(n))},[z,E,B,h,U,W,i,d,$]),I=(0,n.useCallback)(e=>{e.preventDefault();let t=e.touches,r=M.current.getBoundingClientRect();if(1===t.length){let e=t[0],a=e.clientX-r.left,n=e.clientY-r.top,o=B(a,n);if(p){o&&b(o);return}j(!0),L({x:a,y:n}),"paint"===d&&("brush"===h||"erase"===h)?o&&(V(!0),W(o),D(o)):o&&u(o)}else if(2===t.length){j(!0),Y(!0);let e=t[0],a=t[1];A(Math.hypot(e.clientX-a.clientX,e.clientY-a.clientY)),L({x:(e.clientX+a.clientX)/2-r.left,y:(e.clientY+a.clientY)/2-r.top})}},[B,p,b,d,h,W,u]),Z=(0,n.useCallback)(e=>{e.preventDefault();let t=e.touches,r=M.current.getBoundingClientRect();if(1!==t.length||R){if(2===t.length&&z){let e=t[0],a=t[1],n=Math.hypot(e.clientX-a.clientX,e.clientY-a.clientY),o={x:(e.clientX+a.clientX)/2-r.left,y:(e.clientY+a.clientY)/2-r.top},l=n/N,c=Math.max(.1,Math.min(5,S.current.zoom*l)),s=(o.x-(r.width/2+S.current.x))/S.current.zoom,i=(o.y-(r.height/2+S.current.y))/S.current.zoom,u=o.x-s*c-r.width/2,d=o.y-i*c-r.height/2;S.current={x:u,y:d,zoom:c},q({x:u,y:d,zoom:c}),A(n),L(o)}}else{let e=t[0],a=e.clientX-r.left,n=e.clientY-r.top,o=a-E.x,l=n-E.y;if(U){let e=B(a,n);e&&(!X||e.q!==X.q||e.r!==X.r)&&(W(e),D(e))}else z&&(S.current.x+=o,S.current.y+=l,requestAnimationFrame($));L({x:a,y:n})}},[z,R,U,E,N,$,B,W,X]),G=(0,n.useCallback)(e=>{j(!1),Y(!1),V(!1),D(null),0===e.touches.length&&i(null)},[i]);return(0,a.jsx)("canvas",{ref:M,className:c,onMouseDown:_,onMouseUp:e=>{0===e.button&&(V(!1),D(null)),(2===e.button||1===e.button)&&z&&(j(!1),q({...S.current}))},onMouseMove:F,onMouseLeave:()=>{z&&(j(!1),q({...S.current})),V(!1),D(null),i(null)},onWheel:e=>{e.preventDefault();let t=S.current,r=e.deltaY<0?1.1*t.zoom:t.zoom/1.1,a=M.current;if(!a)return;let n=a.getBoundingClientRect(),o=e.clientX-n.left,l=e.clientY-n.top,c=(o-(n.width/2+t.x))/t.zoom,s=(l-(n.height/2+t.y))/t.zoom,i=o-c*r-n.width/2,u=l-s*r-n.height/2,d=Math.max(.1,Math.min(5,r));S.current={x:i,y:u,zoom:d},q({x:i,y:u,zoom:d})},onTouchStart:I,onTouchMove:Z,onTouchEnd:G,onContextMenu:e=>e.preventDefault()})}},22604:(e,t,r)=>{r.d(t,{GY:()=>s,Ys:()=>l,cA:()=>c,xW:()=>n,zU:()=>o});var a=r(82489);let n=async()=>{let e=(await (0,a.Lf)()).transaction(a.ux,"readonly").objectStore(a.ux).getAll();return new Promise((t,r)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>r(e.error)})},o=async e=>{let t=(await (0,a.Lf)()).transaction(a.ux,"readonly").objectStore(a.ux).get(e);return new Promise((e,r)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>r(t.error)})},l=async e=>{let t=(await (0,a.Lf)()).transaction(a.ux,"readwrite").objectStore(a.ux),r=(0,a.$C)(),n={...e,id:r},o=t.add(n);return new Promise((e,t)=>{o.onsuccess=()=>e(r),o.onerror=()=>t(o.error)})},c=async e=>{let t=(await (0,a.Lf)()).transaction(a.ux,"readwrite").objectStore(a.ux).put(e);return new Promise((e,r)=>{t.onsuccess=()=>e(),t.onerror=()=>r(t.error)})},s=async e=>{let t=(await (0,a.Lf)()).transaction(a.ux,"readwrite").objectStore(a.ux).delete(e);return new Promise((e,r)=>{t.onsuccess=()=>e(),t.onerror=()=>r(t.error)})}},54165:(e,t,r)=>{r.d(t,{Cf:()=>h,Es:()=>m,L3:()=>x,c7:()=>f,lG:()=>s,rr:()=>g,zM:()=>i});var a=r(95155),n=r(12115),o=r(45821),l=r(25318),c=r(59434);let s=o.bL,i=o.l9,u=o.ZL;o.bm;let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.hJ,{ref:t,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n})});d.displayName=o.hJ.displayName;let h=n.forwardRef((e,t)=>{let{className:r,children:n,...s}=e;return(0,a.jsxs)(u,{children:[(0,a.jsx)(d,{}),(0,a.jsxs)(o.UC,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s,children:[n,(0,a.jsxs)(o.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=o.UC.displayName;let f=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};f.displayName="DialogHeader";let m=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};m.displayName="DialogFooter";let x=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",r),...n})});x.displayName=o.hE.displayName;let g=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.VY,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",r),...n})});g.displayName=o.VY.displayName}}]);