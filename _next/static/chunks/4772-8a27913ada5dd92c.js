"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4772],{34772:(e,s,l)=>{l.r(s),l.d(s,{default:()=>ed});var t=l(95155),a=l(12115),r=l(6195),n=l(20031),i=l(47906),c=l(15019),d=l(62523),o=l(30285),m=l(66424),x=l(22346),u=l(87481),h=l(34301),j=l(75074),p=l(9572),f=l(20203),N=l(73926),g=l(85057),v=l(59409),b=l(90648),w=l(8643);function C(e){let{onSelectTable:s,onNewTable:l,selectedTableId:r,dataVersion:n,filters:i,setFilters:C,onClearFilters:y}=e,[S,z]=(0,a.useState)([]),[k,R]=(0,a.useState)(!0),{toast:I}=(0,u.dj)();(0,a.useEffect)(()=>{(async()=>{R(!0);try{z(await (0,c.Ax)())}catch(e){I({variant:"destructive",title:"Error",description:"Could not fetch tables from database."})}finally{R(!1)}})()},[n,I]);let T=(0,a.useMemo)(()=>{let e=S.filter(e=>{let s=e.name.toLowerCase().includes(i.searchTerm.toLowerCase()),l=!0,t=i.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return t.length>0&&(l=!!e.tags&&t.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&l}).sort((e,s)=>e.name.localeCompare(s.name));return"desc"===i.sortOrder&&e.reverse(),e},[S,i]);return(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)(o.$,{onClick:l,className:"w-full",children:[(0,t.jsx)(h.A,{})," New Random Table"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(d.p,{placeholder:"Search tables...",value:i.searchTerm,onChange:e=>C.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,t.jsxs)(w.Nt,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(w.R6,{asChild:!0,children:(0,t.jsxs)(o.$,{variant:"ghost",className:"-ml-2",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Filters"]})}),(0,t.jsx)(o.$,{variant:"ghost",size:"sm",onClick:y,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,t.jsx)(w.Ke,{className:"space-y-2 pt-2",children:(0,t.jsx)(b.F,{value:i.tagFilter?i.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>C.setTagFilter(e.join(",")),placeholder:"Tags...",tagSource:"randomTable"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(g.J,{children:"Sort by"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(v.l6,{value:i.sortBy,onValueChange:e=>C.setSortBy(e),children:[(0,t.jsx)(v.bq,{children:(0,t.jsx)(v.yv,{placeholder:"Sort by"})}),(0,t.jsx)(v.gC,{children:(0,t.jsx)(v.eb,{value:"name",children:"Name"})})]}),(0,t.jsxs)(o.$,{variant:"ghost",size:"icon",onClick:()=>C.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===i.sortOrder?(0,t.jsx)(f.A,{className:"h-4 w-4"}):(0,t.jsx)(N.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,t.jsx)(x.w,{}),(0,t.jsx)(m.F,{className:"flex-1",children:(0,t.jsx)("div",{className:"p-4",children:k?(0,t.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading tables..."}):T.length>0?(0,t.jsx)("ul",{className:"space-y-1",children:T.map(e=>(0,t.jsx)("li",{children:(0,t.jsx)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(r===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:e.name})},e.id))}):(0,t.jsx)("p",{className:"text-muted-foreground text-center",children:"No tables found."})})})]})}var y=l(62177),S=l(90221),z=l(55594),k=l(66695),R=l(88539),I=l(90010),T=l(17759),A=l(16923),E=l(12543),$=l(30990),B=l(18763),M=l(77223),F=l(25318),D=l(53054),V=l(18046),U=l(21887),J=l(68856),L=l(54165),O=l(60408),W=l.n(O),Z=l(59434);let q=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,Z.cn)("w-full caption-bottom text-sm",l),...a})})});q.displayName="Table";let _=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("thead",{ref:s,className:(0,Z.cn)("[&_tr]:border-b",l),...a})});_.displayName="TableHeader";let P=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,Z.cn)("[&_tr:last-child]:border-0",l),...a})});P.displayName="TableBody",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,Z.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...a})}).displayName="TableFooter";let H=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("tr",{ref:s,className:(0,Z.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...a})});H.displayName="TableRow";let K=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("th",{ref:s,className:(0,Z.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l),...a})});K.displayName="TableHead";let G=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("td",{ref:s,className:(0,Z.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",l),...a})});G.displayName="TableCell",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("caption",{ref:s,className:(0,Z.cn)("mt-4 text-sm text-muted-foreground",l),...a})}).displayName="TableCaption";var Q=l(47262);let X=z.z.object({id:z.z.string(),range:z.z.string().min(1,"Range is required (e.g., '1' or '1-3')"),value:z.z.string().min(1,"Value is required")}),Y=z.z.object({id:z.z.string(),name:z.z.string().min(1,"Column name is required"),options:z.z.array(X)}),ee=z.z.object({name:z.z.string().min(1,"Table name is required"),description:z.z.string().optional(),dieSize:z.z.string().min(1,"Dice notation is required."),columns:z.z.array(Y).min(1,"At least one column is required"),tags:z.z.array(z.z.string()).optional(),concatenateResults:z.z.boolean().default(!1)}),es={name:"",description:"",dieSize:"20",columns:[],tags:[],concatenateResults:!1},el=e=>Math.floor(Math.random()*e)+1,et=e=>{if(!e)return{finalRoll:0,rollString:"Invalid dice string"};let s=e.split("|"),l="",t=[];for(let e of s){let s=e.split("+"),a=0;for(let e of s){let s=e.trim();if(s.includes("d")){let[e,l]=s.split("d"),r=e?parseInt(e):1,n=parseInt(l);if(!isNaN(r)&&!isNaN(n)&&n>0){let e=[];for(let s=0;s<r;s++){let s=el(n);e.push(s),a+=s}t.push("".concat(r,"d").concat(n," (").concat(e.join(", "),")"))}}else isNaN(parseInt(s))||(a+=parseInt(s),t.push(s))}l+=a.toString()}return{finalRoll:parseInt(l),rollString:"Roll: ".concat(e," -> [").concat(t.join(" + "),"]")}},ea=e=>{if(!e||e.includes("|"))return null;let s=0,l=0;for(let t of e.split("+")){let e=t.trim();if(e.includes("d")){let[t,a]=e.split("d"),r=t?parseInt(t,10):1,n=parseInt(a,10);if(isNaN(r)||isNaN(n)||!(n>0))return null;s+=r,l+=r*n}else{if(isNaN(parseInt(e,10)))return null;let t=parseInt(e,10);s+=t,l+=t}}return{min:s,max:l}},er=(e,s)=>{if(e.includes("-")){let[l,t]=e.split("-").map(Number);if(!isNaN(l)&&!isNaN(t))return s>=l&&s<=t}let l=Number(e);return!isNaN(l)&&s===l};function en(e){let{onImport:s}=e,[l,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),[c,m]=(0,a.useState)(""),{toast:x}=(0,u.dj)();return(0,t.jsxs)(L.lG,{open:l,onOpenChange:r,children:[(0,t.jsx)(L.zM,{asChild:!0,children:(0,t.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,t.jsx)(A.A,{className:"h-4 w-4 mr-2"})," Import"]})}),(0,t.jsxs)(L.Cf,{children:[(0,t.jsxs)(L.c7,{children:[(0,t.jsx)(L.L3,{children:"Import Table Data"}),(0,t.jsx)(L.rr,{children:"Import from a CSV file or paste a Markdown table."})]}),null===n&&(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)(o.$,{className:"w-full",onClick:()=>i("csv"),children:"Import CSV"}),(0,t.jsx)(o.$,{className:"w-full",onClick:()=>i("markdown"),children:"Import Markdown"})]}),"csv"===n&&(0,t.jsxs)("div",{className:"pt-4",children:[(0,t.jsx)(d.p,{type:"file",accept:".csv",onChange:e=>{var l;let t=null==(l=e.target.files)?void 0:l[0];t&&W().parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{try{let l=e.meta.fields;if(!l||l.length<2)throw Error("CSV must have at least two columns (range and one value column).");let t=l[0],a=l.slice(1),n=a.map(e=>({id:crypto.randomUUID(),name:e,options:[]}));e.data.forEach(e=>{let s=e[t];s&&a.forEach((l,t)=>{e[l]&&n[t].options.push({id:crypto.randomUUID(),range:s.toString(),value:e[l].toString()})})}),s({columns:n}),r(!1),i(null),x({title:"CSV Parsed Successfully"})}catch(e){x({variant:"destructive",title:"CSV Import Error",description:e.message})}},error:e=>{x({variant:"destructive",title:"CSV Parsing Error",description:e.message})}})}}),(0,t.jsx)(o.$,{variant:"link",onClick:()=>i(null),children:"Back"})]}),"markdown"===n&&(0,t.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,t.jsx)(R.T,{rows:10,value:c,onChange:e=>m(e.target.value),placeholder:"| Range | Column 1 | Column 2 | |---|---|---| | 1-5 | Value A | Value B |"}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(o.$,{variant:"link",onClick:()=>i(null),children:"Back"}),(0,t.jsx)(o.$,{onClick:()=>{try{let e=c.trim().split("\n").map(e=>e.trim()).filter(e=>e.startsWith("|")&&e.endsWith("|"));if(e.length<3)throw Error("Markdown table must have a header, separator, and at least one data row.");let l=e[0].slice(1,-1).split("|").map(e=>e.trim()).slice(1).map(e=>({id:crypto.randomUUID(),name:e,options:[]}));for(let s=2;s<e.length;s++){let t=e[s].slice(1,-1).split("|").map(e=>e.trim()),a=t[0];if(a)for(let e=1;e<t.length;e++)t[e]&&e-1<l.length&&l[e-1].options.push({id:crypto.randomUUID(),range:a,value:t[e]})}s({columns:l}),r(!1),i(null),x({title:"Markdown Parsed Successfully"})}catch(e){x({variant:"destructive",title:"Markdown Import Error",description:e.message})}},children:"Parse Markdown"})]})]})]})]})}function ei(e){let{tableId:s,isCreatingNew:l,onSaveSuccess:r,onDeleteSuccess:n,onEditCancel:m,onBack:h}=e,{toast:j}=(0,u.dj)(),[p,f]=(0,a.useState)(l),[N,g]=(0,a.useState)(!l&&!!s),[v,C]=(0,a.useState)(null),[z,A]=(0,a.useState)(null),L=(0,i.a)(),O=(0,y.mN)({resolver:(0,S.u)(ee),defaultValues:es}),{control:W,getValues:Z,handleSubmit:X,reset:Y}=O,{fields:el,append:ei,remove:ed}=(0,y.jz)({control:W,name:"columns"});(0,a.useEffect)(()=>{(async()=>{if(l){O.reset(es),C(null),f(!0),g(!1);return}if(!s){f(!1),g(!1),C(null);return}g(!0),f(!1);try{let e=await (0,c.iA)(s);e?("number"==typeof e.dieSize&&(e.dieSize=String(e.dieSize)),O.reset(e),C(e)):C(null)}catch(e){j({variant:"destructive",title:"Error",description:"Could not load table data."})}finally{g(!1)}})()},[s,l,O,j]);let eo=()=>{l?m():v&&(O.reset(v),f(!1))},em=async e=>{try{let t,a={...e,tags:e.tags||[]};if(e.tags&&e.tags.length>0&&await (0,c.JE)(e.tags,"randomTable"),l)t=await (0,c.fB)(a),j({title:"Table Created!",description:"".concat(e.name," has been added.")});else{if(!s)return;t=s,await (0,c.hi)({...a,id:s}),j({title:"Save Successful",description:"".concat(e.name," has been updated.")})}r(t),f(!1)}catch(e){j({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},ex=async()=>{if(s)try{await (0,c.Fn)(s),j({title:"Table Deleted",description:"The random table has been removed."}),n()}catch(e){j({variant:"destructive",title:"Deletion Failed",description:"Could not delete the table."})}};if(N)return(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsxs)(k.Zp,{children:[(0,t.jsx)(k.aR,{children:(0,t.jsx)(J.E,{className:"h-8 w-48"})}),(0,t.jsx)(k.Wu,{children:(0,t.jsx)(J.E,{className:"h-40 w-full"})})]})});if(!s&&!l)return(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsx)(k.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,t.jsxs)(k.Wu,{className:"text-center pt-6",children:[(0,t.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a table to view"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})});if(!p&&v){let e=ea(v.dieSize),s=!!e,l=Array.from(new Set(v.columns.flatMap(e=>e.options).map(e=>e.range))).sort((e,s)=>parseInt(e.split("-")[0])-parseInt(s.split("-")[0]));return(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsxs)(k.Zp,{children:[(0,t.jsx)(k.aR,{children:(0,t.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[L&&h&&(0,t.jsx)(o.$,{variant:"ghost",size:"icon",onClick:h,className:"shrink-0 -ml-2 -mt-1",children:(0,t.jsx)(E.A,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(k.ZB,{className:"text-3xl font-bold",children:v.name}),(0,t.jsxs)(k.BT,{children:["Roll: ",v.dieSize," ",v.concatenateResults&&"(Concatenated)"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.$,{onClick:()=>{let e=Z(),s=[];e.columns.forEach(l=>{let{finalRoll:t}=et(e.dieSize),a=l.options.find(e=>er(e.range,t));s.push({name:l.name,roll:t,value:a?a.value:"(No result for ".concat(t,")")})}),e.concatenateResults?A([s.map(e=>e.value).join(" ")]):A(s.map(e=>"**".concat(e.name,"** (Rolled ").concat(e.roll,"): ").concat(e.value)))},children:[(0,t.jsx)($.A,{className:"h-4 w-4 mr-2"})," Roll"]}),(0,t.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{A(null),f(!0)},children:[(0,t.jsx)(B.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})]})}),(0,t.jsxs)(k.Wu,{children:[z&&(0,t.jsxs)("div",{className:"mb-4 p-4 border rounded-md bg-muted/50",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Roll Result"}),1===z.length?(0,t.jsx)("p",{className:"text-foreground",children:z[0]}):(0,t.jsx)("ul",{className:"space-y-1",children:z.map((e,s)=>{let l=e.split(/(\*\*.*?\*\*)/g);return(0,t.jsx)("li",{className:"text-foreground",children:l.map((e,s)=>e.startsWith("**")&&e.endsWith("**")?(0,t.jsx)("strong",{className:"font-semibold",children:e.slice(2,-2)},s):e)},s)})})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)(q,{children:[(0,t.jsx)(_,{children:(0,t.jsxs)(H,{children:[(0,t.jsx)(K,{className:"w-[100px]",children:v.dieSize}),v.columns.map(e=>(0,t.jsx)(K,{children:e.name},e.id))]})}),(0,t.jsxs)(P,{children:[s&&Array.from({length:e.max-e.min+1},(s,l)=>l+e.min).map(e=>(0,t.jsxs)(H,{children:[(0,t.jsx)(G,{className:"font-medium",children:e}),v.columns.map(s=>{let l=s.options.find(s=>er(s.range,e));return(0,t.jsx)(G,{children:l?l.value:"-"},s.id)})]},e)),!s&&l.map((e,s)=>(0,t.jsxs)(H,{children:[(0,t.jsx)(G,{children:e}),v.columns.map(s=>{let l=s.options.find(s=>s.range===e);return(0,t.jsx)(G,{children:(null==l?void 0:l.value)||"-"},s.id)})]},"".concat(e,"-").concat(s)))]})]})})]}),(0,t.jsx)(k.wL,{children:(0,t.jsxs)(I.Lt,{children:[(0,t.jsx)(I.tv,{asChild:!0,children:(0,t.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,t.jsx)(M.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(I.EO,{children:[(0,t.jsxs)(I.wd,{children:[(0,t.jsx)(I.r7,{children:"Are you sure?"}),(0,t.jsxs)(I.$v,{children:['This will permanently delete "',v.name,'".']})]}),(0,t.jsxs)(I.ck,{children:[(0,t.jsx)(I.Zr,{children:"Cancel"}),(0,t.jsx)(I.Rx,{onClick:ex,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})})}return(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsx)(k.Zp,{children:(0,t.jsx)(T.lV,{...O,children:(0,t.jsxs)("form",{onSubmit:X(em),className:"space-y-6",children:[(0,t.jsx)(k.aR,{children:(0,t.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[L&&h&&(0,t.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:m,className:"shrink-0 -ml-2",children:(0,t.jsx)(E.A,{className:"h-4 w-4"})}),(0,t.jsx)(k.ZB,{children:l?"Create New Table":"Editing: ".concat(Z("name")||"...")})]}),!L&&(0,t.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:eo,className:"text-muted-foreground hover:text-foreground",children:(0,t.jsx)(F.A,{className:"h-4 w-4"})})]})}),(0,t.jsxs)(k.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(T.zB,{name:"name",control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{className:"md:col-span-2",children:[(0,t.jsx)(T.lR,{children:"Table Name"}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(d.p,{...s})}),(0,t.jsx)(T.C5,{})]})}}),(0,t.jsx)(T.zB,{name:"dieSize",control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{children:[(0,t.jsx)(T.lR,{children:"Dice to Roll"}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(d.p,{...s,placeholder:"e.g. 20, d100, 2d6+4, d6|d6"})}),(0,t.jsx)(T.C5,{})]})}})]}),(0,t.jsx)(T.zB,{name:"description",control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{children:[(0,t.jsx)(T.lR,{children:"Description"}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(R.T,{...s,rows:2})})]})}}),(0,t.jsx)(T.zB,{control:W,name:"concatenateResults",render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{className:"flex flex-row items-center space-x-3 space-y-0",children:[(0,t.jsx)(T.MJ,{children:(0,t.jsx)(Q.S,{checked:s.value,onCheckedChange:s.onChange})}),(0,t.jsx)("div",{className:"space-y-1 leading-none",children:(0,t.jsx)(T.lR,{children:"Concatenate results into a single string"})})]})}}),(0,t.jsx)(T.zB,{name:"tags",control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{children:[(0,t.jsxs)(T.lR,{className:"flex items-center gap-2",children:[(0,t.jsx)(D.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(b.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"randomTable"})}),(0,t.jsx)(T.C5,{})]})}}),(0,t.jsx)(x.w,{}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Columns"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(en,{onImport:e=>{Y({...Z(),...e})}}),(0,t.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",onClick:()=>ei({id:crypto.randomUUID(),name:"Column ".concat(el.length+1),options:[]}),children:[(0,t.jsx)(V.A,{className:"h-4 w-4 mr-2"})," Add Column"]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:el.map((e,s)=>(0,t.jsxs)(w.Nt,{defaultOpen:!Z("columns.".concat(s,".name")),className:"border p-4 rounded-md bg-muted/50",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(w.R6,{asChild:!0,children:(0,t.jsxs)("button",{type:"button",className:"flex items-center gap-3 text-left w-full",children:[(0,t.jsx)(U.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-lg font-semibold text-foreground",children:Z("columns.".concat(s,".name"))||"New Column"})]})}),(0,t.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ed(s),className:"text-muted-foreground hover:text-destructive shrink-0",children:(0,t.jsx)(M.A,{className:"h-4 w-4"})})]}),(0,t.jsxs)(w.Ke,{className:"mt-4 space-y-3",children:[(0,t.jsx)(T.zB,{name:"columns.".concat(s,".name"),control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{className:"flex-1 mr-4",children:[(0,t.jsx)(T.lR,{children:"Column Name"}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(d.p,{...s})}),(0,t.jsx)(T.C5,{})]})}}),(0,t.jsx)(ec,{control:W,colIndex:s})]})]},e.id))})]})]}),(0,t.jsxs)(k.wL,{className:"flex items-center gap-2",children:[!l&&(0,t.jsxs)(I.Lt,{children:[(0,t.jsx)(I.tv,{asChild:!0,children:(0,t.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,t.jsx)(M.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(I.EO,{children:[(0,t.jsxs)(I.wd,{children:[(0,t.jsx)(I.r7,{children:"Are you sure?"}),(0,t.jsxs)(I.$v,{children:['This will permanently delete "',Z("name"),'".']})]}),(0,t.jsxs)(I.ck,{children:[(0,t.jsx)(I.Zr,{children:"Cancel"}),(0,t.jsx)(I.Rx,{onClick:ex,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,t.jsx)("div",{className:"flex-grow"}),!L&&(0,t.jsx)(o.$,{type:"button",variant:"outline",onClick:eo,children:"Cancel"}),(0,t.jsx)(o.$,{type:"submit",children:l?"Create Table":"Save Changes"})]})]})})})})}function ec(e){let{control:s,colIndex:l}=e,{fields:a,append:r,remove:n}=(0,y.jz)({control:s,name:"columns.".concat(l,".options")});return(0,t.jsxs)("div",{className:"space-y-2 pl-4 border-l-2",children:[(0,t.jsx)("h4",{className:"font-medium text-sm",children:"Options"}),a.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-end gap-2",children:[(0,t.jsx)(T.zB,{name:"columns.".concat(l,".options.").concat(a,".range"),control:s,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{children:[(0,t.jsx)(T.lR,{children:"Range"}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(d.p,{...s,placeholder:"e.g. 1-3"})}),(0,t.jsx)(T.C5,{})]})}}),(0,t.jsx)(T.zB,{name:"columns.".concat(l,".options.").concat(a,".value"),control:s,render:e=>{let{field:s}=e;return(0,t.jsxs)(T.eI,{className:"flex-1",children:[(0,t.jsx)(T.lR,{children:"Value"}),(0,t.jsx)(T.MJ,{children:(0,t.jsx)(d.p,{...s,placeholder:"e.g. Joe"})}),(0,t.jsx)(T.C5,{})]})}}),(0,t.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>n(a),className:"text-muted-foreground hover:text-destructive",children:(0,t.jsx)(M.A,{className:"h-4 w-4"})})]},e.id)),(0,t.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",onClick:()=>r({id:crypto.randomUUID(),range:"",value:""}),children:[(0,t.jsx)(V.A,{className:"h-4 w-4 mr-2"})," Add Option"]})]})}function ed(e){let{selectedId:s}=e,[l,c]=(0,a.useState)(s||null),[d,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)(0),[u,h]=(0,a.useState)(""),[j,p]=(0,a.useState)(""),[f,N]=(0,a.useState)("name"),[g,v]=(0,a.useState)("asc"),[b,w]=(0,a.useState)(!1),y=(0,i.a)(),[S,z]=(0,a.useState)("list");(0,a.useEffect)(()=>{w(!0),s&&(c(s),y&&z("editor"))},[s,y]);let k={searchTerm:u,tagFilter:j,sortBy:f,sortOrder:g},R={setSearchTerm:h,setTagFilter:p,setSortBy:N,setSortOrder:v},I=()=>{h(""),p(""),N("name"),v("asc")},T=()=>x(e=>e+1),A=e=>{c(e),o(!1),y&&z("editor")},E=()=>{c(null),o(!0),y&&z("editor")},$=e=>{T(),c(e),o(!1),y&&z("editor")},B=()=>{T(),c(null),o(!1),y&&z("list")},M=()=>{d&&(o(!1),c(null),y&&z("list"))};return b?y?(0,t.jsx)(r.A,{showSidebarTrigger:!1,children:(0,t.jsx)("div",{className:"h-full w-full",children:"list"===S?(0,t.jsx)(C,{onSelectTable:A,onNewTable:E,selectedTableId:l,dataVersion:m,filters:k,setFilters:R,onClearFilters:I}):(0,t.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,t.jsx)("div",{className:"p-4 sm:p-6",children:(0,t.jsx)(ei,{tableId:l,isCreatingNew:d,onSaveSuccess:$,onDeleteSuccess:B,onEditCancel:M,onBack:()=>{z("list"),c(null),o(!1)}},null!=l?l:d?"new":"placeholder")})})})}):(0,t.jsx)(n.SidebarProvider,{children:(0,t.jsx)(r.A,{children:(0,t.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,t.jsx)(n.Bx,{style:{"--sidebar-width":"380px"},children:(0,t.jsx)(C,{onSelectTable:A,onNewTable:E,selectedTableId:l,dataVersion:m,filters:k,setFilters:R,onClearFilters:I})}),(0,t.jsx)(n.sF,{className:"flex-1 overflow-y-auto",children:(0,t.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,t.jsx)(ei,{tableId:l,isCreatingNew:d,onSaveSuccess:$,onDeleteSuccess:B,onEditCancel:M},null!=l?l:d?"new":"placeholder")})})]})})}):null}}}]);