"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1625],{81625:(e,s,l)=>{l.r(s),l.d(s,{default:()=>O});var t=l(95155),a=l(12115),r=l(6195),i=l(20031),n=l(47906),c=l(34239),d=l(23062),o=l(62523),x=l(30285),h=l(66424),m=l(22346),u=l(87481),j=l(34301),p=l(75074),f=l(9572),g=l(20203),v=l(73926),N=l(85057),y=l(59409),w=l(90648),C=l(8643);function b(e){let{onSelectItem:s,onNewItem:l,selectedItemId:r,dataVersion:i,filters:n,setFilters:b,onClearFilters:F}=e,[S,z]=(0,a.useState)([]),[k,I]=(0,a.useState)(!0),{toast:A}=(0,u.dj)();(0,a.useEffect)(()=>{(async()=>{I(!0);try{let e=await (0,c.vV)();z(e)}catch(e){A({variant:"destructive",title:"Error",description:"Could not fetch alchemy items from database."})}finally{I(!1)}})()},[i,A]);let E=(0,a.useMemo)(()=>{let e=S.filter(e=>{let s=e.name.toLowerCase().includes(n.searchTerm.toLowerCase()),l="all"===n.tierFilter||e.tier===n.tierFilter,t="all"===n.typeFilter||e.type===n.typeFilter,a=!0,r=n.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return r.length>0&&(a=!!e.tags&&r.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&l&&t&&a}),s={lesser:1,greater:2},l=e.sort((e,l)=>{if("tier"===n.sortBy){let t=(s[e.tier]||0)-(s[l.tier]||0);if(0!==t)return t}if("cost"===n.sortBy){let s=e.cost-l.cost;if(0!==s)return s}return e.name.localeCompare(l.name)});return"desc"===n.sortOrder&&l.reverse(),l},[S,n]);return(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)(x.$,{onClick:l,className:"w-full",children:[(0,t.jsx)(j.A,{})," New Alchemical Item"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(p.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(o.p,{placeholder:"Search items...",value:n.searchTerm,onChange:e=>b.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,t.jsxs)(C.Nt,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(C.R6,{asChild:!0,children:(0,t.jsxs)(x.$,{variant:"ghost",className:"-ml-2",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Filters"]})}),(0,t.jsx)(x.$,{variant:"ghost",size:"sm",onClick:F,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,t.jsxs)(C.Ke,{className:"space-y-2 pt-2",children:[(0,t.jsxs)(y.l6,{value:n.typeFilter,onValueChange:b.setTypeFilter,children:[(0,t.jsx)(y.bq,{children:(0,t.jsx)(y.yv,{placeholder:"Filter by type"})}),(0,t.jsxs)(y.gC,{children:[(0,t.jsx)(y.eb,{value:"all",children:"All Types"}),d.Yh.map(e=>(0,t.jsx)(y.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,t.jsxs)(y.l6,{value:n.tierFilter,onValueChange:b.setTierFilter,children:[(0,t.jsx)(y.bq,{children:(0,t.jsx)(y.yv,{placeholder:"Filter by tier"})}),(0,t.jsxs)(y.gC,{children:[(0,t.jsx)(y.eb,{value:"all",children:"All Tiers"}),d.ag.map(e=>(0,t.jsx)(y.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,t.jsx)(w.F,{value:n.tagFilter?n.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>b.setTagFilter(e.join(",")),placeholder:"Tags (e.g. buff, damage)",tagSource:"alchemicalItem"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N.J,{children:"Sort by"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(y.l6,{value:n.sortBy,onValueChange:e=>b.setSortBy(e),children:[(0,t.jsx)(y.bq,{children:(0,t.jsx)(y.yv,{placeholder:"Sort by"})}),(0,t.jsxs)(y.gC,{children:[(0,t.jsx)(y.eb,{value:"name",children:"Name"}),(0,t.jsx)(y.eb,{value:"tier",children:"Tier"}),(0,t.jsx)(y.eb,{value:"cost",children:"Cost"})]})]}),(0,t.jsxs)(x.$,{variant:"ghost",size:"icon",onClick:()=>b.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===n.sortOrder?(0,t.jsx)(g.A,{className:"h-4 w-4"}):(0,t.jsx)(v.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,t.jsx)(m.w,{}),(0,t.jsx)(h.F,{className:"flex-1",children:(0,t.jsx)("div",{className:"p-4",children:k?(0,t.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading items..."}):E.length>0?(0,t.jsx)("ul",{className:"space-y-1",children:E.map(e=>(0,t.jsx)("li",{children:(0,t.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(r===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,t.jsxs)("span",{className:"text-xs opacity-70 capitalize",children:["(",e.tier,")"]})]})},e.id))}):(0,t.jsx)("p",{className:"text-muted-foreground text-center",children:"No items found."})})})]})}var F=l(62177),S=l(90221),z=l(55594),k=l(66695),I=l(88539),A=l(90010),E=l(17759),B=l(12543),T=l(18763),V=l(77223),$=l(25318),R=l(53054),L=l(68856),J=l(26126);let Z=z.z.object({name:z.z.string().min(1,"Item name is required"),type:z.z.enum(d.Yh),tier:z.z.enum(d.ag),cost:z.z.coerce.number().min(1,"Cost must be at least 1"),effect:z.z.string().min(1,"Effect is required"),tags:z.z.array(z.z.string()).optional()}),q={name:"",type:"potion",tier:"lesser",cost:2,effect:"",tags:[]};function D(e){let{itemId:s,isCreatingNew:l,onSaveSuccess:r,onDeleteSuccess:i,onEditCancel:h,onFilterByClick:m,onBack:j}=e,{toast:p}=(0,u.dj)(),[f,g]=(0,a.useState)(l),[v,N]=(0,a.useState)(!l&&!!s),[C,b]=(0,a.useState)(null),z=(0,n.a)(),D=(0,F.mN)({resolver:(0,S.u)(Z),defaultValues:q}),M=D.watch("tier");(0,a.useEffect)(()=>{if(f){let e="lesser"===M?2:3;D.getValues("cost")!==e&&D.setValue("cost",e)}},[M,D,f]),(0,a.useEffect)(()=>{(async()=>{if(l){D.reset(q),b(null),g(!0),N(!1);return}if(!s){g(!1),N(!1),b(null);return}N(!0),g(!1);try{let e=await (0,c.rD)(s);e?(D.reset(e),b(e)):b(null)}catch(e){p({variant:"destructive",title:"Error",description:"Could not load item data."})}finally{N(!1)}})()},[s,l,D,p]);let O=()=>{l?h():C&&(D.reset(C),g(!1))},W=async e=>{try{let t,a={...e,tags:e.tags||[]},i=e.tags||[];if(i.length>0&&await (0,c.JE)(i,"alchemicalItem"),l)t=await (0,c.wo)(a),p({title:"Item Created!",description:"".concat(e.name," has been added.")});else{if(!s)return;t=s,await (0,c.S9)({...a,id:s}),p({title:"Save Successful",description:"".concat(e.name," has been updated.")})}r(t),g(!1)}catch(e){p({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},_=async()=>{if(s)try{await (0,c.gL)(s),p({title:"Item Deleted",description:"The alchemical item has been removed."}),i()}catch(e){p({variant:"destructive",title:"Deletion Failed",description:"Could not delete the item."})}};return v?(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsxs)(k.Zp,{children:[(0,t.jsx)(k.aR,{children:(0,t.jsx)(L.E,{className:"h-8 w-48"})}),(0,t.jsx)(k.Wu,{children:(0,t.jsx)(L.E,{className:"h-40 w-full"})})]})}):s||l?!f&&C?(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsxs)(k.Zp,{children:[(0,t.jsx)(k.aR,{children:(0,t.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[z&&j&&(0,t.jsx)(x.$,{variant:"ghost",size:"icon",onClick:j,className:"shrink-0 -ml-2 -mt-1",children:(0,t.jsx)(B.A,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(k.ZB,{className:"text-3xl font-bold",children:C.name}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm capitalize",children:[(0,t.jsx)("button",{onClick:e=>m({typeFilter:C.type},e),className:"hover:underline p-0 bg-transparent text-muted-foreground",children:C.type}),(0,t.jsx)("button",{onClick:e=>m({tierFilter:C.tier},e),className:"hover:underline p-0 bg-transparent text-muted-foreground",children:C.tier}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:["Cost: ",C.cost]})]})]})]}),(0,t.jsxs)(x.$,{variant:"outline",size:"sm",onClick:()=>g(!0),children:[(0,t.jsx)(T.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})}),(0,t.jsx)(k.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:C.effect}),C.tags&&C.tags.length>0&&(0,t.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:C.tags.map(e=>(0,t.jsx)("button",{onClick:s=>m({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,t.jsx)(J.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]})}),(0,t.jsx)(k.wL,{children:(0,t.jsxs)(A.Lt,{children:[(0,t.jsx)(A.tv,{asChild:!0,children:(0,t.jsx)(x.$,{type:"button",variant:"destructive",size:"sm",children:(0,t.jsx)(V.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(A.EO,{children:[(0,t.jsxs)(A.wd,{children:[(0,t.jsx)(A.r7,{children:"Are you sure?"}),(0,t.jsxs)(A.$v,{children:['This will permanently delete "',C.name,'".']})]}),(0,t.jsxs)(A.ck,{children:[(0,t.jsx)(A.Zr,{children:"Cancel"}),(0,t.jsx)(A.Rx,{onClick:_,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsx)(k.Zp,{children:(0,t.jsx)(E.lV,{...D,children:(0,t.jsxs)("form",{onSubmit:D.handleSubmit(W),className:"space-y-6",children:[(0,t.jsx)(k.aR,{children:(0,t.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[z&&j&&(0,t.jsx)(x.$,{type:"button",variant:"ghost",size:"icon",onClick:O,className:"shrink-0 -ml-2",children:(0,t.jsx)(B.A,{className:"h-5 w-5"})}),(0,t.jsx)("div",{children:(0,t.jsx)(k.ZB,{children:l?z?"New Item":"Create New Alchemical Item":"Editing: ".concat(D.getValues("name")||"...")})})]}),!z&&(0,t.jsx)(x.$,{type:"button",variant:"ghost",size:"icon",onClick:O,className:"text-muted-foreground hover:text-foreground",children:(0,t.jsx)($.A,{className:"h-5 w-5"})})]})}),(0,t.jsxs)(k.Wu,{className:"space-y-6",children:[(0,t.jsx)(E.zB,{name:"name",control:D.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(E.eI,{children:[(0,t.jsx)(E.lR,{children:"Name"}),(0,t.jsx)(E.MJ,{children:(0,t.jsx)(o.p,{...s})}),(0,t.jsx)(E.C5,{})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(E.zB,{name:"type",control:D.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(E.eI,{children:[(0,t.jsx)(E.lR,{children:"Type"}),(0,t.jsxs)(y.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(E.MJ,{children:(0,t.jsx)(y.bq,{children:(0,t.jsx)(y.yv,{})})}),(0,t.jsx)(y.gC,{children:d.Yh.map(e=>(0,t.jsx)(y.eb,{value:e,className:"capitalize",children:e},e))})]})]})}}),(0,t.jsx)(E.zB,{name:"tier",control:D.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(E.eI,{children:[(0,t.jsx)(E.lR,{children:"Tier"}),(0,t.jsxs)(y.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(E.MJ,{children:(0,t.jsx)(y.bq,{children:(0,t.jsx)(y.yv,{})})}),(0,t.jsx)(y.gC,{children:d.ag.map(e=>(0,t.jsx)(y.eb,{value:e,className:"capitalize",children:e},e))})]})]})}}),(0,t.jsx)(E.zB,{name:"cost",control:D.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(E.eI,{children:[(0,t.jsx)(E.lR,{children:"Cost"}),(0,t.jsx)(E.MJ,{children:(0,t.jsx)(o.p,{type:"number",...s,readOnly:!0,className:"bg-muted"})}),(0,t.jsx)(E.C5,{})]})}})]}),(0,t.jsx)(E.zB,{name:"effect",control:D.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(E.eI,{children:[(0,t.jsx)(E.lR,{children:"Effect"}),(0,t.jsx)(E.MJ,{children:(0,t.jsx)(I.T,{...s,rows:4})}),(0,t.jsx)(E.C5,{})]})}}),(0,t.jsx)(E.zB,{name:"tags",control:D.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(E.eI,{children:[(0,t.jsxs)(E.lR,{className:"flex items-center gap-2",children:[(0,t.jsx)(R.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,t.jsx)(E.MJ,{children:(0,t.jsx)(w.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"alchemicalItem"})}),(0,t.jsx)(E.C5,{})]})}})]}),(0,t.jsxs)(k.wL,{className:"flex items-center gap-2",children:[!l&&(0,t.jsxs)(A.Lt,{children:[(0,t.jsx)(A.tv,{asChild:!0,children:(0,t.jsx)(x.$,{type:"button",variant:"destructive",size:"sm",children:(0,t.jsx)(V.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(A.EO,{children:[(0,t.jsxs)(A.wd,{children:[(0,t.jsx)(A.r7,{children:"Are you sure?"}),(0,t.jsxs)(A.$v,{children:['This will permanently delete "',D.getValues("name"),'".']})]}),(0,t.jsxs)(A.ck,{children:[(0,t.jsx)(A.Zr,{children:"Cancel"}),(0,t.jsx)(A.Rx,{onClick:_,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,t.jsx)("div",{className:"flex-grow"}),!z&&(0,t.jsx)(x.$,{type:"button",variant:"outline",onClick:O,children:"Cancel"}),(0,t.jsx)(x.$,{type:"submit",children:l?"Create Item":"Save Changes"})]})]})})})}):(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsx)(k.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,t.jsxs)(k.Wu,{className:"text-center pt-6",children:[(0,t.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select an item to view"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})})}async function M(){return Promise.resolve()}function O(e){let{selectedId:s}=e,[l,c]=(0,a.useState)(s||null),[d,o]=(0,a.useState)(!1),[x,h]=(0,a.useState)(0),[m,u]=(0,a.useState)(""),[j,p]=(0,a.useState)("all"),[f,g]=(0,a.useState)("all"),[v,N]=(0,a.useState)(""),[y,w]=(0,a.useState)("name"),[C,F]=(0,a.useState)("asc"),[S,z]=(0,a.useState)(!1),k=(0,n.a)(),[I,A]=(0,a.useState)("list");(0,a.useEffect)(()=>{z(!0),M().then(()=>{h(e=>e+1)}),s&&(c(s),k&&A("editor"))},[s,k]);let E={searchTerm:m,tierFilter:j,typeFilter:f,tagFilter:v,sortBy:y,sortOrder:C},B={setSearchTerm:u,setTierFilter:p,setTypeFilter:g,setTagFilter:N,setSortBy:w,setSortOrder:F},T=(e,s)=>{s.shiftKey?(e.typeFilter&&g(e.typeFilter),e.tierFilter&&p(e.tierFilter),e.tagFilter&&N(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter)):(g(e.typeFilter||"all"),p(e.tierFilter||"all"),N(e.tagFilter||""))},V=()=>{u(""),p("all"),g("all"),N(""),w("name"),F("asc")},$=()=>h(e=>e+1),R=e=>{c(e),o(!1),k&&A("editor")},L=()=>{c(null),o(!0),k&&A("editor")},J=e=>{$(),c(e),o(!1),k&&A("editor")},Z=()=>{$(),c(null),o(!1),k&&A("list")},q=()=>{d&&(o(!1),c(null),k&&A("list"))};return S?k?(0,t.jsx)(r.A,{children:(0,t.jsx)("div",{className:"h-full w-full",children:"list"===I?(0,t.jsx)(b,{onSelectItem:R,onNewItem:L,selectedItemId:l,dataVersion:x,filters:E,setFilters:B,onClearFilters:V}):(0,t.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,t.jsx)("div",{className:"p-4 sm:p-6",children:(0,t.jsx)(D,{itemId:l,isCreatingNew:d,onSaveSuccess:J,onDeleteSuccess:Z,onEditCancel:q,onFilterByClick:T,onBack:()=>{A("list"),c(null),o(!1)}},null!=l?l:d?"new":"placeholder")})})})}):(0,t.jsx)(i.SidebarProvider,{children:(0,t.jsx)(r.A,{children:(0,t.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,t.jsx)(i.Bx,{style:{"--sidebar-width":"380px"},children:(0,t.jsx)(b,{onSelectItem:R,onNewItem:L,selectedItemId:l,dataVersion:x,filters:E,setFilters:B,onClearFilters:V})}),(0,t.jsx)(i.sF,{className:"flex-1 overflow-y-auto",children:(0,t.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,t.jsx)(D,{itemId:l,isCreatingNew:d,onSaveSuccess:J,onDeleteSuccess:Z,onEditCancel:q,onFilterByClick:T},null!=l?l:d?"new":"placeholder")})})]})})}):null}}}]);