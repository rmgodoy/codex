(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6535:(e,s,t)=>{"use strict";t.d(s,{C8:()=>n,OG:()=>a,PW:()=>d,RW:()=>i,ZK:()=>c,s2:()=>r});var l=t(82489);let a=async()=>{let e=(await (0,l.Lf)()).transaction(l.RN,"readonly").objectStore(l.RN).getAll();return new Promise((s,t)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>t(e.error)})},r=async e=>{let s=(await (0,l.Lf)()).transaction(l.RN,"readonly").objectStore(l.RN).get(e);return new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>t(s.error)})},n=async e=>{if(!e||0===e.length)return[];let s=(await (0,l.Lf)()).transaction(l.RN,"readonly").objectStore(l.RN),t=[],a=e.map(e=>new Promise((l,a)=>{let r=s.get(e);r.onsuccess=()=>{r.result&&t.push(r.result),l()},r.onerror=()=>a(r.error)}));return await Promise.all(a),t},i=async e=>{let s=(await (0,l.Lf)()).transaction(l.RN,"readwrite").objectStore(l.RN),t=(0,l.$C)(),a={...e,id:t},r=s.add(a);return new Promise((e,s)=>{r.onsuccess=()=>e(t),r.onerror=()=>s(r.error)})},c=async e=>{let s=(await (0,l.Lf)()).transaction(l.RN,"readwrite").objectStore(l.RN).put(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},d=async e=>{let s=(await (0,l.Lf)()).transaction(l.RN,"readwrite").objectStore(l.RN).delete(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})}},8643:(e,s,t)=>{"use strict";t.d(s,{Ke:()=>n,Nt:()=>a,R6:()=>r});var l=t(27242);let a=l.bL,r=l.R6,n=l.Ke},13930:(e,s,t)=>{"use strict";t.d(s,{W$:()=>n,kO:()=>i,pT:()=>d,rp:()=>r,wz:()=>c,xy:()=>a});var l=t(82489);let a=async()=>{let e=(await (0,l.Lf)()).transaction(l.qi,"readonly").objectStore(l.qi).getAll();return new Promise((s,t)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>t(e.error)})},r=async e=>{let s=(await (0,l.Lf)()).transaction(l.qi,"readonly").objectStore(l.qi).get(e);return new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>t(s.error)})},n=async e=>{let s=(await (0,l.Lf)()).transaction(l.qi,"readwrite").objectStore(l.qi),t=(0,l.$C)(),a={...e,id:t},r=s.add(a);return new Promise((e,s)=>{r.onsuccess=()=>e(t),r.onerror=()=>s(r.error)})},i=async e=>{let s=(await (0,l.Lf)()).transaction(l.qi,"readwrite").objectStore(l.qi).put(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},c=async e=>{let s=(await (0,l.Lf)()).transaction(l.qi,"readwrite").objectStore(l.qi).delete(e);return new Promise((e,t)=>{s.onsuccess=()=>e(),s.onerror=()=>t(s.error)})},d=async e=>{if(!e||0===e.length)return[];let s=(await (0,l.Lf)()).transaction(l.qi,"readonly").objectStore(l.qi),t=[],a=e.map(e=>new Promise((l,a)=>{let r=s.get(e);r.onsuccess=()=>{r.result&&t.push(r.result),l()},r.onerror=()=>a(r.error)}));return await Promise.all(a),t}},23062:(e,s,t)=>{"use strict";t.d(s,{FC:()=>a,GW:()=>l,H1:()=>u,OJ:()=>r,Rb:()=>x,Vx:()=>p,Vz:()=>h,Yh:()=>n,_d:()=>j,ag:()=>i,gG:()=>f,gV:()=>o,qY:()=>d,w$:()=>c,zE:()=>m});let l=["attack","support"],a=["melee","missile","innate","unarmed","spell","item","versatile"],r=["guard","resist","10","special"],n=["potion","powder","oil","bomb"],i=["lesser","greater"],c=["weapon","armor","shield","tool"],d=["crude","normal","fine"],o=["normal","magical","artifact"],x=["melee","missile","spell","unarmed"],m=["d4","d6","d8","d10","d12","d20"],h=["one-handed","two-handed","thrown"],u=["head","chest","arms","legs","outer"],p=["head","chest","arms","legs","outer","shield"],j=["None","Light","Heavy"],f=["d4","d6","d8","d10","d12","d20"]},47262:(e,s,t)=>{"use strict";t.d(s,{S:()=>c});var l=t(95155),a=t(12115),r=t(76981),n=t(10518),i=t(59434);let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(r.bL,{ref:s,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,l.jsx)(r.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(n.A,{className:"h-4 w-4"})})})});c.displayName=r.bL.displayName},54165:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>m,Es:()=>u,L3:()=>p,c7:()=>h,lG:()=>c,rr:()=>j,zM:()=>d});var l=t(95155),a=t(12115),r=t(45821),n=t(25318),i=t(59434);let c=r.bL,d=r.l9,o=r.ZL;r.bm;let x=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(r.hJ,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a})});x.displayName=r.hJ.displayName;let m=a.forwardRef((e,s)=>{let{className:t,children:a,...c}=e;return(0,l.jsxs)(o,{children:[(0,l.jsx)(x,{}),(0,l.jsxs)(r.UC,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[a,(0,l.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(n.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.UC.displayName;let h=e=>{let{className:s,...t}=e;return(0,l.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};h.displayName="DialogHeader";let u=e=>{let{className:s,...t}=e;return(0,l.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};u.displayName="DialogFooter";let p=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(r.hE,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...a})});p.displayName=r.hE.displayName;let j=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(r.VY,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});j.displayName=r.VY.displayName},54768:(e,s,t)=>{Promise.resolve().then(t.bind(t,98736))},68856:(e,s,t)=>{"use strict";t.d(s,{E:()=>r});var l=t(95155),a=t(59434);function r(e){let{className:s,...t}=e;return(0,l.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",s),...t})}},88911:(e,s,t)=>{"use strict";t.d(s,{P:()=>n});var l=t(95155),a=t(59434),r=t(85057);let n=e=>{let{deed:s,dmgReplacement:t}=e,n=e=>{if(e)return t?e.replace(/\\dd/g,t):e},i="".concat(s.deedType," ").concat(s.actionType," VS ").concat(s.versus).toUpperCase(),c="".concat(i," | ").concat(s.target);return(0,l.jsxs)("div",{className:(0,a.cn)("rounded-lg border bg-card-foreground/5 border-l-4 p-4 mb-4",{light:"border-sky-400",heavy:"border-amber-400",mighty:"border-fuchsia-400",tyrant:"border-red-600",special:"border-yellow-400"}[s.tier]),children:[(0,l.jsxs)("div",{className:"flex justify-between items-baseline mb-3",children:[(0,l.jsx)("h4",{className:"text-xl font-bold",children:s.name}),(0,l.jsx)("div",{className:(0,a.cn)("text-xs font-bold uppercase px-2 py-0.5 rounded-full",{light:"text-sky-300 bg-sky-900/50",heavy:"text-amber-300 bg-amber-900/50",mighty:"text-fuchsia-300 bg-fuchsia-900/50",tyrant:"text-red-300 bg-red-900/50",special:"text-yellow-300 bg-yellow-900/50"}[s.tier]),children:s.tier})]}),(0,l.jsx)("div",{className:"text-sm text-muted-foreground mb-3 border-b border-t border-border py-2",children:(0,l.jsx)("p",{className:"text-foreground/90",children:c})}),(0,l.jsxs)("div",{className:"space-y-3 text-sm",children:[s.effects.start&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Start"}),(0,l.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.start)})]}),s.effects.base&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Base"}),(0,l.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.base)})]}),s.effects.hit&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.J,{className:"text-primary-foreground font-semibold uppercase",children:"Hit"}),(0,l.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.hit)})]}),s.effects.spark&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"Spark (Critical Hit)"}),(0,l.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.spark)})]}),s.effects.shadow&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.J,{className:"text-primary-foreground font-semibold uppercase",children:"Shadow (Critical Failure)"}),(0,l.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.shadow)})]}),s.effects.after&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.J,{className:"text-primary-foreground/90 font-semibold uppercase",children:"After"}),(0,l.jsx)("p",{className:"text-foreground/90 mt-0.5 whitespace-pre-wrap pl-2 font-light",children:n(s.effects.after)})]})]})]})}},98736:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ey});var l=t(95155),a=t(12115),r=t(6535),n=t(13930);let i=async e=>{if(!e||0===e.length)return[];let s=await (0,r.C8)(e);if(0===s.length)return[];let t=[...new Set(s.flatMap(e=>e.deeds))],l=new Map((await (0,n.pT)(t)).map(e=>[e.id,e]));return s.map(e=>{let s=[];return"string"==typeof e.abilities&&e.abilities.length>0?s=e.abilities.split("\n\n").map(e=>{let s=e.match(RegExp("\\*\\*(.*?):\\*\\*\\s*(.*)","s"));return s&&s[1]&&s[2]?{id:crypto.randomUUID(),name:s[1],description:s[2].trim()}:!s&&e.trim()?{id:crypto.randomUUID(),name:"Ability",description:e.trim()}:null}).filter(e=>null!==e):Array.isArray(e.abilities)&&(s=e.abilities.map(e=>({...e,id:e.id||crypto.randomUUID()}))),{...e,abilities:s,deeds:e.deeds.map(e=>l.get(e)).filter(e=>!!e)}})};var c=t(76762),d=t(62523),o=t(30285),x=t(66424),m=t(22346),h=t(87481),u=t(85057),p=t(59409),j=t(50172),f=t(34301),g=t(68718),v=t(75074),b=t(20203),N=t(73926),y=t(90648),w=t(54165),C=t(47262),R=t(58962);let S=e=>{switch(e){case"light":return"L";case"heavy":return"H";case"mighty":return"M";case"tyrant":return"T";case"special":return"S"}},T=(e,s)=>e?e.replace(/\\dd/g,s).split(/(\bconfer\s+\w+\s+\d+\b)/gi).map((e,s)=>{if(e.match(/\bconfer\s+\w+\s+\d+\b/i)){let t=e.split(" ");return(0,l.jsxs)("span",{children:[t.slice(0,-1).join(" ")," ",(0,l.jsx)("span",{className:"font-bold",children:t[t.length-1]})]},s)}return e}):null,A=e=>{let{template:s}=e;switch(s){case"Underling":return(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-bold",children:"Underling:"})," Any amount of damage from a hit is enough to kill this creature. It is immune to state damage, environmental damage and damage from missed attacks."]});case"Paragon":return(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-bold",children:"Extra Turn:"})," This creature takes an additional turn at the end of the round. Immune to effects that delay its turn (loses an action point on its next turn instead)."]});case"Tyrant":return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-bold",children:"Extra Turn:"})," This creature takes an additional turn at the end of the round. Immune to effects that delay its turn (loses an action point on its next turn instead)."]}),(0,l.jsxs)("p",{className:"mt-1",children:[(0,l.jsx)("span",{className:"font-bold",children:"Unstoppable:"})," Can make a free prevail check against one state at the end of each round."]})]});default:return null}};function z(e){let{creature:s}=e;if(!s)return null;let t={light:0,heavy:1,mighty:2,tyrant:3,special:4},a=[...s.deeds].sort((e,s)=>t[e.tier]-t[s.tier]),r=(e,t)=>{if(!t)return null;let a=T(t,s.attributes.DMG);return(0,l.jsxs)("p",{children:[(0,l.jsxs)("span",{className:"font-bold",children:[e,":"]})," ",a]})};return(0,l.jsxs)("div",{className:"bg-stone-200 text-black font-sans text-xs w-[350px] shadow-lg",style:{fontFamily:"Literata, serif"},children:[(0,l.jsxs)("header",{className:"flex bg-gray-700 text-white font-bold uppercase",children:[(0,l.jsx)("h1",{className:"flex-1 p-1.5 pl-2",children:s.name}),(0,l.jsxs)("div",{className:"border-l-2 border-white p-1.5 px-3",children:["TR ",s.TR]})]}),(0,l.jsxs)("section",{className:"p-2 grid grid-cols-2 gap-x-4 bg-white border-b border-stone-300",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," ",s.role," ","Normal"!==s.template&&s.template," ",s.level]}),(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," HP: ",s.attributes.HP]}),(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," Speed: ",s.attributes.Speed]}),(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," Initiative: ",s.attributes.Initiative]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," Accuracy: ",s.attributes.Accuracy]}),(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," Guard: ",s.attributes.Guard]}),(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," Resist: ",s.attributes.Resist]}),(0,l.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(R.A,{className:"w-2 h-2 fill-current"})," Roll Bonus: ",s.attributes.rollBonus>0?"+".concat(s.attributes.rollBonus):s.attributes.rollBonus]})]})]}),"Normal"!==s.template&&(0,l.jsx)("section",{className:"p-2 bg-stone-100 border-b border-stone-300 text-stone-800",children:(0,l.jsx)(A,{template:s.template})}),s.abilities&&s.abilities.length>0&&(0,l.jsx)("section",{className:"p-2 bg-white border-b border-stone-300",children:(0,l.jsx)("div",{className:"space-y-1",children:s.abilities.map((e,s)=>(0,l.jsxs)("p",{children:[(0,l.jsxs)("span",{className:"font-bold",children:[e.name,":"]})," ",e.description]},e.id||s))})}),(0,l.jsx)("section",{className:"space-y-1",children:a.map(e=>(0,l.jsxs)("div",{className:"p-2 border-t border-stone-300",children:[(0,l.jsxs)("h2",{className:"font-bold",children:["(",S(e.tier),") ",e.name.toUpperCase()," ",(0,l.jsx)(R.A,{className:"w-2 h-2 inline-block fill-current"})," ",e.deedType.toUpperCase()," ATTACK VS. ",e.versus.toUpperCase()]}),(0,l.jsxs)("div",{className:"pl-3 text-stone-800 space-y-0.5",children:[e.target&&(0,l.jsxs)("p",{children:["Target: ",e.target]}),r("Start",e.effects.start),r("Base",e.effects.base),r("Hit",e.effects.hit),r("Spark",e.effects.spark),r("Shadow",e.effects.shadow),r("After",e.effects.after)]})]},e.id))})]})}var k=t(78064),F=t(59311),L=t.n(F);let M=["Normal","Underling","Paragon","Tyrant"];function I(e){let{onSelectCreature:s,onNewCreature:t,selectedCreatureId:n,dataVersion:R,filters:S,setFilters:T,onClearFilters:A}=e,[F,I]=(0,a.useState)([]),[B,E]=(0,a.useState)(!0),{toast:J}=(0,h.dj)(),[P,D]=(0,a.useState)(!1),[U,G]=(0,a.useState)(new Set),[$,V]=(0,a.useState)(!1),[q,O]=(0,a.useState)(null),[H,W]=(0,a.useState)(""),Z=(0,a.useRef)(null),_={searchTerm:"",roleFilter:"all",templateFilter:"all",minLevel:"",maxLevel:"",minTR:"",maxTR:"",tagFilter:""},[K,Y]=(0,a.useState)(_);(0,a.useEffect)(()=>{(async()=>{E(!0);try{let e=await (0,r.OG)();I(e)}catch(e){console.error("Error fetching creatures:",e),J({variant:"destructive",title:"Error",description:"Could not fetch creatures from database."})}finally{E(!1)}})()},[R,J]);let Q=async()=>{if(0===U.size)return void J({variant:"destructive",title:"No creatures selected",description:"Please select at least one creature to export."});V(!0),J({title:"Starting Export...",description:"Preparing ".concat(U.size," creature(s).")});try{let e=await i(Array.from(U)),s=new(L()),t=1;for(let l of e){if(O(l),W("Exporting ".concat(t," of ").concat(e.length,": ").concat(l.name)),await new Promise(e=>requestAnimationFrame(()=>setTimeout(e,50))),Z.current)try{let e=await k.$E(Z.current,{quality:1,pixelRatio:2,backgroundColor:"#e7e5e4"}),t=await (await fetch(e)).blob();s.file("".concat(l.name.replace(/ /g,"_"),".png"),t)}catch(e){console.error("Failed to export ".concat(l.name,":"),e),J({variant:"destructive",title:"Failed to export ".concat(l.name)})}t++}let l=await s.generateAsync({type:"blob"}),a=document.createElement("a");a.href=URL.createObjectURL(l),a.download="exported_creatures.zip",document.body.appendChild(a),a.click(),document.body.removeChild(a),J({title:"Export finished!",description:"".concat(e.length," creature(s) have been exported.")})}catch(e){console.error("Export failed",e),J({variant:"destructive",title:"Export Failed",description:"An unexpected error occurred."})}finally{V(!1),O(null),W(""),D(!1),G(new Set)}},X=(e,s)=>e.filter(e=>{let t=e.name.toLowerCase().includes(s.searchTerm.toLowerCase()),l="all"===s.roleFilter||e.role===s.roleFilter,a="all"===s.templateFilter||e.template===s.templateFilter,r=!0;s.minLevel&&!isNaN(parseInt(s.minLevel))&&(r=r&&e.level>=parseInt(s.minLevel,10)),s.maxLevel&&!isNaN(parseInt(s.maxLevel))&&(r=r&&e.level<=parseInt(s.maxLevel,10));let n=!0;s.minTR&&!isNaN(parseInt(s.minTR))&&(n=n&&e.TR>=parseInt(s.minTR,10)),s.maxTR&&!isNaN(parseInt(s.maxTR))&&(n=n&&e.TR<=parseInt(s.maxTR,10));let i=!0;if(s.tagFilter){let t=s.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);t.length>0&&(i=e.tags&&e.tags.length>0&&t.every(s=>e.tags.some(e=>e.toLowerCase().includes(s))))}return t&&l&&a&&r&&n&&i}),ee=(0,a.useMemo)(()=>X(F,K),[F,K]),es=(0,a.useMemo)(()=>{let e=X(F,S).sort((e,s)=>{if("TR"===S.sortBy){let t=e.TR-s.TR;if(0!==t)return t}if("level"===S.sortBy){let t=e.level-s.level;if(0!==t)return t}return e.name.localeCompare(s.name)});return"desc"===S.sortOrder&&e.reverse(),e},[F,S]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w.lG,{open:$,children:(0,l.jsxs)(w.Cf,{className:"sm:max-w-md",onInteractOutside:e=>e.preventDefault(),children:[(0,l.jsxs)(w.c7,{children:[(0,l.jsx)(w.L3,{children:"Exporting Creatures"}),(0,l.jsx)(w.rr,{children:"Please wait while the creature cards are being generated."})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-4",children:[(0,l.jsx)("div",{className:"min-h-[200px]",children:(0,l.jsx)("div",{ref:Z,children:q&&(0,l.jsx)(z,{creature:q})})}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,l.jsx)(j.A,{className:"animate-spin h-4 w-4"}),(0,l.jsx)("span",{children:H})]})]})]})}),(0,l.jsxs)("div",{className:"border-r border-border bg-card flex flex-col h-full",children:[(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(o.$,{onClick:t,className:"w-full",children:[(0,l.jsx)(f.A,{})," New Creature"]}),(0,l.jsxs)(w.lG,{open:P,onOpenChange:D,children:[(0,l.jsx)(w.zM,{asChild:!0,children:(0,l.jsx)(o.$,{variant:"outline",className:"px-3",title:"Export as PNG",children:(0,l.jsx)(g.A,{})})}),(0,l.jsxs)(w.Cf,{className:"sm:max-w-4xl",children:[(0,l.jsxs)(w.c7,{children:[(0,l.jsx)(w.L3,{children:"Export Creatures to PNG"}),(0,l.jsx)(w.rr,{children:"Select the creatures you want to export. They will be downloaded as a single ZIP file."})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsxs)("div",{className:"w-64 flex-shrink-0 space-y-4",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"Filters"}),(0,l.jsx)(d.p,{placeholder:"Search...",value:K.searchTerm,onChange:e=>Y(s=>({...s,searchTerm:e.target.value}))}),(0,l.jsxs)(p.l6,{value:K.templateFilter,onValueChange:e=>Y(s=>({...s,templateFilter:e})),children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"All Templates"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Templates"}),M.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))]})]}),(0,l.jsxs)(p.l6,{value:K.roleFilter,onValueChange:e=>Y(s=>({...s,roleFilter:e})),children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"All Roles"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Roles"}),c.gg.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(d.p,{placeholder:"Min Lvl",type:"number",value:K.minLevel,onChange:e=>Y(s=>({...s,minLevel:e.target.value}))}),(0,l.jsx)(d.p,{placeholder:"Max Lvl",type:"number",value:K.maxLevel,onChange:e=>Y(s=>({...s,maxLevel:e.target.value}))})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(d.p,{placeholder:"Min TR",type:"number",value:K.minTR,onChange:e=>Y(s=>({...s,minTR:e.target.value}))}),(0,l.jsx)(d.p,{placeholder:"Max TR",type:"number",value:K.maxTR,onChange:e=>Y(s=>({...s,maxTR:e.target.value}))})]}),(0,l.jsx)(y.F,{value:K.tagFilter?K.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>Y(s=>({...s,tagFilter:e.join(",")})),placeholder:"Tags...",tagSource:"creature"}),(0,l.jsx)(o.$,{variant:"ghost",className:"w-full",onClick:()=>Y(_),children:"Clear Filters"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)(u.J,{children:[U.size," of ",ee.length," selected"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(o.$,{variant:"link",className:"p-0 h-auto",onClick:()=>{let e=new Set(ee.map(e=>e.id));G(s=>new Set([...Array.from(s),...Array.from(e)]))},children:"Select All Visible"}),(0,l.jsx)(o.$,{variant:"link",className:"p-0 h-auto",onClick:()=>{let e=new Set(ee.map(e=>e.id));G(s=>{let t=new Set(s);return e.forEach(e=>t.delete(e)),t})},children:"Deselect All Visible"})]})]}),(0,l.jsx)(x.F,{className:"h-64 border rounded-md",children:(0,l.jsx)("div",{className:"p-4 space-y-2",children:ee.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(C.S,{id:"export-".concat(e.id),checked:U.has(e.id),onCheckedChange:s=>{G(t=>{let l=new Set(t);return s?l.add(e.id):l.delete(e.id),l})}}),(0,l.jsx)(u.J,{htmlFor:"export-".concat(e.id),className:"font-normal",children:e.name})]},e.id))})})]})]}),(0,l.jsxs)(w.Es,{className:"mt-4",children:[(0,l.jsx)(o.$,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),(0,l.jsx)(o.$,{onClick:Q,disabled:$||0===U.size,children:$?"Exporting...":"Export ".concat(U.size," Creature(s)")})]})]})]})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(v.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.p,{placeholder:"Search creatures...",value:S.searchTerm,onChange:e=>T.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(u.J,{children:"Filter"}),(0,l.jsx)(o.$,{variant:"ghost",size:"sm",onClick:A,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,l.jsxs)(p.l6,{value:S.templateFilter,onValueChange:T.setTemplateFilter,children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Filter by template"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Templates"}),M.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))]})]}),(0,l.jsxs)(p.l6,{value:S.roleFilter,onValueChange:T.setRoleFilter,children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Filter by role"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Roles"}),c.gg.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(d.p,{placeholder:"Min Lvl",type:"number",value:S.minLevel,onChange:e=>T.setMinLevel(e.target.value),className:"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),(0,l.jsx)(d.p,{placeholder:"Max Lvl",type:"number",value:S.maxLevel,onChange:e=>T.setMaxLevel(e.target.value),className:"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(d.p,{placeholder:"Min TR",type:"number",value:S.minTR,onChange:e=>T.setMinTR(e.target.value),className:"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),(0,l.jsx)(d.p,{placeholder:"Max TR",type:"number",value:S.maxTR,onChange:e=>T.setMaxTR(e.target.value),className:"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),(0,l.jsx)(y.F,{value:S.tagFilter?S.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>T.setTagFilter(e.join(",")),placeholder:"Tags (e.g. undead, goblin)",tagSource:"creature"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Sort by"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(p.l6,{value:S.sortBy,onValueChange:e=>T.setSortBy(e),children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Sort by"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"name",children:"Name"}),(0,l.jsx)(p.eb,{value:"TR",children:"TR"}),(0,l.jsx)(p.eb,{value:"level",children:"Level"})]})]}),(0,l.jsxs)(o.$,{variant:"ghost",size:"icon",onClick:()=>T.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===S.sortOrder?(0,l.jsx)(b.A,{className:"h-4 w-4"}):(0,l.jsx)(N.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,l.jsx)(m.w,{}),(0,l.jsx)(x.F,{className:"flex-1",children:(0,l.jsx)("div",{className:"p-4",children:B?(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading creatures..."}):es.length>0?(0,l.jsx)("ul",{className:"space-y-1",children:es.map(e=>(0,l.jsx)("li",{children:(0,l.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(n===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,l.jsxs)("span",{className:"text-xs opacity-70",children:["(Lvl ",e.level," / TR ",e.TR,")"]})]})},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"No creatures found."})})})]})]})}var B=t(62177),E=t(90221),J=t(55594),P=t(44218),D=t(23062),U=t(66695),G=t(88539),$=t(90010),V=t(17759),q=t(14337),O=t(12543),H=t(15599),W=t(18763),Z=t(68098),_=t(14014),K=t(89829),Y=t(64442),Q=t(45731),X=t(69479),ee=t(77119),es=t(18051),et=t(77223),el=t(25318),ea=t(18046),er=t(21887),en=t(53054),ei=t(68856),ec=t(8643),ed=t(88911),eo=t(26126),ex=t(47906);let em=["Normal","Underling","Paragon","Tyrant"],eh=J.z.object({start:J.z.string().optional(),base:J.z.string().optional(),hit:J.z.string().optional(),spark:J.z.string().optional(),shadow:J.z.string().optional(),after:J.z.string().optional()}),eu=J.z.object({id:J.z.string().optional(),name:J.z.string().min(1,"Deed name is required"),tier:J.z.enum(["light","heavy","mighty","tyrant","special"]),actionType:J.z.enum(D.GW),deedType:J.z.enum(D.FC),versus:J.z.enum(D.OJ),target:J.z.string().optional(),effects:eh,tags:J.z.array(J.z.string()).optional()}),ep=J.z.object({id:J.z.string(),name:J.z.string().min(1,"Ability name is required"),description:J.z.string().min(1,"Ability description is required")}),ej=J.z.object({name:J.z.string().min(1,"Name is required"),level:J.z.coerce.number().int().min(1).max(10),role:J.z.enum(c.gg),template:J.z.enum(em),TR:J.z.coerce.number().int().min(0),attributes:J.z.object({HP:J.z.coerce.number().int().min(0),Speed:J.z.coerce.number().int().min(0),Initiative:J.z.coerce.number().int().min(0),Accuracy:J.z.coerce.number().int().min(0),Guard:J.z.coerce.number().int().min(0),Resist:J.z.coerce.number().int().min(0),rollBonus:J.z.coerce.number().int().min(0),DMG:J.z.string()}),deeds:J.z.array(eu),abilities:J.z.array(ep).optional(),description:J.z.string().optional(),tags:J.z.array(J.z.string()).optional()}),ef={name:"",level:1,role:"Archer",template:"Normal",TR:1,attributes:{HP:20,Speed:5,Initiative:14,Accuracy:16,Guard:12,Resist:12,rollBonus:4,DMG:"d6"},deeds:[],abilities:[],description:"",tags:[]},eg=e=>{let{onAddDeeds:s,allDeeds:t,existingDeedIds:r}=e,[n,i]=(0,a.useState)(!1),[c,m]=(0,a.useState)(new Set),[h,u]=(0,a.useState)(""),[j,f]=(0,a.useState)("all"),[g,v]=(0,a.useState)(""),b=(0,a.useMemo)(()=>t.filter(e=>{let s=e.name.toLowerCase().includes(h.toLowerCase()),t="all"===j||e.tier===j,l=g.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean),a=0===l.length||e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)));return s&&t&&a}),[t,h,j,g]),N=e=>{m(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})};return(0,l.jsxs)(w.lG,{open:n,onOpenChange:i,children:[(0,l.jsx)(w.zM,{asChild:!0,children:(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(q.A,{className:"h-4 w-4 mr-2"})," Add From Library"]})}),(0,l.jsxs)(w.Cf,{className:"max-w-2xl h-[70vh] flex flex-col",children:[(0,l.jsxs)(w.c7,{children:[(0,l.jsx)(w.L3,{children:"Select Deeds from Library"}),(0,l.jsx)(w.rr,{children:"Select one or more deeds to add to the creature."})]}),(0,l.jsxs)("div",{className:"flex gap-2 mb-4 flex-wrap",children:[(0,l.jsx)(d.p,{placeholder:"Search deeds...",value:h,onChange:e=>u(e.target.value),className:"flex-1 min-w-[150px]"}),(0,l.jsxs)(p.l6,{value:j,onValueChange:f,children:[(0,l.jsx)(p.bq,{className:"w-full sm:w-[120px]",children:(0,l.jsx)(p.yv,{placeholder:"Filter tier"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"all",children:"All Tiers"}),(0,l.jsx)(p.eb,{value:"light",children:"Light"}),(0,l.jsx)(p.eb,{value:"heavy",children:"Heavy"}),(0,l.jsx)(p.eb,{value:"mighty",children:"Mighty"})]})]}),(0,l.jsx)(d.p,{placeholder:"Filter by tags...",value:g,onChange:e=>v(e.target.value),className:"flex-1 min-w-[150px]"})]}),(0,l.jsx)(x.F,{className:"flex-1 border rounded-md p-4",children:(0,l.jsx)("div",{className:"space-y-2",children:b.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(C.S,{id:"deed-".concat(e.id),onCheckedChange:()=>N(e.id),checked:c.has(e.id),disabled:r.has(e.id)}),(0,l.jsxs)("label",{htmlFor:"deed-".concat(e.id),className:"flex-1",children:[(0,l.jsxs)("p",{className:"font-semibold",children:[e.name," ",(0,l.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.tier,")"]})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.effects.hit})]})]},e.id))})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,l.jsx)(o.$,{variant:"ghost",onClick:()=>i(!1),children:"Cancel"}),(0,l.jsx)(o.$,{onClick:()=>{s(t.filter(e=>c.has(e.id))),i(!1),m(new Set),u(""),f("all"),v("")},disabled:0===c.size,children:"Add Selected"})]})]})]})};function ev(e){let{creatureId:s,isCreatingNew:t,template:i,onCreatureSaveSuccess:x,onCreatureDeleteSuccess:j,onUseAsTemplate:f,onEditCancel:g,dataVersion:v,onFilterByClick:b,onBack:N}=e,{toast:w}=(0,h.dj)(),[C,R]=(0,a.useState)(t),[S,T]=(0,a.useState)(!t&&!!s),[A,z]=(0,a.useState)(null),[k,F]=(0,a.useState)([]),L=(0,ex.a)(),M=(0,a.useMemo)(()=>{if(t)if(i){let e={...ef,...i,abilities:(i.abilities||[]).map(e=>({...e,id:e.id||crypto.randomUUID()})),description:i.description||"",tags:i.tags||[],deeds:(i.deeds||[]).map(e=>{var s,t,l,a,r,n;return{...e,effects:{start:(null==(s=e.effects)?void 0:s.start)||"",base:(null==(t=e.effects)?void 0:t.base)||"",hit:(null==(l=e.effects)?void 0:l.hit)||"",spark:(null==(a=e.effects)?void 0:a.spark)||"",shadow:(null==(r=e.effects)?void 0:r.shadow)||"",after:(null==(n=e.effects)?void 0:n.after)||""},tags:e.tags||[]}})};return delete e.id,e}else{let e=(0,c.GQ)(ef.role,ef.level);return{...ef,attributes:e||ef.attributes}}return ef},[t,i]),I=(0,B.mN)({resolver:(0,E.u)(ej),defaultValues:M}),{fields:J,append:q,remove:eh,replace:eu}=(0,B.jz)({control:I.control,name:"deeds"}),{fields:ep,append:ev,remove:eb}=(0,B.jz)({control:I.control,name:"abilities"}),{watch:eN,setValue:ey,getValues:ew}=I,eC=eN("role"),eR=eN("level"),eS=eN("template"),eT=eN();(0,a.useEffect)(()=>{if(C){let e=(0,c.GQ)(eC,eR);if(e){let s=(0,c.TP)(eS,eR),t=e.HP,l=e.DMG;switch(eS){case"Underling":t=1,l=(0,c.ED)(e.DMG),eu(ew("deeds").filter(e=>"light"===e.tier));break;case"Paragon":t=2*e.HP;break;case"Tyrant":t=4*e.HP}ey("attributes",{...e,HP:t,DMG:l}),ey("TR",s)}}},[eC,eR,eS,ey,C,ew,eu]),(0,a.useEffect)(()=>{(0,n.xy)().then(F).catch(e=>console.error("Could not fetch all deeds",e))},[v]),(0,a.useEffect)(()=>{(async()=>{if(t||!s){R(t),T(!1),z(i||null);return}T(!0),R(!1);try{let e=await (0,r.s2)(s);if(e){let s=await (0,n.pT)(e.deeds),t=[];"string"==typeof e.abilities&&e.abilities.length>0?t=e.abilities.split("\n\n").map(e=>{let s=e.match(RegExp("\\*\\*(.*?):\\*\\*\\s*(.*)","s"));return s&&s[1]&&s[2]?{id:crypto.randomUUID(),name:s[1],description:s[2].trim()}:!s&&e.trim()?{id:crypto.randomUUID(),name:"Ability",description:e.trim()}:null}).filter(e=>null!==e):Array.isArray(e.abilities)&&(t=e.abilities.map(e=>({...e,id:e.id||crypto.randomUUID()})));let l={...e,abilities:t,deeds:s};z(l);let a={...ef,...l,description:l.description||"",template:l.template||"Normal",tags:l.tags||[],deeds:s.map(e=>{var s,t,l,a,r,n;return{...e,effects:{start:(null==(s=e.effects)?void 0:s.start)||"",base:(null==(t=e.effects)?void 0:t.base)||"",hit:(null==(l=e.effects)?void 0:l.hit)||"",spark:(null==(a=e.effects)?void 0:a.spark)||"",shadow:(null==(r=e.effects)?void 0:r.shadow)||"",after:(null==(n=e.effects)?void 0:n.after)||""},tags:e.tags||[]}})};I.reset(a)}}catch(e){console.error("Failed to fetch creature data:",e),w({variant:"destructive",title:"Error",description:"Could not load creature data."})}finally{T(!1)}})()},[s,t,I,w,v,i]);let eA=async e=>{try{"Underling"===e.template&&(e.deeds=e.deeds.filter(e=>"light"===e.tier));let l=e.deeds.map(e=>{if(!e.id){let{id:s,...t}=e,l={...t,tags:t.tags||[]};return(0,n.W$)(l)}return Promise.resolve(e.id)}),a=await Promise.all(l),i={...e,tags:e.tags||[],abilities:e.abilities||[],deeds:a},c=e.tags||[];if(c.length>0&&await (0,P.JE)(c,"creature"),t){let s=await (0,r.RW)(i);w({title:"Creature Created!",description:"".concat(e.name," has been added to the bestiary.")}),x(s)}else s&&(await (0,r.ZK)({...i,id:s}),w({title:"Save Successful",description:"".concat(e.name," has been updated.")}),x(s));R(!1)}catch(e){console.error("Failed to save creature:",e),w({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},ez=async()=>{if(s)try{await (0,r.PW)(s),w({title:"Creature Deleted",description:"The creature has been removed from the bestiary."}),j()}catch(e){console.error("Failed to delete creature:",e),w({variant:"destructive",title:"Deletion Failed",description:"Could not delete the creature."})}},ek=()=>{if(t)g();else{if(A){let e={...ef,...A,description:A.description||"",template:A.template||"Normal",tags:A.tags||[],deeds:A.deeds.map(e=>{var s,t,l,a,r,n;return{...e,effects:{start:(null==(s=e.effects)?void 0:s.start)||"",base:(null==(t=e.effects)?void 0:t.base)||"",hit:(null==(l=e.effects)?void 0:l.hit)||"",spark:(null==(a=e.effects)?void 0:a.spark)||"",shadow:(null==(r=e.effects)?void 0:r.shadow)||"",after:(null==(n=e.effects)?void 0:n.after)||""},tags:e.tags||[]}})};I.reset(e)}R(!1)}},eF={light:0,heavy:1,mighty:2,tyrant:3,special:4},eL=(0,a.useMemo)(()=>new Set(J.map(e=>e.id).filter(Boolean)),[J]);if(S&&!t)return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(U.Zp,{children:[(0,l.jsxs)(U.aR,{className:"flex flex-row items-center justify-between",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(ei.E,{className:"h-8 w-48"}),(0,l.jsx)(ei.E,{className:"h-4 w-32"})]}),(0,l.jsx)(ei.E,{className:"h-10 w-24"})]}),(0,l.jsxs)(U.Wu,{children:[(0,l.jsx)(m.w,{className:"my-6"}),(0,l.jsx)(ei.E,{className:"h-6 w-32 mb-4"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,l.jsx)(ei.E,{className:"h-12 w-full"}),(0,l.jsx)(ei.E,{className:"h-12 w-full"}),(0,l.jsx)(ei.E,{className:"h-12 w-full"}),(0,l.jsx)(ei.E,{className:"h-12 w-full"}),(0,l.jsx)(ei.E,{className:"h-12 w-full"}),(0,l.jsx)(ei.E,{className:"h-12 w-full"}),(0,l.jsx)(ei.E,{className:"h-12 w-full"})]}),(0,l.jsx)(m.w,{className:"my-6"}),(0,l.jsx)(ei.E,{className:"h-6 w-32 mb-4"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(ei.E,{className:"h-24 w-full"}),(0,l.jsx)(ei.E,{className:"h-24 w-full"})]})]})]})});if(!t&&!s&&!S)return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(U.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,l.jsxs)(U.Wu,{className:"text-center pt-6",children:[(0,l.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a creature to view"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})});if(!C&&s&&A){let e=[...A.deeds].sort((e,s)=>eF[e.tier]-eF[s.tier]);return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(U.Zp,{children:[(0,l.jsx)(U.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[L&&N&&(0,l.jsx)(o.$,{variant:"ghost",size:"icon",onClick:N,className:"-ml-4 -mt-1",children:(0,l.jsx)(O.A,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(U.ZB,{className:"text-3xl font-bold",children:A.name}),(0,l.jsxs)("div",{className:"mt-2 text-sm text-muted-foreground flex flex-col items-start gap-1",children:[(0,l.jsx)("p",{children:(0,l.jsxs)("button",{onClick:e=>b({templateFilter:A.template,roleFilter:A.role,minLevel:A.level,maxLevel:A.level},e),className:"hover:underline p-0 bg-transparent text-inherit",children:["Lvl ",A.level," ",A.template," ",A.role]})}),(0,l.jsx)("p",{children:(0,l.jsxs)("button",{onClick:e=>b({minTR:A.TR,maxTR:A.TR},e),className:"hover:underline p-0 bg-transparent text-inherit",children:["TR ",A.TR]})}),A.tags&&A.tags.length>0&&(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-2 pt-1",children:A.tags.map(e=>(0,l.jsx)("button",{onClick:s=>b({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,l.jsx)(eo.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})]})]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{A&&f(A)},children:[(0,l.jsx)(H.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Template"})]}),(0,l.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>R(!0),children:[(0,l.jsx)(W.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Edit"})]})]})]})}),(0,l.jsxs)(U.Wu,{children:[(0,l.jsx)(m.w,{className:"my-6"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4 text-primary-foreground",children:"Attributes"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-x-6 gap-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(Z.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"HP"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.HP})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(_.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Speed"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.Speed})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(K.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Initiative"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.Initiative})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(Y.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Accuracy"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.Accuracy})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(Q.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Guard"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.Guard})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(X.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Resist"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.Resist})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(ee.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Roll Bonus"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.rollBonus>0?"+".concat(A.attributes.rollBonus):A.attributes.rollBonus})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(es.A,{className:"h-5 w-5 text-accent"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"DMG"}),(0,l.jsx)("p",{className:"text-lg font-bold",children:A.attributes.DMG})]})]})]})]}),A.abilities&&A.abilities.length>0&&(0,l.jsx)(m.w,{className:"my-6"}),A.abilities&&A.abilities.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2 text-primary-foreground",children:"Abilities"}),(0,l.jsx)("div",{className:"space-y-2",children:A.abilities.map(e=>(0,l.jsxs)("p",{className:"text-foreground/90 whitespace-pre-wrap",children:[(0,l.jsxs)("span",{className:"font-bold",children:[e.name,":"]})," ",e.description]},e.id))})]}),(0,l.jsx)(m.w,{className:"my-6"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4 text-primary-foreground",children:"Deeds"}),e.length>0?e.map((e,s)=>(0,l.jsx)(ed.P,{deed:e,dmgReplacement:A.attributes.DMG},s)):(0,l.jsx)("p",{className:"text-muted-foreground",children:"No deeds defined."})]}),A.description&&(0,l.jsx)(m.w,{className:"my-6"}),A.description&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2 text-primary-foreground",children:"Description"}),(0,l.jsx)("p",{className:"text-foreground/90 whitespace-pre-wrap",children:A.description})]})]}),(0,l.jsx)(U.wL,{children:(0,l.jsxs)($.Lt,{children:[(0,l.jsx)($.tv,{asChild:!0,children:(0,l.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(et.A,{className:"h-4 w-4"})})}),(0,l.jsxs)($.EO,{children:[(0,l.jsxs)($.wd,{children:[(0,l.jsx)($.r7,{children:"Are you sure?"}),(0,l.jsxs)($.$v,{children:['This will permanently delete "',I.getValues("name"),'". This action cannot be undone.']})]}),(0,l.jsxs)($.ck,{children:[(0,l.jsx)($.Zr,{children:"Cancel"}),(0,l.jsx)($.Rx,{onClick:ez,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})})}return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(U.Zp,{children:(0,l.jsx)(V.lV,{...I,children:(0,l.jsxs)("form",{onSubmit:I.handleSubmit(eA),className:"space-y-6",children:[(0,l.jsx)(U.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[L&&N&&(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:ek,className:"-ml-4",children:(0,l.jsx)(O.A,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(U.ZB,{children:t?L?"New Creature":"Create a New Creature":"Editing: ".concat((null==A?void 0:A.name)||"...")}),(0,l.jsx)(U.BT,{children:t?"Fill out the details for your new creature.":"Make your changes and click Save."})]})]}),!L&&(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:ek,className:"text-muted-foreground hover:text-foreground",children:(0,l.jsx)(el.A,{className:"h-5 w-5"})})]})}),(0,l.jsxs)(U.Wu,{className:"space-y-8 pt-0",children:[(0,l.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsx)(V.zB,{name:"name",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{className:"lg:col-span-2",children:[(0,l.jsx)(V.lR,{children:"Name"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{placeholder:"e.g., Gloomfang Serpent",...s})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"level",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Level"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",min:"1",max:"10",...s})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"TR",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"TR"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})}),(0,l.jsx)(V.C5,{})]})}})]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)(V.zB,{name:"template",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Template"}),(0,l.jsxs)(p.l6,{onValueChange:s.onChange,value:s.value,children:[(0,l.jsx)(V.MJ,{children:(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Select a template"})})}),(0,l.jsx)(p.gC,{children:em.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))})]}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"role",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Role"}),(0,l.jsxs)(p.l6,{onValueChange:s.onChange,value:s.value,children:[(0,l.jsx)(V.MJ,{children:(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Select a role"})})}),(0,l.jsx)(p.gC,{children:c.gg.map(e=>(0,l.jsx)(p.eb,{value:e,children:e},e))})]}),(0,l.jsx)(V.C5,{})]})}})]}),(0,l.jsx)(m.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4 text-primary-foreground",children:"Attributes"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[(0,l.jsx)(V.zB,{name:"attributes.HP",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(Z.A,{className:"h-4 w-4 text-accent"}),"HP"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.Speed",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(_.A,{className:"h-4 w-4 text-accent"}),"Speed"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.Initiative",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(K.A,{className:"h-4 w-4 text-accent"}),"Initiative"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.Accuracy",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(Y.A,{className:"h-4 w-4 text-accent"}),"Accuracy"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.Guard",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(Q.A,{className:"h-4 w-4 text-accent"}),"Guard"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.Resist",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(X.A,{className:"h-4 w-4 text-accent"}),"Resist"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.rollBonus",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(ee.A,{className:"h-4 w-4 text-accent"}),"Roll Bonus"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{type:"number",...s})})]})}}),(0,l.jsx)(V.zB,{name:"attributes.DMG",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(es.A,{className:"h-4 w-4 text-accent"}),"DMG"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{...s})})]})}})]})]}),(0,l.jsx)(m.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Abilities"}),(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",onClick:()=>ev({id:crypto.randomUUID(),name:"",description:""}),children:[(0,l.jsx)(ea.A,{className:"h-4 w-4 mr-2"})," Add Ability"]})]}),(0,l.jsx)("div",{className:"space-y-4",children:ep.map((e,s)=>(0,l.jsxs)("div",{className:"border bg-card-foreground/5 rounded-lg p-4 space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(V.zB,{name:"abilities.".concat(s,".name"),control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{className:"flex-1",children:[(0,l.jsx)(V.lR,{children:"Ability Name"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{placeholder:"e.g., Ogre's Wrath",...s})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>eb(s),className:"text-muted-foreground hover:text-destructive self-end",children:(0,l.jsx)(et.A,{className:"h-4 w-4"})})]}),(0,l.jsx)(V.zB,{name:"abilities.".concat(s,".description"),control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Ability Description"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{rows:3,...s})}),(0,l.jsx)(V.C5,{})]})}})]},e.id))})]}),(0,l.jsx)(m.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Deeds"}),(0,l.jsxs)("div",{className:"flex flex-wrap justify-end gap-2",children:[(0,l.jsx)(eg,{onAddDeeds:e=>{let s=e.map(e=>({...e,tags:e.tags||[]}));if("Underling"===ew("template")){let e=s.filter(e=>"light"===e.tier);e.length<s.length&&w({variant:"destructive",title:"Warning",description:"Only Light deeds can be added to Underlings."}),q(e)}else q(s)},allDeeds:k,existingDeedIds:eL}),(0,l.jsxs)(o.$,{type:"button",size:"sm",variant:"outline",onClick:()=>q({name:"",tier:"light",actionType:"attack",deedType:"melee",versus:"guard",target:"",effects:{start:"",base:"",hit:"",spark:"",shadow:"",after:""},tags:[]}),children:[(0,l.jsx)(ea.A,{className:"h-4 w-4 mr-2"})," Create New"]})]})]}),(0,l.jsx)("div",{className:"space-y-4",children:J.map((e,s)=>{var t,a,r,n;return(0,l.jsxs)(ec.Nt,{defaultOpen:!I.getValues("deeds.".concat(s,".name")),className:"border bg-card-foreground/5 rounded-lg p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(ec.R6,{asChild:!0,children:(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-3 text-left w-full",children:[(0,l.jsx)(er.A,{className:"h-5 w-5 text-muted-foreground"}),(0,l.jsx)("span",{className:"text-lg font-semibold text-primary-foreground",children:(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.name)||"New Deed"}),(null==(n=eT.deeds)||null==(r=n[s])?void 0:r.id)&&(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"(from library)"})]})}),(0,l.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>eh(s),className:"text-muted-foreground hover:text-destructive",children:(0,l.jsx)(et.A,{className:"h-4 w-4"})})]}),(0,l.jsxs)(ec.Ke,{className:"mt-6 space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".name"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Deed Name"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{placeholder:"e.g., Inferno",...r,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".tier"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Tier"}),(0,l.jsxs)(p.l6,{onValueChange:r.onChange,value:r.value,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)||"Underling"===eS,children:[(0,l.jsx)(V.MJ,{children:(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Select tier"})})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"light",children:"Light"}),(0,l.jsx)(p.eb,{value:"heavy",children:"Heavy"}),(0,l.jsx)(p.eb,{value:"mighty",children:"Mighty"}),(0,l.jsx)(p.eb,{value:"tyrant",children:"Tyrant"}),(0,l.jsx)(p.eb,{value:"special",children:"Special"})]})]}),(0,l.jsx)(V.C5,{})]})}})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".deedType"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Deed Type"}),(0,l.jsxs)(p.l6,{onValueChange:r.onChange,value:r.value,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id),children:[(0,l.jsx)(V.MJ,{children:(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Type"})})}),(0,l.jsx)(p.gC,{children:D.FC.map(e=>(0,l.jsx)(p.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".actionType"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Action Type"}),(0,l.jsxs)(p.l6,{onValueChange:r.onChange,value:r.value,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id),children:[(0,l.jsx)(V.MJ,{children:(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Action"})})}),(0,l.jsx)(p.gC,{children:D.GW.map(e=>(0,l.jsx)(p.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".versus"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Versus"}),(0,l.jsxs)(p.l6,{onValueChange:r.onChange,value:r.value,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id),children:[(0,l.jsx)(V.MJ,{children:(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Versus"})})}),(0,l.jsx)(p.gC,{children:D.OJ.map(e=>(0,l.jsx)(p.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,l.jsx)(V.C5,{})]})}})]}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".target"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Target"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(d.p,{placeholder:"e.g., 1 Creature | Blast 4",...r,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,l.jsx)("h4",{className:"font-semibold text-sm text-primary-foreground",children:"Effects"}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".effects.start"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{children:["Start ",(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"Effect when a creature starts its turn in an area...",...r,rows:2,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".effects.base"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{children:["Base ",(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"Base effect of the deed...",...r,rows:2,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".effects.hit"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{children:["Hit ",(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"The primary effect on a successful hit...",...r,rows:3,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".effects.spark"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{children:["Spark (Critical Hit) ",(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"The effect on a critical hit...",...r,rows:2,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".effects.shadow"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{children:["Shadow (Critical Failure) ",(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"The effect on a critical failure...",...r,rows:3,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})}),(0,l.jsx)(V.C5,{})]})}}),(0,l.jsx)(V.zB,{name:"deeds.".concat(s,".effects.after"),control:I.control,render:e=>{var t,a;let{field:r}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{children:["After ",(0,l.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"Effect at the end of a creature's turn...",...r,rows:2,disabled:!!(null==(a=eT.deeds)||null==(t=a[s])?void 0:t.id)})})]})}})]})]})]},e.id)})})]}),(0,l.jsx)(m.w,{}),(0,l.jsx)(V.zB,{name:"description",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsx)(V.lR,{children:"Description"}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(G.T,{placeholder:"A short description of the creature...",rows:5,...s})})]})}}),(0,l.jsx)(V.zB,{name:"tags",control:I.control,render:e=>{let{field:s}=e;return(0,l.jsxs)(V.eI,{children:[(0,l.jsxs)(V.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(en.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,l.jsx)(V.MJ,{children:(0,l.jsx)(y.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"creature"})}),(0,l.jsx)(V.C5,{})]})}})]}),(0,l.jsxs)(U.wL,{className:"flex items-center gap-2",children:[!t&&(0,l.jsxs)($.Lt,{children:[(0,l.jsx)($.tv,{asChild:!0,children:(0,l.jsx)(o.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(et.A,{className:"h-4 w-4"})})}),(0,l.jsxs)($.EO,{children:[(0,l.jsxs)($.wd,{children:[(0,l.jsx)($.r7,{children:"Are you sure?"}),(0,l.jsxs)($.$v,{children:['This will permanently delete "',I.getValues("name"),'". This action cannot be undone.']})]}),(0,l.jsxs)($.ck,{children:[(0,l.jsx)($.Zr,{children:"Cancel"}),(0,l.jsx)($.Rx,{onClick:ez,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,l.jsx)("div",{className:"flex-grow"}),!L&&(0,l.jsx)(o.$,{type:"button",variant:"outline",onClick:ek,children:"Cancel"}),(0,l.jsx)(o.$,{type:"submit",children:t?"Create Creature":"Save Changes"})]})]})})})})}var eb=t(20031),eN=t(62709);function ey(){let[e,s]=(0,a.useState)(null),[t,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(0),[o,x]=(0,a.useState)(""),[m,h]=(0,a.useState)("all"),[u,p]=(0,a.useState)("all"),[j,f]=(0,a.useState)(""),[g,v]=(0,a.useState)(""),[b,N]=(0,a.useState)(""),[y,w]=(0,a.useState)(""),[C,R]=(0,a.useState)(""),[S,T]=(0,a.useState)("name"),[A,z]=(0,a.useState)("asc"),[k,F]=(0,a.useState)(!1),L=(0,ex.a)(),[M,B]=(0,a.useState)("list");(0,a.useEffect)(()=>{F(!0)},[]);let E={searchTerm:o,roleFilter:m,templateFilter:u,minLevel:j,maxLevel:g,minTR:b,maxTR:y,tagFilter:C,sortBy:S,sortOrder:A},J={setSearchTerm:x,setRoleFilter:h,setTemplateFilter:p,setMinLevel:f,setMaxLevel:v,setMinTR:N,setMaxTR:w,setTagFilter:R,setSortBy:T,setSortOrder:z},P=(e,s)=>{s.shiftKey?(e.roleFilter&&h(e.roleFilter),e.templateFilter&&p(e.templateFilter),void 0!==e.minLevel&&f(String(e.minLevel)),void 0!==e.maxLevel&&v(String(e.maxLevel)),void 0!==e.minTR&&N(String(e.minTR)),void 0!==e.maxTR&&w(String(e.maxTR)),e.tagFilter&&R(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter)):(h(e.roleFilter||"all"),p(e.templateFilter||"all"),f(void 0!==e.minLevel?String(e.minLevel):""),v(void 0!==e.maxLevel?String(e.maxLevel):""),N(void 0!==e.minTR?String(e.minTR):""),w(void 0!==e.maxTR?String(e.maxTR):""),R(e.tagFilter||""))},D=()=>{x(""),h("all"),p("all"),f(""),v(""),N(""),w(""),R(""),T("name"),z("asc")},U=()=>d(e=>e+1),G=e=>{s(e),r(!1),i(null),L&&B("editor")},$=()=>{s(null),r(!0),i(null),L&&B("editor")},V=e=>{let t={...e},l=(e.name||"creature").replace(/^(Copy of\s*)+/,"");t.name="Copy of ".concat(l),delete t.id,s(null),r(!0),i(t),L&&B("editor")},q=e=>{U(),s(e),r(!1),i(null),L&&B("editor")},O=()=>{U(),s(null),r(!1),i(null),L&&B("list")},H=()=>{t&&(r(!1),s(null),L&&B("list"))};return k?L?(0,l.jsx)(eN.A,{showSidebarTrigger:!1,children:(0,l.jsx)("div",{className:"h-full w-full",children:"list"===M?(0,l.jsx)(I,{onSelectCreature:G,onNewCreature:$,selectedCreatureId:e,dataVersion:c,filters:E,setFilters:J,onClearFilters:D}):(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)("div",{className:"p-4 sm:p-6",children:(0,l.jsx)(ev,{creatureId:e,isCreatingNew:t,template:n,onCreatureSaveSuccess:q,onCreatureDeleteSuccess:O,onUseAsTemplate:V,onEditCancel:H,dataVersion:c,onFilterByClick:P,onBack:()=>{B("list"),s(null),r(!1),i(null)}},null!=e?e:t?"new":"placeholder")})})})}):(0,l.jsx)(eb.GB,{children:(0,l.jsx)(eN.A,{children:(0,l.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,l.jsx)(eb.Bx,{style:{"--sidebar-width":"380px"},children:(0,l.jsx)(I,{onSelectCreature:G,onNewCreature:$,selectedCreatureId:e,dataVersion:c,filters:E,setFilters:J,onClearFilters:D})}),(0,l.jsx)(eb.sF,{className:"flex-1 overflow-y-auto",children:(0,l.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,l.jsx)(ev,{creatureId:e,isCreatingNew:t,template:n,onCreatureSaveSuccess:q,onCreatureDeleteSuccess:O,onUseAsTemplate:V,onEditCancel:H,dataVersion:c,onFilterByClick:P},null!=e?e:t?"new":"placeholder")})})]})})}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[222,194,160,49,923,418,347,516,762,441,684,358],()=>s(54768)),_N_E=e.O()}]);