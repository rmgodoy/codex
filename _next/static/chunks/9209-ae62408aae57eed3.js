"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9209],{7146:(t,e,r)=>{r.d(e,{Xk:()=>a,YS:()=>l,bi:()=>h,fh:()=>o,rX:()=>c,t1:()=>s,z0:()=>n});let a=t=>{let e=[];for(let r=-t;r<=t;r++){let a=Math.max(-t,-r-t),n=Math.min(t,-r+t);for(let t=a;t<=n;t++)e.push({q:r,r:t,s:-r-t})}return e.map(t=>({hex:t,data:{}}))},n=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=[],n=new Map(r.map(t=>["".concat(t.hex.q,",").concat(t.hex.r),t])),l=-Math.floor(t/2),o=l+t-1;for(let t=l;t<=o;t++){let r=-Math.floor(e/2)+-Math.floor(t/2),n=r+e-1;for(let e=r;e<=n;e++){let r=-t-e;a.push({q:t,r:e,s:r})}}return a.map(t=>{let e="".concat(t.q,",").concat(t.r);return n.get(e)||{hex:t,data:{}}})},l=(t,e)=>{let r=[];for(let t=-e;t<=e;t++){let a=Math.max(-e,-t-e),n=Math.min(e,-t+e);for(let e=a;e<=n;e++)r.push({q:t,r:e,s:-t-e})}let a=new Map(t.map(t=>["".concat(t.hex.q,",").concat(t.hex.r),t]));return r.map(t=>{let e="".concat(t.q,",").concat(t.r),r=a.get(e);return r||{hex:t,data:{}}})},o=(t,e)=>({x:e*(1.5*t.q),y:e*(Math.sqrt(3)/2*t.q+Math.sqrt(3)*t.r)}),c=(t,e,r)=>{let a=Math.PI/180*(60*r);return{x:t.x+e*Math.cos(a),y:t.y+e*Math.sin(a)}},i=(t,e,r)=>{let a=Math.round(t),n=Math.round(e),l=Math.round(r),o=Math.abs(a-t),c=Math.abs(n-e),i=Math.abs(l-r);return o>c&&o>i?a=-n-l:c>i?n=-a-l:l=-a-n,{q:a,r:n,s:l}},h=(t,e,r)=>{let a=2/3*t/r,n=(-1/3*t+Math.sqrt(3)/3*e)/r;return i(a,n,-a-n)},u=[{q:1,r:0,s:-1},{q:1,r:-1,s:0},{q:0,r:-1,s:1},{q:-1,r:0,s:1},{q:-1,r:1,s:0},{q:0,r:1,s:-1}],s=t=>u.map(e=>({q:t.q+e.q,r:t.r+e.r,s:t.s+e.s}))},19209:(t,e,r)=>{r.d(e,{A:()=>c});var a=r(95155),n=r(12115),l=r(7146);let o=(t,e,r,a,n)=>{let l=.9*a,o=l/24,{x:c,y:i}=e;t.save(),t.translate(c-l/2,i-l/2),t.scale(o,o),t.strokeStyle=n,t.lineWidth=1.5/o;let h=[];switch(r){case"Home":h=["m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z","M9 22V12h6v10"];break;case"Trees":h=["M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z","M7 16v6","M13 19v3","M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5"];break;case"Mountain":h=["m8 3 4 8 5-5 5 15H2L8 3z"];break;case"Castle":h=["M22 20v-9H2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2Z","M18 11V4H6v7","M15 22v-4a3 3 0 0 0-3-3a3 3 0 0 0-3 3v4","M22 11V9","M2 11V9","M6 4V2","M18 4V2","M10 4V2","M14 4V2"];break;case"TowerControl":h=["M18.2 12.27 20 6H4l1.8 6.27a1 1 0 0 0 .95.73h10.5a1 1 0 0 0 .96-.73Z","M8 13v9","M16 22v-9","m9 6 1 7","m15 6-1 7","M12 6V2","M13 2h-2"];break;case"Tent":h=["M3.5 21 14 3","M20.5 21 10 3","M15.5 21 12 15l-3.5 6","M2 21h20"];break;case"Waves":h=["M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1","M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1","M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"];break;case"MapPin":h=["M12 17v5","M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1 1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z"];break;case"Landmark":h=["M10 18v-7","M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z","M14 18v-7","M18 18v-7","M3 22h18","M6 18v-7"];break;case"Skull":h={paths:["m12.5 17-.5-1-.5 1h1z","M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"],circles:[{cx:15,cy:12,r:1},{cx:9,cy:12,r:1}]}}Array.isArray(h)?h.forEach(e=>{let r=new Path2D(e);t.stroke(r)}):(h.paths.forEach(e=>{let r=new Path2D(e);t.stroke(r)}),h.circles.forEach(e=>{t.beginPath(),t.arc(e.cx,e.cy,e.r,0,2*Math.PI),t.fillStyle=n,t.fill()})),t.restore()},c=t=>{let{mapData:e,hexSize:r=25,className:c,style:i,onGridUpdate:h,onHexClick:u,onAddPointToPath:s,activeTool:f,paintMode:d,paintColor:M,paintIcon:m,paintIconColor:g,selectedHex:p,isCtrlPressed:x,isAltPressed:y,isShiftPressed:b,isEyedropperActive:k,onEyedropperClick:v,pathDrawingId:q}=t,C=(0,n.useRef)(null),w=(0,n.useRef)(null),z=(0,n.useRef)(null),[P,S]=(0,n.useState)({background:"#1A0024",border:"#4B0082",accent:"#8A2BE2",foreground:"#E0D6F0"}),[E,V]=(0,n.useState)({x:0,y:0,zoom:1}),X=(0,n.useRef)(E),[R,D]=(0,n.useState)(!1),Y=(0,n.useRef)({x:0,y:0}),[T,A]=(0,n.useState)(0),[H,B]=(0,n.useState)(!1),[W,L]=(0,n.useState)(!1),[F,I]=(0,n.useState)(null),_=(0,n.useMemo)(()=>new Map(e.tiles.map(t=>["".concat(t.hex.q,",").concat(t.hex.r),t])),[e.tiles]);(0,n.useEffect)(()=>{X.current=E},[E]),(0,n.useEffect)(()=>{{let t=getComputedStyle(document.documentElement);S({background:"hsl(".concat(t.getPropertyValue("--background").trim(),")"),border:"hsl(".concat(t.getPropertyValue("--border").trim(),")"),accent:"hsl(".concat(t.getPropertyValue("--accent").trim(),")"),foreground:"hsl(".concat(t.getPropertyValue("--foreground").trim(),")")})}},[]);let N=(0,n.useCallback)(t=>{let e=C.current;if(!e)return{x:0,y:0};let r=e.getBoundingClientRect(),a="touches"in t?t.touches[0].clientX:t.clientX,n="touches"in t?t.touches[0].clientY:t.clientY;return{x:a-r.left,y:n-r.top}},[]),Z=(0,n.useCallback)((t,e)=>{let r=C.current;if(!r)return{x:0,y:0};let a=X.current,n=r.getBoundingClientRect();return{x:(t-(n.width/2+a.x))/a.zoom,y:(e-(n.height/2+a.y))/a.zoom}},[]),j=(0,n.useCallback)((t,e)=>{let{x:a,y:n}=Z(t,e);return(0,l.bi)(a,n,r)},[r,Z]),J=(0,n.useCallback)(()=>{let t=C.current;if(!t)return;let a=t.getContext("2d");if(!a)return;let n=X.current,{width:o,height:c}=t.getBoundingClientRect();(t.width!==o||t.height!==c)&&(t.width=o,t.height=c),a.fillStyle=P.background,a.fillRect(0,0,o,c),a.save(),a.translate(o/2+n.x,c/2+n.y),a.scale(n.zoom,n.zoom);let i=n.zoom>.4?w.current:z.current;if(i&&i.width>0&&i.height>0){let t=i.width,e=i.height;a.drawImage(i,-t/2,-e/2)}if(e.paths&&e.paths.length>0&&e.paths.forEach(t=>{if(!(t.points.length<2)){a.beginPath(),a.moveTo(t.points[0].x,t.points[0].y);for(let e=1;e<t.points.length;e++)a.lineTo(t.points[e].x,t.points[e].y);a.strokeStyle=t.color,a.lineWidth=t.strokeWidth/n.zoom,a.lineCap="round",a.lineJoin="round",a.stroke()}}),q){let t=e.paths.find(t=>t.id===q);t&&t.points.length>0&&t.points.forEach(e=>{a.beginPath(),a.arc(e.x,e.y,4/n.zoom,0,2*Math.PI),a.fillStyle=t.color,a.fill(),a.strokeStyle="rgba(255, 255, 255, 0.8)",a.lineWidth=1/n.zoom,a.stroke()})}if(p){let t=(0,l.fh)(p,r);a.beginPath();for(let e=0;e<6;e++){let n=(0,l.rX)(t,r,e);0===e?a.moveTo(n.x,n.y):a.lineTo(n.x,n.y)}a.closePath(),a.strokeStyle=P.accent,a.lineWidth=3/n.zoom,a.stroke()}a.restore()},[r,P,p,e.paths,q]);(0,n.useEffect)(()=>{let t,a;if(!e.tiles.length||!C.current)return;let n=1/0,c=-1/0,i=1/0,h=-1/0;if(e.tiles.forEach(t=>{let{hex:e}=t;n=Math.min(n,e.q),c=Math.max(c,e.q),i=Math.min(i,e.r),h=Math.max(h,e.r)}),!isFinite(n))return;let u=c-n+1,s=h-i+1;if("rectangular"===e.shape?(t=(1.5*u+2)*r,a=(s+u/2)*Math.sqrt(3)*r):(t=(1.5*u+.5)*r,a=(s+u/2+.5)*r*Math.sqrt(3)),t<=0||a<=0)return;w.current||(w.current=document.createElement("canvas"));let f=w.current;f.width=t,f.height=a;let d=f.getContext("2d");z.current||(z.current=document.createElement("canvas"));let M=z.current;M.width=t,M.height=a;let m=M.getContext("2d");if(!d||!m)return;d.clearRect(0,0,t,a),m.clearRect(0,0,t,a),d.translate(t/2,a/2),m.translate(t/2,a/2);let g=new Map,p=new Map,x=[],y=new Path2D;e.tiles.forEach(t=>{let{hex:e,data:a}=t,n=(0,l.fh)(e,r),o=new Path2D;for(let t=0;t<6;t++){let e=(0,l.rX)(n,r,t);0===t?o.moveTo(e.x,e.y):o.lineTo(e.x,e.y)}o.closePath(),y.addPath(o);let c=a.color||P.background;g.has(c)||g.set(c,new Path2D),g.get(c).addPath(o),a.icon&&x.push({center:n,icon:a.icon,iconColor:a.iconColor||P.foreground});let i=a.color||P.background;p.has(i)||p.set(i,new Path2D),p.get(i).addPath(o)}),g.forEach((t,e)=>{d.fillStyle=e,d.fill(t)}),d.strokeStyle=P.border,d.lineWidth=1,d.stroke(y),x.forEach(t=>{let{center:e,icon:a,iconColor:n}=t;o(d,e,a,r,n)}),p.forEach((t,e)=>{m.fillStyle=e,m.fill(t)}),J()},[e.tiles,e.shape,e.width,e.height,r,P,J]),(0,n.useEffect)(()=>{J()},[E,J,e.paths,q]);let U=(0,n.useCallback)(t=>{let r=_.get("".concat(t.q,",").concat(t.r));if(!r)return;let a=r.data.color,n=r.data.icon;if(a===M&&n===m)return;let o=new Set,c=[t],i=new Set(["".concat(t.q,",").concat(t.r)]);for(o.add("".concat(t.q,",").concat(t.r));c.length>0;){let t=c.shift();for(let e of(0,l.t1)(t)){let t="".concat(e.q,",").concat(e.r);if(!i.has(t)){i.add(t);let r=_.get(t);r&&r.data.color===a&&r.data.icon===n&&(o.add(t),c.push(e))}}}o.size>0&&h(e.tiles.map(t=>o.has("".concat(t.hex.q,",").concat(t.hex.r))?{...t,data:{...t.data,color:M,icon:m,iconColor:g}}:t))},[e.tiles,_,M,m,g,h]),G=(0,n.useCallback)((t,r)=>{h(e.tiles.map(e=>e.hex.q===t.q&&e.hex.r===t.r?"erase"===r?{...e,data:{...e.data,color:void 0,icon:void 0,iconColor:void 0}}:{...e,data:{...e.data,color:M,icon:m,iconColor:g}}:e))},[e.tiles,M,m,g,h]),K=(0,n.useCallback)(t=>{t.preventDefault();let{x:e,y:r}=N(t);if(2===t.button||1===t.button){D(!0),Y.current={x:e,y:r};return}if("path"===f&&q)return void s(Z(e,r));let a=j(e,r);if(a){if(k||y&&"paint"===f&&"brush"===d)return void v(a);if("paint"===f){let t="brush"===d&&x,e="brush"===d&&b;t||"bucket"===d?U(a):(e||"brush"===d||"erase"===d)&&(L(!0),G(a,e?"erase":d),I(a))}else u(a)}},[N,j,u,d,G,U,f,x,y,b,k,v,q,s,Z]),O=(0,n.useCallback)(t=>{let{x:e,y:r}=N(t);if(R){let t=e-Y.current.x,a=r-Y.current.y;Y.current={x:e,y:r},X.current.x+=t,X.current.y+=a,requestAnimationFrame(J);return}if(W&&"paint"===f){let t=j(e,r);t&&(!F||t.q!==F.q||t.r!==F.r)&&(G(t,b?"erase":d),I(t))}},[R,N,d,W,G,f,J,F,b,j]),Q=(0,n.useCallback)(t=>{t.preventDefault();let e=t.touches,{x:r,y:a}=N(t);if(1===e.length){if("path"===f&&q)return void s(Z(r,a));let t=j(r,a);if(k){t&&v(t);return}D(!0),Y.current={x:r,y:a},"paint"===f&&("brush"===d||"erase"===d)?t&&(L(!0),G(t,d),I(t)):t&&u(t)}else if(2===e.length){D(!0),B(!0);let t=e[0],r=e[1];A(Math.hypot(t.clientX-r.clientX,t.clientY-r.clientY));let a=C.current.getBoundingClientRect();Y.current={x:(t.clientX+r.clientX)/2-a.left,y:(t.clientY+r.clientY)/2-a.top}}},[N,j,k,v,f,d,G,u,q,s,Z]),$=(0,n.useCallback)(t=>{t.preventDefault();let e=t.touches,r=C.current.getBoundingClientRect();if(1!==e.length||H){if(2===e.length&&R){let t=e[0],a=e[1],n=Math.hypot(t.clientX-a.clientX,t.clientY-a.clientY),l={x:(t.clientX+a.clientX)/2-r.left,y:(t.clientY+a.clientY)/2-r.top},o=n/T,c=Math.max(.1,Math.min(5,X.current.zoom*o)),i=(l.x-(r.width/2+X.current.x))/X.current.zoom,h=(l.y-(r.height/2+X.current.y))/X.current.zoom,u=l.x-i*c-r.width/2,s=l.y-h*c-r.height/2;X.current={x:u,y:s,zoom:c},V({x:u,y:s,zoom:c}),A(n),Y.current=l}}else{let{x:e,y:r}=N(t),a=e-Y.current.x,n=r-Y.current.y;if(W&&"paint"===f){let t=j(e,r);t&&(!F||t.q!==F.q||t.r!==F.r)&&(G(t,d),I(t))}else R&&(X.current.x+=a,X.current.y+=n,requestAnimationFrame(J));Y.current={x:e,y:r}}},[R,H,W,T,J,N,j,G,d,F,f]),tt=(0,n.useCallback)(t=>{D(!1),B(!1),L(!1),I(null)},[]);return(0,a.jsx)("canvas",{ref:C,className:c,style:i,onMouseDown:K,onMouseUp:t=>{0===t.button&&(L(!1),I(null)),(2===t.button||1===t.button)&&R&&(D(!1),V({...X.current}))},onMouseMove:O,onMouseLeave:()=>{R&&(D(!1),V({...X.current})),L(!1),I(null)},onWheel:t=>{t.preventDefault();let e=X.current,r=t.deltaY<0?1.1*e.zoom:e.zoom/1.1,a=C.current;if(!a)return;let n=a.getBoundingClientRect(),l=t.clientX-n.left,o=t.clientY-n.top,c=(l-(n.width/2+e.x))/e.zoom,i=(o-(n.height/2+e.y))/e.zoom,h=l-c*r-n.width/2,u=o-i*r-n.height/2,s=Math.max(.1,Math.min(5,r));X.current={x:h,y:u,zoom:s},V({x:h,y:u,zoom:s})},onTouchStart:Q,onTouchMove:$,onTouchEnd:tt,onContextMenu:t=>t.preventDefault()})}}}]);