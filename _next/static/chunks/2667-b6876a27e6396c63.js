"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2667],{42667:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Q});var l=t(95155),a=t(12115),n=t(34239),i=t(62523),r=t(30285),c=t(66424),d=t(22346),o=t(87481),h=t(34301),x=t(75074),m=t(9572),j=t(20203),u=t(73926),p=t(85057),f=t(59409),g=t(90648),N=t(8643);function v(e){let{onSelectEntity:s,onNewEntity:t,selectedEntityId:v,dataVersion:y,filters:w,setFilters:b,onClearFilters:C}=e,[S,E]=(0,a.useState)([]),[z,k]=(0,a.useState)(!0),{toast:A}=(0,o.dj)();(0,a.useEffect)(()=>{(async()=>{k(!0);try{E(await (0,n.Wt)())}catch(e){A({variant:"destructive",title:"Error",description:"Could not fetch entities from database."})}finally{k(!1)}})()},[y,A]);let F=(0,a.useMemo)(()=>{let e=S.filter(e=>{let s=e.name.toLowerCase().includes(w.searchTerm.toLowerCase())||e.domain.toLowerCase().includes(w.searchTerm.toLowerCase()),t=!0,l=w.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return l.length>0&&(t=!!e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&t}).sort((e,s)=>{if("domain"===w.sortBy){let t=e.domain.localeCompare(s.domain);if(0!==t)return t}return e.name.localeCompare(s.name)});return"desc"===w.sortOrder&&e.reverse(),e},[S,w]);return(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)(r.$,{onClick:t,className:"w-full",children:[(0,l.jsx)(h.A,{})," New Entity"]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(x.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(i.p,{placeholder:"Search entities...",value:w.searchTerm,onChange:e=>b.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,l.jsxs)(N.Nt,{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(N.R6,{asChild:!0,children:(0,l.jsxs)(r.$,{variant:"ghost",className:"-ml-2",children:[(0,l.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Filters"]})}),(0,l.jsx)(r.$,{variant:"ghost",size:"sm",onClick:C,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,l.jsx)(N.Ke,{className:"space-y-2 pt-2",children:(0,l.jsx)(g.F,{value:w.tagFilter?w.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>b.setTagFilter(e.join(",")),placeholder:"Tags...",tagSource:"pantheon"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(p.J,{children:"Sort by"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(f.l6,{value:w.sortBy,onValueChange:e=>b.setSortBy(e),children:[(0,l.jsx)(f.bq,{children:(0,l.jsx)(f.yv,{placeholder:"Sort by"})}),(0,l.jsxs)(f.gC,{children:[(0,l.jsx)(f.eb,{value:"name",children:"Name"}),(0,l.jsx)(f.eb,{value:"domain",children:"Domain"})]})]}),(0,l.jsxs)(r.$,{variant:"ghost",size:"icon",onClick:()=>b.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===w.sortOrder?(0,l.jsx)(j.A,{className:"h-4 w-4"}):(0,l.jsx)(u.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,l.jsx)(d.w,{}),(0,l.jsx)(c.F,{className:"flex-1",children:(0,l.jsx)("div",{className:"p-4",children:z?(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading entities..."}):F.length>0?(0,l.jsx)("ul",{className:"space-y-1",children:F.map(e=>(0,l.jsx)("li",{children:(0,l.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(v===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,l.jsxs)("span",{className:"text-xs opacity-70",children:["(",e.domain,")"]})]})},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"No entities found."})})})]})}var y=t(62177),w=t(90221),b=t(55594),C=t(66695),S=t(88539),E=t(90010),z=t(17759),k=t(18046),A=t(21887),F=t(12543),I=t(18763),T=t(77223),$=t(25318),B=t(53054),R=t(14337),M=t(68856),L=t(26126),J=t(47906),D=t(54165),O=t(14636),V=t(59434),W=t(38914);let Z=b.z.object({id:b.z.string(),targetEntityId:b.z.string().min(1,"Target Entity is required"),type:b.z.string().min(1,"Relationship type is required")}),q=b.z.object({name:b.z.string().min(1,"Name is required"),entityType:b.z.string().optional(),domain:b.z.string().optional(),symbols:b.z.string().optional(),followers:b.z.string().optional(),artifactId:b.z.string().optional(),relationships:b.z.array(Z).optional(),goal:b.z.string().optional(),lore:b.z.string().optional(),tags:b.z.array(b.z.string()).optional()}),G={name:"",entityType:"",domain:"",symbols:"",followers:"",artifactId:"",relationships:[],goal:"",lore:"",tags:[]},U=e=>{var s;let{currentEntityId:t,allEntities:n,onAdd:d}=e,[o,h]=(0,a.useState)(!1),[x,m]=(0,a.useState)(""),[j,u]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),N=(0,a.useMemo)(()=>(n||[]).filter(e=>e.id!==t),[n,t]);return(0,l.jsxs)(D.lG,{open:o,onOpenChange:h,children:[(0,l.jsx)(D.zM,{asChild:!0,children:(0,l.jsxs)(r.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 mr-2"})," Add Relationship"]})}),(0,l.jsxs)(D.Cf,{children:[(0,l.jsx)(D.c7,{children:(0,l.jsx)(D.L3,{children:"Add New Relationship"})}),(0,l.jsxs)("div",{className:"space-y-4 py-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p.J,{htmlFor:"target-entity",children:"Target Entity"}),(0,l.jsxs)(O.AM,{open:f,onOpenChange:g,children:[(0,l.jsx)(O.Wv,{asChild:!0,children:(0,l.jsxs)(r.$,{id:"target-entity",variant:"outline",role:"combobox",className:"w-full justify-between",children:[x?null==(s=N.find(e=>e.id===x))?void 0:s.name:"Select an Entity...",(0,l.jsx)(A.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,l.jsx)(O.hl,{className:"w-[var(--radix-popover-trigger-width)] p-0",children:(0,l.jsx)(c.F,{className:"h-48",children:N.map(e=>(0,l.jsx)(r.$,{variant:"ghost",onClick:()=>{m(e.id),g(!1)},className:(0,V.cn)("w-full justify-start",x===e.id&&"bg-accent"),children:e.name},e.id))})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p.J,{htmlFor:"relationship-type",children:"Relationship Type"}),(0,l.jsx)(i.p,{id:"relationship-type",value:j,onChange:e=>u(e.target.value),placeholder:"e.g., friends with, hates, sibling of..."})]})]}),(0,l.jsxs)(D.Es,{children:[(0,l.jsx)(r.$,{variant:"ghost",onClick:()=>h(!1),children:"Cancel"}),(0,l.jsx)(r.$,{onClick:()=>{x&&j&&(d({id:crypto.randomUUID(),targetEntityId:x,type:j}),h(!1),m(""),u(""))},disabled:!x||!j,children:"Add"})]})]})]})},_=e=>{let{onSelect:s,allArtifacts:t,children:n}=e,[d,o]=(0,a.useState)(!1),[h,x]=(0,a.useState)(""),m=(0,a.useMemo)(()=>t.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())),[t,h]);return(0,l.jsxs)(D.lG,{open:d,onOpenChange:o,children:[(0,l.jsx)(D.zM,{asChild:!0,children:n}),(0,l.jsxs)(D.Cf,{className:"max-w-md h-[60vh] flex flex-col",children:[(0,l.jsx)(D.c7,{children:(0,l.jsx)(D.L3,{children:"Select an Artifact"})}),(0,l.jsx)(i.p,{placeholder:"Search artifacts...",value:h,onChange:e=>x(e.target.value),className:"mb-4 shrink-0"}),(0,l.jsx)(c.F,{className:"flex-1 border rounded-md p-2",children:m.map(e=>(0,l.jsx)(r.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>{s(e.id),o(!1)},children:e.name},e.id))})]})]})};function P(e){let{entityId:s,isCreatingNew:t,onSaveSuccess:c,onDeleteSuccess:h,onEditCancel:x,onBack:m,dataVersion:j,onFilterByClick:u}=e,{toast:f}=(0,o.dj)(),[N,v]=(0,a.useState)(t),[b,k]=(0,a.useState)(!t&&!!s),[A,D]=(0,a.useState)(null),[O,V]=(0,a.useState)([]),[Z,P]=(0,a.useState)([]),K=(0,J.a)(),{worldSlug:H}=(0,W.q)(),Q=(0,a.useMemo)(()=>new Map(O.map(e=>[e.id,e.name])),[O]),X=(0,a.useMemo)(()=>new Map(Z.map(e=>[e.id,e.name])),[Z]),Y=(0,y.mN)({resolver:(0,w.u)(q),defaultValues:G}),{control:ee,watch:es,setValue:et}=Y,{fields:el,append:ea,remove:en}=(0,y.jz)({control:Y.control,name:"relationships"});(0,a.useEffect)(()=>{Promise.all([(0,n.Wt)(),(0,n.i7)().then(e=>e.filter(e=>"artifact"===e.magicTier))]).then(e=>{let[s,t]=e;V(s),P(t)})},[j]),(0,a.useEffect)(()=>{(async()=>{if(t){Y.reset(G),D(null),v(!0),k(!1);return}if(!s){v(!1),k(!1),D(null);return}k(!0),v(!1);try{let e=await (0,n.Bf)(s);e?(Y.reset({...G,...e}),D(e)):D(null)}catch(e){f({variant:"destructive",title:"Error",description:"Could not load entity data."})}finally{k(!1)}})()},[s,t,Y,f,j]);let ei=()=>{t?x():A&&(Y.reset({...G,...A}),v(!1))},er=async e=>{try{let l={...e,tags:e.tags||[],relationships:e.relationships||[]},a=e.tags||[];if(a.length>0&&await (0,n.JE)(a,"pantheon"),t){let s=await (0,n.SE)(l);f({title:"Entity Created!",description:"".concat(e.name," has been added.")}),c(s)}else s&&(await (0,n.mo)({...l,id:s}),f({title:"Save Successful",description:"".concat(e.name," has been updated.")}),c(s));v(!1)}catch(e){f({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},ec=async()=>{if(s)try{await (0,n.Sj)(s),f({title:"Entity Deleted",description:"The entity has been removed."}),h()}catch(e){f({variant:"destructive",title:"Deletion Failed",description:"Could not delete the entity."})}},ed=es("artifactId");if(b)return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(C.Zp,{children:[(0,l.jsx)(C.aR,{children:(0,l.jsx)(M.E,{className:"h-8 w-48"})}),(0,l.jsx)(C.Wu,{children:(0,l.jsx)(M.E,{className:"h-40 w-full"})})]})});if(!s&&!t)return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(C.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,l.jsxs)(C.Wu,{className:"text-center pt-6",children:[(0,l.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select an entity to view"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})});if(!N&&A){let e="".concat(A.name,", The ").concat(A.entityType||"..."," of ").concat(A.domain||"...");return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(C.Zp,{children:[(0,l.jsx)(C.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[K&&m&&(0,l.jsx)(r.$,{variant:"ghost",size:"icon",onClick:m,className:"shrink-0 -ml-2 -mt-1",children:(0,l.jsx)(F.A,{className:"h-5 w-5"})}),(0,l.jsx)("div",{children:(0,l.jsx)(C.ZB,{className:"text-3xl font-bold",children:e})})]}),(0,l.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>v(!0),children:[(0,l.jsx)(I.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})}),(0,l.jsx)(C.Wu,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Lore"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:A.lore||"Not specified."})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Goal"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:A.goal||"Not specified."})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Symbols"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:A.symbols||"Not specified."})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Followers"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:A.followers||"Not specified."})]}),A.artifactId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.w,{}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Artifact:"})," ",(0,l.jsx)("a",{href:"#/".concat(H,"/items/").concat(A.artifactId),className:"text-accent hover:underline",children:X.get(A.artifactId)||"Unknown Artifact"})]})]}),A.relationships&&A.relationships.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Relationships"}),(0,l.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:A.relationships.map(e=>(0,l.jsxs)("li",{className:"text-sm",children:[(0,l.jsx)("span",{className:"capitalize",children:e.type})," ",(0,l.jsx)("span",{className:"font-semibold text-accent",children:Q.get(e.targetEntityId)||"Unknown Entity"})]},e.id))})]})]}),A.tags&&A.tags.length>0&&(0,l.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:A.tags.map(e=>(0,l.jsx)("button",{onClick:s=>u({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,l.jsx)(L.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]})}),(0,l.jsx)(C.wL,{children:(0,l.jsxs)(E.Lt,{children:[(0,l.jsx)(E.tv,{asChild:!0,children:(0,l.jsx)(r.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(T.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(E.EO,{children:[(0,l.jsxs)(E.wd,{children:[(0,l.jsx)(E.r7,{children:"Are you sure?"}),(0,l.jsxs)(E.$v,{children:['This will permanently delete "',A.name,'".']})]}),(0,l.jsxs)(E.ck,{children:[(0,l.jsx)(E.Zr,{children:"Cancel"}),(0,l.jsx)(E.Rx,{onClick:ec,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})})}return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(C.Zp,{children:(0,l.jsx)(z.lV,{...Y,children:(0,l.jsxs)("form",{onSubmit:Y.handleSubmit(er),className:"space-y-6",children:[(0,l.jsx)(C.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[K&&m&&(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:ei,className:"shrink-0 -ml-2",children:(0,l.jsx)(F.A,{className:"h-5 w-5"})}),(0,l.jsx)("div",{children:(0,l.jsx)(C.ZB,{children:t?"Create New Entity":"Editing: ".concat(Y.getValues("name")||"...")})})]}),!K&&(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:ei,className:"text-muted-foreground hover:text-foreground",children:(0,l.jsx)($.A,{className:"h-5 w-5"})})]})}),(0,l.jsxs)(C.Wu,{className:"space-y-6",children:[(0,l.jsx)(z.zB,{name:"name",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Name"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(i.p,{...s})}),(0,l.jsx)(z.C5,{})]})}}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(z.zB,{name:"entityType",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Entity Type"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(i.p,{...s,placeholder:"e.g., God, Titan..."})})]})}}),(0,l.jsx)(z.zB,{name:"domain",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Domain"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(i.p,{...s,placeholder:"e.g., War, Oceans..."})})]})}})]}),(0,l.jsx)(z.zB,{name:"symbols",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Symbols"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(i.p,{...s})})]})}}),(0,l.jsx)(z.zB,{name:"followers",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Followers"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(i.p,{...s})})]})}}),(0,l.jsx)(z.zB,{name:"goal",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Goal"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(S.T,{...s,rows:2})})]})}}),(0,l.jsx)(z.zB,{name:"lore",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsx)(z.lR,{children:"Lore"}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(S.T,{...s,rows:5})})]})}}),(0,l.jsx)(z.zB,{name:"tags",control:ee,render:e=>{let{field:s}=e;return(0,l.jsxs)(z.eI,{children:[(0,l.jsxs)(z.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(B.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,l.jsx)(z.MJ,{children:(0,l.jsx)(g.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"pantheon"})}),(0,l.jsx)(z.C5,{})]})}}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p.J,{children:"Artifact"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:ed?(0,l.jsxs)("div",{className:"flex-1 flex items-center justify-between rounded-md border p-2",children:[(0,l.jsx)("p",{className:"font-semibold",children:X.get(ed)}),(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>et("artifactId",void 0),children:(0,l.jsx)($.A,{className:"h-4 w-4"})})]}):(0,l.jsx)(_,{onSelect:e=>et("artifactId",e),allArtifacts:Z,children:(0,l.jsxs)(r.$,{type:"button",variant:"outline",className:"w-full",children:[(0,l.jsx)(R.A,{className:"h-4 w-4 mr-2"}),"Select Artifact"]})})})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Relationships"}),(0,l.jsx)(U,{currentEntityId:s,allEntities:O,onAdd:ea})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[el.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded-lg bg-card-foreground/5",children:[(0,l.jsxs)("p",{className:"flex-1",children:[(0,l.jsx)("span",{className:"capitalize",children:e.type})," ",(0,l.jsx)("span",{className:"font-semibold text-accent",children:Q.get(e.targetEntityId)||"..."})]}),(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>en(s),className:"text-muted-foreground hover:text-destructive shrink-0",children:(0,l.jsx)(T.A,{className:"h-4 w-4"})})]},e.id)),0===el.length&&(0,l.jsx)("p",{className:"text-muted-foreground text-center text-sm py-2",children:"No relationships defined."})]})]})]}),(0,l.jsxs)(C.wL,{className:"flex items-center gap-2",children:[!t&&(0,l.jsxs)(E.Lt,{children:[(0,l.jsx)(E.tv,{asChild:!0,children:(0,l.jsx)(r.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(T.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(E.EO,{children:[(0,l.jsxs)(E.wd,{children:[(0,l.jsx)(E.r7,{children:"Are you sure?"}),(0,l.jsxs)(E.$v,{children:['This will permanently delete "',Y.getValues("name"),'".']})]}),(0,l.jsxs)(E.ck,{children:[(0,l.jsx)(E.Zr,{children:"Cancel"}),(0,l.jsx)(E.Rx,{onClick:ec,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,l.jsx)("div",{className:"flex-grow"}),!K&&(0,l.jsx)(r.$,{type:"button",variant:"outline",onClick:ei,children:"Cancel"}),(0,l.jsx)(r.$,{type:"submit",children:t?"Create Entity":"Save Changes"})]})]})})})})}var K=t(6195),H=t(20031);function Q(){let[e,s]=(0,a.useState)(null),[t,n]=(0,a.useState)(!1),[i,r]=(0,a.useState)(0),[c,d]=(0,a.useState)(""),[o,h]=(0,a.useState)(""),[x,m]=(0,a.useState)("name"),[j,u]=(0,a.useState)("asc"),[p,f]=(0,a.useState)(!1),g=(0,J.a)(),[N,y]=(0,a.useState)("list");(0,a.useEffect)(()=>{f(!0)},[]);let w={searchTerm:c,tagFilter:o,sortBy:x,sortOrder:j},b={setSearchTerm:d,setTagFilter:h,setSortBy:m,setSortOrder:u},C=(e,s)=>{s.stopPropagation(),h(e.tagFilter||"")},S=()=>{d(""),h(""),m("name"),u("asc")},E=()=>r(e=>e+1),z=e=>{s(e),n(!1),g&&y("editor")},k=()=>{s(null),n(!0),g&&y("editor")},A=e=>{E(),s(e),n(!1),g&&y("editor")},F=()=>{E(),s(null),n(!1),g&&y("list")},I=()=>{t&&(n(!1),s(null),g&&y("list"))};return p?g?(0,l.jsx)(K.A,{showSidebarTrigger:!1,children:(0,l.jsx)("div",{className:"h-full w-full",children:"list"===N?(0,l.jsx)(v,{onSelectEntity:z,onNewEntity:k,selectedEntityId:e,dataVersion:i,filters:w,setFilters:b,onClearFilters:S}):(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)("div",{className:"p-4 sm:p-6",children:(0,l.jsx)(P,{entityId:e,isCreatingNew:t,onSaveSuccess:A,onDeleteSuccess:F,onEditCancel:I,onBack:()=>{y("list"),s(null),n(!1)},dataVersion:i,onFilterByClick:C},null!=e?e:t?"new":"placeholder")})})})}):(0,l.jsx)(H.SidebarProvider,{children:(0,l.jsx)(K.A,{children:(0,l.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,l.jsx)(H.Bx,{style:{"--sidebar-width":"380px"},children:(0,l.jsx)(v,{onSelectEntity:z,onNewEntity:k,selectedEntityId:e,dataVersion:i,filters:w,setFilters:b,onClearFilters:S})}),(0,l.jsx)(H.sF,{className:"flex-1 overflow-y-auto",children:(0,l.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,l.jsx)(P,{entityId:e,isCreatingNew:t,onSaveSuccess:A,onDeleteSuccess:F,onEditCancel:I,dataVersion:i,onFilterByClick:C},null!=e?e:t?"new":"placeholder")})})]})})}):null}}}]);