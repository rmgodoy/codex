"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2667],{42667:(e,s,t)=>{t.r(s),t.d(s,{default:()=>K});var l=t(95155),a=t(12115),i=t(53648),n=t(62523),r=t(30285),c=t(66424),d=t(22346),o=t(87481),x=t(34301),h=t(75074),m=t(20203),j=t(73926),u=t(85057),p=t(59409),f=t(90648);function g(e){let{onSelectEntity:s,onNewEntity:t,selectedEntityId:g,dataVersion:N,filters:y,setFilters:v,onClearFilters:w}=e,[b,C]=(0,a.useState)([]),[S,E]=(0,a.useState)(!0),{toast:z}=(0,o.dj)();(0,a.useEffect)(()=>{(async()=>{E(!0);try{C(await (0,i.Wt)())}catch(e){z({variant:"destructive",title:"Error",description:"Could not fetch entities from database."})}finally{E(!1)}})()},[N,z]);let k=(0,a.useMemo)(()=>{let e=b.filter(e=>{let s=e.name.toLowerCase().includes(y.searchTerm.toLowerCase())||e.domain.toLowerCase().includes(y.searchTerm.toLowerCase()),t=!0,l=y.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return l.length>0&&(t=!!e.tags&&l.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&t}).sort((e,s)=>{if("domain"===y.sortBy){let t=e.domain.localeCompare(s.domain);if(0!==t)return t}return e.name.localeCompare(s.name)});return"desc"===y.sortOrder&&e.reverse(),e},[b,y]);return(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsxs)("div",{className:"p-4 space-y-4",children:[(0,l.jsxs)(r.$,{onClick:t,className:"w-full",children:[(0,l.jsx)(x.A,{})," New Entity"]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(h.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(n.p,{placeholder:"Search entities...",value:y.searchTerm,onChange:e=>v.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(u.J,{children:"Filter"}),(0,l.jsx)(r.$,{variant:"ghost",size:"sm",onClick:w,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,l.jsx)(f.F,{value:y.tagFilter?y.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>v.setTagFilter(e.join(",")),placeholder:"Tags...",tagSource:"pantheon"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(u.J,{children:"Sort by"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(p.l6,{value:y.sortBy,onValueChange:e=>v.setSortBy(e),children:[(0,l.jsx)(p.bq,{children:(0,l.jsx)(p.yv,{placeholder:"Sort by"})}),(0,l.jsxs)(p.gC,{children:[(0,l.jsx)(p.eb,{value:"name",children:"Name"}),(0,l.jsx)(p.eb,{value:"domain",children:"Domain"})]})]}),(0,l.jsxs)(r.$,{variant:"ghost",size:"icon",onClick:()=>v.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===y.sortOrder?(0,l.jsx)(m.A,{className:"h-4 w-4"}):(0,l.jsx)(j.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,l.jsx)(d.w,{}),(0,l.jsx)(c.F,{className:"flex-1",children:(0,l.jsx)("div",{className:"p-4",children:S?(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading entities..."}):k.length>0?(0,l.jsx)("ul",{className:"space-y-1",children:k.map(e=>(0,l.jsx)("li",{children:(0,l.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(g===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,l.jsxs)("span",{className:"text-xs opacity-70",children:["(",e.domain,")"]})]})},e.id))}):(0,l.jsx)("p",{className:"text-muted-foreground text-center",children:"No entities found."})})})]})}var N=t(62177),y=t(90221),v=t(55594),w=t(66695),b=t(88539),C=t(90010),S=t(17759),E=t(18046),z=t(21887),k=t(12543),A=t(18763),F=t(77223),I=t(25318),T=t(53054),$=t(14337),B=t(68856),R=t(26126),M=t(47906),L=t(54165),J=t(14636),D=t(59434),O=t(6874),V=t.n(O);let W=v.z.object({id:v.z.string(),targetEntityId:v.z.string().min(1,"Target Entity is required"),type:v.z.string().min(1,"Relationship type is required")}),Z=v.z.object({name:v.z.string().min(1,"Name is required"),entityType:v.z.string().optional(),domain:v.z.string().optional(),symbols:v.z.string().optional(),followers:v.z.string().optional(),artifactId:v.z.string().optional(),relationships:v.z.array(W).optional(),goal:v.z.string().optional(),lore:v.z.string().optional(),tags:v.z.array(v.z.string()).optional()}),G={name:"",entityType:"",domain:"",symbols:"",followers:"",artifactId:"",relationships:[],goal:"",lore:"",tags:[]},q=e=>{var s;let{currentEntityId:t,allEntities:i,onAdd:d}=e,[o,x]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),[j,p]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),N=(0,a.useMemo)(()=>(i||[]).filter(e=>e.id!==t),[i,t]);return(0,l.jsxs)(L.lG,{open:o,onOpenChange:x,children:[(0,l.jsx)(L.zM,{asChild:!0,children:(0,l.jsxs)(r.$,{type:"button",size:"sm",variant:"outline",children:[(0,l.jsx)(E.A,{className:"h-4 w-4 mr-2"})," Add Relationship"]})}),(0,l.jsxs)(L.Cf,{children:[(0,l.jsx)(L.c7,{children:(0,l.jsx)(L.L3,{children:"Add New Relationship"})}),(0,l.jsxs)("div",{className:"space-y-4 py-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u.J,{htmlFor:"target-entity",children:"Target Entity"}),(0,l.jsxs)(J.AM,{open:f,onOpenChange:g,children:[(0,l.jsx)(J.Wv,{asChild:!0,children:(0,l.jsxs)(r.$,{id:"target-entity",variant:"outline",role:"combobox",className:"w-full justify-between",children:[h?null==(s=N.find(e=>e.id===h))?void 0:s.name:"Select an Entity...",(0,l.jsx)(z.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,l.jsx)(J.hl,{className:"w-[var(--radix-popover-trigger-width)] p-0",children:(0,l.jsx)(c.F,{className:"h-48",children:N.map(e=>(0,l.jsx)(r.$,{variant:"ghost",onClick:()=>{m(e.id),g(!1)},className:(0,D.cn)("w-full justify-start",h===e.id&&"bg-accent"),children:e.name},e.id))})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u.J,{htmlFor:"relationship-type",children:"Relationship Type"}),(0,l.jsx)(n.p,{id:"relationship-type",value:j,onChange:e=>p(e.target.value),placeholder:"e.g., friends with, hates, sibling of..."})]})]}),(0,l.jsxs)(L.Es,{children:[(0,l.jsx)(r.$,{variant:"ghost",onClick:()=>x(!1),children:"Cancel"}),(0,l.jsx)(r.$,{onClick:()=>{h&&j&&(d({id:crypto.randomUUID(),targetEntityId:h,type:j}),x(!1),m(""),p(""))},disabled:!h||!j,children:"Add"})]})]})]})},U=e=>{let{onSelect:s,allArtifacts:t,children:i}=e,[d,o]=(0,a.useState)(!1),[x,h]=(0,a.useState)(""),m=(0,a.useMemo)(()=>t.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())),[t,x]);return(0,l.jsxs)(L.lG,{open:d,onOpenChange:o,children:[(0,l.jsx)(L.zM,{asChild:!0,children:i}),(0,l.jsxs)(L.Cf,{className:"max-w-md h-[60vh] flex flex-col",children:[(0,l.jsx)(L.c7,{children:(0,l.jsx)(L.L3,{children:"Select an Artifact"})}),(0,l.jsx)(n.p,{placeholder:"Search artifacts...",value:x,onChange:e=>h(e.target.value),className:"mb-4 shrink-0"}),(0,l.jsx)(c.F,{className:"flex-1 border rounded-md p-2",children:m.map(e=>(0,l.jsx)(r.$,{variant:"ghost",className:"w-full justify-start",onClick:()=>{s(e.id),o(!1)},children:e.name},e.id))})]})]})};function _(e){let{entityId:s,isCreatingNew:t,onSaveSuccess:c,onDeleteSuccess:x,onEditCancel:h,onBack:m,dataVersion:j,onFilterByClick:p}=e,{toast:g}=(0,o.dj)(),[v,E]=(0,a.useState)(t),[z,L]=(0,a.useState)(!t&&!!s),[J,D]=(0,a.useState)(null),[O,W]=(0,a.useState)([]),[_,P]=(0,a.useState)([]),H=(0,M.a)(),K=(0,a.useMemo)(()=>new Map(O.map(e=>[e.id,e.name])),[O]),Q=(0,a.useMemo)(()=>new Map(_.map(e=>[e.id,e.name])),[_]),X=(0,N.mN)({resolver:(0,y.u)(Z),defaultValues:G}),{control:Y,watch:ee,setValue:es}=X,{fields:et,append:el,remove:ea}=(0,N.jz)({control:X.control,name:"relationships"});(0,a.useEffect)(()=>{Promise.all([(0,i.Wt)(),(0,i.i7)().then(e=>e.filter(e=>"artifact"===e.magicTier))]).then(e=>{let[s,t]=e;W(s),P(t)})},[j]),(0,a.useEffect)(()=>{(async()=>{if(t){X.reset(G),D(null),E(!0),L(!1);return}if(!s){E(!1),L(!1),D(null);return}L(!0),E(!1);try{let e=await (0,i.Bf)(s);e?(X.reset({...G,...e}),D(e)):D(null)}catch(e){g({variant:"destructive",title:"Error",description:"Could not load entity data."})}finally{L(!1)}})()},[s,t,X,g,j]);let ei=()=>{t?h():J&&(X.reset({...G,...J}),E(!1))},en=async e=>{try{let l={...e,tags:e.tags||[],relationships:e.relationships||[]},a=e.tags||[];if(a.length>0&&await (0,i.JE)(a,"pantheon"),t){let s=await (0,i.SE)(l);g({title:"Entity Created!",description:"".concat(e.name," has been added.")}),c(s)}else s&&(await (0,i.mo)({...l,id:s}),g({title:"Save Successful",description:"".concat(e.name," has been updated.")}),c(s));E(!1)}catch(e){g({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},er=async()=>{if(s)try{await (0,i.Sj)(s),g({title:"Entity Deleted",description:"The entity has been removed."}),x()}catch(e){g({variant:"destructive",title:"Deletion Failed",description:"Could not delete the entity."})}},ec=ee("artifactId");if(z)return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(w.Zp,{children:[(0,l.jsx)(w.aR,{children:(0,l.jsx)(B.E,{className:"h-8 w-48"})}),(0,l.jsx)(w.Wu,{children:(0,l.jsx)(B.E,{className:"h-40 w-full"})})]})});if(!s&&!t)return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(w.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,l.jsxs)(w.Wu,{className:"text-center pt-6",children:[(0,l.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select an entity to view"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})});if(!v&&J){let e="".concat(J.name,", The ").concat(J.entityType||"..."," of ").concat(J.domain||"...");return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsxs)(w.Zp,{children:[(0,l.jsx)(w.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[H&&m&&(0,l.jsx)(r.$,{variant:"ghost",size:"icon",onClick:m,className:"shrink-0 -ml-2 -mt-1",children:(0,l.jsx)(k.A,{className:"h-5 w-5"})}),(0,l.jsx)("div",{children:(0,l.jsx)(w.ZB,{className:"text-3xl font-bold",children:e})})]}),(0,l.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>E(!0),children:[(0,l.jsx)(A.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})}),(0,l.jsx)(w.Wu,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Lore"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:J.lore||"Not specified."})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Goal"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:J.goal||"Not specified."})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Symbols"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:J.symbols||"Not specified."})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Followers"}),(0,l.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:J.followers||"Not specified."})]}),J.artifactId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.w,{}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Artifact:"})," ",(0,l.jsx)(V(),{href:"/items",className:"text-accent hover:underline",children:Q.get(J.artifactId)||"Unknown Artifact"})]})]}),J.relationships&&J.relationships.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Relationships"}),(0,l.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:J.relationships.map(e=>(0,l.jsxs)("li",{className:"text-sm",children:[(0,l.jsx)("span",{className:"capitalize",children:e.type})," ",(0,l.jsx)("span",{className:"font-semibold text-accent",children:K.get(e.targetEntityId)||"Unknown Entity"})]},e.id))})]})]}),J.tags&&J.tags.length>0&&(0,l.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:J.tags.map(e=>(0,l.jsx)("button",{onClick:s=>p({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,l.jsx)(R.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]})}),(0,l.jsx)(w.wL,{children:(0,l.jsxs)(C.Lt,{children:[(0,l.jsx)(C.tv,{asChild:!0,children:(0,l.jsx)(r.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(F.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(C.EO,{children:[(0,l.jsxs)(C.wd,{children:[(0,l.jsx)(C.r7,{children:"Are you sure?"}),(0,l.jsxs)(C.$v,{children:['This will permanently delete "',J.name,'".']})]}),(0,l.jsxs)(C.ck,{children:[(0,l.jsx)(C.Zr,{children:"Cancel"}),(0,l.jsx)(C.Rx,{onClick:er,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})})}return(0,l.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)(w.Zp,{children:(0,l.jsx)(S.lV,{...X,children:(0,l.jsxs)("form",{onSubmit:X.handleSubmit(en),className:"space-y-6",children:[(0,l.jsx)(w.aR,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[H&&m&&(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:ei,className:"shrink-0 -ml-2",children:(0,l.jsx)(k.A,{className:"h-5 w-5"})}),(0,l.jsx)("div",{children:(0,l.jsx)(w.ZB,{children:t?"Create New Entity":"Editing: ".concat(X.getValues("name")||"...")})})]}),!H&&(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:ei,className:"text-muted-foreground hover:text-foreground",children:(0,l.jsx)(I.A,{className:"h-5 w-5"})})]})}),(0,l.jsxs)(w.Wu,{className:"space-y-6",children:[(0,l.jsx)(S.zB,{name:"name",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Name"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(n.p,{...s})}),(0,l.jsx)(S.C5,{})]})}}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(S.zB,{name:"entityType",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Entity Type"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(n.p,{...s,placeholder:"e.g., God, Titan..."})})]})}}),(0,l.jsx)(S.zB,{name:"domain",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Domain"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(n.p,{...s,placeholder:"e.g., War, Oceans..."})})]})}})]}),(0,l.jsx)(S.zB,{name:"symbols",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Symbols"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(n.p,{...s})})]})}}),(0,l.jsx)(S.zB,{name:"followers",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Followers"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(n.p,{...s})})]})}}),(0,l.jsx)(S.zB,{name:"goal",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Goal"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(b.T,{...s,rows:2})})]})}}),(0,l.jsx)(S.zB,{name:"lore",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsx)(S.lR,{children:"Lore"}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(b.T,{...s,rows:5})})]})}}),(0,l.jsx)(S.zB,{name:"tags",control:Y,render:e=>{let{field:s}=e;return(0,l.jsxs)(S.eI,{children:[(0,l.jsxs)(S.lR,{className:"flex items-center gap-2",children:[(0,l.jsx)(T.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,l.jsx)(S.MJ,{children:(0,l.jsx)(f.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"pantheon"})}),(0,l.jsx)(S.C5,{})]})}}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(u.J,{children:"Artifact"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:ec?(0,l.jsxs)("div",{className:"flex-1 flex items-center justify-between rounded-md border p-2",children:[(0,l.jsx)("p",{className:"font-semibold",children:Q.get(ec)}),(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>es("artifactId",void 0),children:(0,l.jsx)(I.A,{className:"h-4 w-4"})})]}):(0,l.jsx)(U,{onSelect:e=>es("artifactId",e),allArtifacts:_,children:(0,l.jsxs)(r.$,{type:"button",variant:"outline",className:"w-full",children:[(0,l.jsx)($.A,{className:"h-4 w-4 mr-2"}),"Select Artifact"]})})})]}),(0,l.jsx)(d.w,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Relationships"}),(0,l.jsx)(q,{currentEntityId:s,allEntities:O,onAdd:el})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[et.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded-lg bg-card-foreground/5",children:[(0,l.jsxs)("p",{className:"flex-1",children:[(0,l.jsx)("span",{className:"capitalize",children:e.type})," ",(0,l.jsx)("span",{className:"font-semibold text-accent",children:K.get(e.targetEntityId)||"..."})]}),(0,l.jsx)(r.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ea(s),className:"text-muted-foreground hover:text-destructive shrink-0",children:(0,l.jsx)(F.A,{className:"h-4 w-4"})})]},e.id)),0===et.length&&(0,l.jsx)("p",{className:"text-muted-foreground text-center text-sm py-2",children:"No relationships defined."})]})]})]}),(0,l.jsxs)(w.wL,{className:"flex items-center gap-2",children:[!t&&(0,l.jsxs)(C.Lt,{children:[(0,l.jsx)(C.tv,{asChild:!0,children:(0,l.jsx)(r.$,{type:"button",variant:"destructive",size:"sm",children:(0,l.jsx)(F.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(C.EO,{children:[(0,l.jsxs)(C.wd,{children:[(0,l.jsx)(C.r7,{children:"Are you sure?"}),(0,l.jsxs)(C.$v,{children:['This will permanently delete "',X.getValues("name"),'".']})]}),(0,l.jsxs)(C.ck,{children:[(0,l.jsx)(C.Zr,{children:"Cancel"}),(0,l.jsx)(C.Rx,{onClick:er,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,l.jsx)("div",{className:"flex-grow"}),!H&&(0,l.jsx)(r.$,{type:"button",variant:"outline",onClick:ei,children:"Cancel"}),(0,l.jsx)(r.$,{type:"submit",children:t?"Create Entity":"Save Changes"})]})]})})})})}var P=t(99982),H=t(20031);function K(){let[e,s]=(0,a.useState)(null),[t,i]=(0,a.useState)(!1),[n,r]=(0,a.useState)(0),[c,d]=(0,a.useState)(""),[o,x]=(0,a.useState)(""),[h,m]=(0,a.useState)("name"),[j,u]=(0,a.useState)("asc"),[p,f]=(0,a.useState)(!1),N=(0,M.a)(),[y,v]=(0,a.useState)("list");(0,a.useEffect)(()=>{f(!0)},[]);let w={searchTerm:c,tagFilter:o,sortBy:h,sortOrder:j},b={setSearchTerm:d,setTagFilter:x,setSortBy:m,setSortOrder:u},C=(e,s)=>{s.stopPropagation(),x(e.tagFilter||"")},S=()=>{d(""),x(""),m("name"),u("asc")},E=()=>r(e=>e+1),z=e=>{s(e),i(!1),N&&v("editor")},k=()=>{s(null),i(!0),N&&v("editor")},A=e=>{E(),s(e),i(!1),N&&v("editor")},F=()=>{E(),s(null),i(!1),N&&v("list")},I=()=>{t&&(i(!1),s(null),N&&v("list"))};return p?N?(0,l.jsx)(P.A,{showSidebarTrigger:!1,children:(0,l.jsx)("div",{className:"h-full w-full",children:"list"===y?(0,l.jsx)(g,{onSelectEntity:z,onNewEntity:k,selectedEntityId:e,dataVersion:n,filters:w,setFilters:b,onClearFilters:S}):(0,l.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,l.jsx)("div",{className:"p-4 sm:p-6",children:(0,l.jsx)(_,{entityId:e,isCreatingNew:t,onSaveSuccess:A,onDeleteSuccess:F,onEditCancel:I,onBack:()=>{v("list"),s(null),i(!1)},dataVersion:n,onFilterByClick:C},null!=e?e:t?"new":"placeholder")})})})}):(0,l.jsx)(H.SidebarProvider,{children:(0,l.jsx)(P.A,{children:(0,l.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,l.jsx)(H.Bx,{style:{"--sidebar-width":"380px"},children:(0,l.jsx)(g,{onSelectEntity:z,onNewEntity:k,selectedEntityId:e,dataVersion:n,filters:w,setFilters:b,onClearFilters:S})}),(0,l.jsx)(H.sF,{className:"flex-1 overflow-y-auto",children:(0,l.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,l.jsx)(_,{entityId:e,isCreatingNew:t,onSaveSuccess:A,onDeleteSuccess:F,onEditCancel:I,dataVersion:n,onFilterByClick:C},null!=e?e:t?"new":"placeholder")})})]})})}):null}}}]);