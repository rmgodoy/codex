(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[181],{12543:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},13930:(e,s,a)=>{"use strict";a.d(s,{W$:()=>n,kO:()=>i,pT:()=>d,rp:()=>t,wz:()=>c,xy:()=>l});var r=a(82489);let l=async()=>{let e=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).getAll();return new Promise((s,a)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>a(e.error)})},t=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi).get(e);return new Promise((e,a)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>a(s.error)})},n=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi),a=(0,r.$C)(),l={...e,id:a},t=s.add(l);return new Promise((e,s)=>{t.onsuccess=()=>e(a),t.onerror=()=>s(t.error)})},i=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).put(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})},c=async e=>{let s=(await (0,r.Lf)()).transaction(r.qi,"readwrite").objectStore(r.qi).delete(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})},d=async e=>{if(!e||0===e.length)return[];let s=(await (0,r.Lf)()).transaction(r.qi,"readonly").objectStore(r.qi),a=[],l=e.map(e=>new Promise((r,l)=>{let t=s.get(e);t.onsuccess=()=>{t.result&&a.push(t.result),r()},t.onerror=()=>l(t.error)}));return await Promise.all(l),a}},14337:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]])},15599:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},20203:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},23062:(e,s,a)=>{"use strict";a.d(s,{FC:()=>l,GW:()=>r,H1:()=>x,OJ:()=>t,Rb:()=>m,Vx:()=>p,Vz:()=>u,Yh:()=>n,_d:()=>j,ag:()=>i,gG:()=>g,gV:()=>o,qY:()=>d,w$:()=>c,zE:()=>h});let r=["attack","support"],l=["melee","missile","innate","unarmed","spell","item","versatile"],t=["guard","resist","10","special"],n=["potion","powder","oil","bomb"],i=["lesser","greater"],c=["weapon","armor","shield","tool"],d=["crude","normal","fine"],o=["normal","magical","artifact"],m=["melee","missile","spell","unarmed"],h=["d4","d6","d8","d10","d12","d20"],u=["one-handed","two-handed","thrown"],x=["head","chest","arms","legs","outer"],p=["head","chest","arms","legs","outer","shield"],j=["None","Light","Heavy"],g=["d4","d6","d8","d10","d12","d20"]},34301:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},53054:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},54165:(e,s,a)=>{"use strict";a.d(s,{Cf:()=>h,Es:()=>x,L3:()=>p,c7:()=>u,lG:()=>c,rr:()=>j,zM:()=>d});var r=a(95155),l=a(12115),t=a(45821),n=a(25318),i=a(59434);let c=t.bL,d=t.l9,o=t.ZL;t.bm;let m=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.hJ,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l})});m.displayName=t.hJ.displayName;let h=l.forwardRef((e,s)=>{let{className:a,children:l,...c}=e;return(0,r.jsxs)(o,{children:[(0,r.jsx)(m,{}),(0,r.jsxs)(t.UC,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[l,(0,r.jsxs)(t.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=t.UC.displayName;let u=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};u.displayName="DialogHeader";let x=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};x.displayName="DialogFooter";let p=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.hE,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...l})});p.displayName=t.hE.displayName;let j=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.VY,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})});j.displayName=t.VY.displayName},68856:(e,s,a)=>{"use strict";a.d(s,{E:()=>t});var r=a(95155),l=a(59434);function t(e){let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-muted",s),...a})}},70656:(e,s,a)=>{Promise.resolve().then(a.bind(a,73208))},73208:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>U});var r=a(95155),l=a(12115),t=a(62709),n=a(20031),i=a(47906),c=a(82489);let d=async()=>{let e=(await (0,c.Lf)()).transaction(c.TP,"readonly").objectStore(c.TP).getAll();return new Promise((s,a)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>a(e.error)})},o=async e=>{let s=(await (0,c.Lf)()).transaction(c.TP,"readonly").objectStore(c.TP).get(e);return new Promise((e,a)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>a(s.error)})},m=async e=>{let s=(await (0,c.Lf)()).transaction(c.TP,"readwrite").objectStore(c.TP),a=(0,c.$C)(),r={...e,id:a},l=s.add(r);return new Promise((e,s)=>{l.onsuccess=()=>e(a),l.onerror=()=>s(l.error)})},h=async e=>{let s=(await (0,c.Lf)()).transaction(c.TP,"readwrite").objectStore(c.TP).put(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})},u=async e=>{let s=(await (0,c.Lf)()).transaction(c.TP,"readwrite").objectStore(c.TP).delete(e);return new Promise((e,a)=>{s.onsuccess=()=>e(),s.onerror=()=>a(s.error)})};var x=a(23062),p=a(62523),j=a(30285),g=a(66424),f=a(22346),y=a(87481),v=a(34301),w=a(75074),N=a(20203),b=a(73926),C=a(85057),T=a(59409),z=a(90648);function S(e){let{onSelectItem:s,onNewItem:a,selectedItemId:t,dataVersion:n,filters:i,setFilters:c,onClearFilters:o}=e,[m,h]=(0,l.useState)([]),[u,S]=(0,l.useState)(!0),{toast:A}=(0,y.dj)();(0,l.useEffect)(()=>{(async()=>{S(!0);try{h(await d())}catch(e){A({variant:"destructive",title:"Error",description:"Could not fetch items from database."})}finally{S(!1)}})()},[n,A]);let D=(0,l.useMemo)(()=>{let e=m.filter(e=>{let s=e.name.toLowerCase().includes(i.searchTerm.toLowerCase()),a="all"===i.typeFilter||e.type===i.typeFilter,r="all"===i.qualityFilter||e.quality===i.qualityFilter,l="all"===i.magicTierFilter||e.magicTier===i.magicTierFilter,t=!0,n=i.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return n.length>0&&(t=!!e.tags&&n.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&a&&r&&l&&t}),s={crude:0,normal:1,fine:2,magical:3},a=e.sort((e,a)=>{if("quality"===i.sortBy){let r=(s[e.quality]||0)-(s[a.quality]||0);if(0!==r)return r}if("price"===i.sortBy){let s=(e.price||0)-(a.price||0);if(0!==s)return s}if("type"===i.sortBy){let s=e.type.localeCompare(a.type);if(0!==s)return s}return e.name.localeCompare(a.name)});return"desc"===i.sortOrder&&a.reverse(),a},[m,i]);return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)(j.$,{onClick:a,className:"w-full",children:[(0,r.jsx)(v.A,{})," New Item"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(w.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(p.p,{placeholder:"Search items...",value:i.searchTerm,onChange:e=>c.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(C.J,{children:"Filter"}),(0,r.jsx)(j.$,{variant:"ghost",size:"sm",onClick:o,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,r.jsxs)(T.l6,{value:i.typeFilter,onValueChange:c.setTypeFilter,children:[(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{placeholder:"Filter by type"})}),(0,r.jsxs)(T.gC,{children:[(0,r.jsx)(T.eb,{value:"all",children:"All Types"}),x.w$.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,r.jsxs)(T.l6,{value:i.qualityFilter,onValueChange:c.setQualityFilter,children:[(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{placeholder:"Filter by quality"})}),(0,r.jsxs)(T.gC,{children:[(0,r.jsx)(T.eb,{value:"all",children:"All Qualities"}),x.qY.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,r.jsxs)(T.l6,{value:i.magicTierFilter,onValueChange:e=>c.setMagicTierFilter(e),children:[(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{placeholder:"Filter by Tier"})}),(0,r.jsxs)(T.gC,{children:[(0,r.jsx)(T.eb,{value:"all",children:"All Tiers"}),x.gV.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,r.jsx)(z.F,{value:i.tagFilter?i.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>c.setTagFilter(e.join(",")),placeholder:"Tags (e.g. consumable)",tagSource:"item"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(C.J,{children:"Sort by"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(T.l6,{value:i.sortBy,onValueChange:e=>c.setSortBy(e),children:[(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{placeholder:"Sort by"})}),(0,r.jsxs)(T.gC,{children:[(0,r.jsx)(T.eb,{value:"name",children:"Name"}),(0,r.jsx)(T.eb,{value:"type",children:"Type"}),(0,r.jsx)(T.eb,{value:"price",children:"Price"}),(0,r.jsx)(T.eb,{value:"quality",children:"Quality"})]})]}),(0,r.jsxs)(j.$,{variant:"ghost",size:"icon",onClick:()=>c.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===i.sortOrder?(0,r.jsx)(N.A,{className:"h-4 w-4"}):(0,r.jsx)(b.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,r.jsx)(f.w,{}),(0,r.jsx)(g.F,{className:"flex-1",children:(0,r.jsx)("div",{className:"p-4",children:u?(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading items..."}):D.length>0?(0,r.jsx)("ul",{className:"space-y-1",children:D.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(t===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name,(0,r.jsxs)("span",{className:"text-xs opacity-70 capitalize",children:[" (",e.type,"normal"!==e.magicTier?", ".concat(e.magicTier):"",")"]})]})},e.id))}):(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"No items found."})})})]})}var A=a(62177),D=a(90221),I=a(55594),q=a(13930),k=a(44218),R=a(66695),E=a(88539),F=a(90010),M=a(17759),P=a(12543),V=a(15599),B=a(18763),L=a(77223),J=a(25318),$=a(14337),Z=a(53054),O=a(68856),W=a(26126),G=a(54165);let _=I.z.object({name:I.z.string().min(1,"Item name is required"),type:I.z.enum(x.w$),price:I.z.coerce.number().min(0,"Price must be a non-negative number"),quality:I.z.enum(x.qY),description:I.z.string().min(1,"Description is required"),magicTier:I.z.enum(x.gV),enchantment:I.z.string().optional(),assignedDeedId:I.z.string().optional(),magicalTrait:I.z.string().optional(),tags:I.z.array(I.z.string()).optional(),damageDie:I.z.enum(x.zE).optional(),weaponType:I.z.enum(x.Rb).optional(),range:I.z.coerce.number().optional(),property:I.z.enum(x.Vz).optional(),weaponEffect:I.z.string().optional(),placement:I.z.enum(x.Vx).optional(),weight:I.z.enum(x._d).optional(),AR:I.z.string().optional(),armorDie:I.z.enum(x.gG).optional()}).superRefine((e,s)=>{var a,r,l;"weapon"===e.type&&(e.damageDie||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Damage Die is required for weapons.",path:["damageDie"]}),e.weaponType||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Weapon Type is required for weapons.",path:["weaponType"]}),("missile"===e.weaponType||"spell"===e.weaponType)&&(void 0===e.range||e.range<1)&&s.addIssue({code:I.z.ZodIssueCode.custom,message:"Range is required for this weapon type.",path:["range"]}),e.property||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Property is required for weapons.",path:["property"]})),("armor"===e.type||"shield"===e.type)&&(e.placement||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Placement is required.",path:["placement"]}),(null==(l=e.AR)?void 0:l.trim())||s.addIssue({code:I.z.ZodIssueCode.custom,message:"AR is required.",path:["AR"]}),e.armorDie||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Armor Die is required.",path:["armorDie"]})),"armor"===e.type&&"shield"===e.placement&&s.addIssue({code:I.z.ZodIssueCode.custom,message:"Shield placement is for shields only.",path:["placement"]}),"shield"===e.type&&"shield"!==e.placement&&s.addIssue({code:I.z.ZodIssueCode.custom,message:"Shields must have shield placement.",path:["placement"]}),"magical"!==e.magicTier&&"artifact"!==e.magicTier||(null==(a=e.enchantment)?void 0:a.trim())||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Enchantment is required for magical items and artifacts.",path:["enchantment"]}),"artifact"!==e.magicTier||(null==(r=e.magicalTrait)?void 0:r.trim())||s.addIssue({code:I.z.ZodIssueCode.custom,message:"Magical Trait is required for artifacts.",path:["magicalTrait"]})}),H=e=>{let{onSelectDeed:s,allDeeds:a,children:t}=e,[n,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(""),[o,m]=(0,l.useState)("all"),[h,u]=(0,l.useState)(""),x=(0,l.useMemo)(()=>a.filter(e=>{let s=e.name.toLowerCase().includes(c.toLowerCase()),a="all"===o||e.tier===o,r=h.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean),l=0===r.length||e.tags&&r.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)));return s&&a&&l}),[a,c,o,h]),j=e=>{s(e),i(!1)};return(0,r.jsxs)(G.lG,{open:n,onOpenChange:e=>{e||(d(""),m("all"),u("")),i(e)},children:[(0,r.jsx)(G.zM,{asChild:!0,children:t}),(0,r.jsxs)(G.Cf,{className:"sm:max-w-2xl h-[70vh] flex flex-col",children:[(0,r.jsx)(G.c7,{children:(0,r.jsx)(G.L3,{children:"Select a Deed"})}),(0,r.jsxs)("div",{className:"flex gap-2 mb-4 flex-wrap",children:[(0,r.jsx)(p.p,{placeholder:"Search deeds...",value:c,onChange:e=>d(e.target.value),className:"flex-1 min-w-[150px]"}),(0,r.jsxs)(T.l6,{value:o,onValueChange:m,children:[(0,r.jsx)(T.bq,{className:"w-full sm:w-[120px]",children:(0,r.jsx)(T.yv,{placeholder:"Filter tier"})}),(0,r.jsxs)(T.gC,{children:[(0,r.jsx)(T.eb,{value:"all",children:"All Tiers"}),(0,r.jsx)(T.eb,{value:"light",children:"Light"}),(0,r.jsx)(T.eb,{value:"heavy",children:"Heavy"}),(0,r.jsx)(T.eb,{value:"mighty",children:"Mighty"})]})]}),(0,r.jsx)("div",{className:"flex-1 min-w-[150px]",children:(0,r.jsx)(z.F,{value:h?h.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>u(e.join(",")),placeholder:"Filter by tags...",tagSource:"deed"})})]}),(0,r.jsx)(g.F,{className:"flex-1 border rounded-md p-4",children:(0,r.jsx)("div",{className:"space-y-2",children:x.map(e=>(0,r.jsx)("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-accent cursor-pointer",onClick:()=>j(e),children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"font-semibold",children:[e.name," ",(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.tier,")"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.effects.hit})]})},e.id))})})]})]})},Y={name:"",type:"weapon",price:0,quality:"normal",magicTier:"normal",description:"",tags:[],property:"one-handed",weaponType:"melee",damageDie:"d4",AR:"0",armorDie:"d4",weight:"None",placement:"head"};function Q(e){let{itemId:s,isCreatingNew:a,template:t,onSaveSuccess:n,onDeleteSuccess:c,onUseAsTemplate:d,onEditCancel:g,onBack:v}=e,{toast:w}=(0,y.dj)(),[N,b]=(0,l.useState)(a),[S,I]=(0,l.useState)(!a&&!!s),[G,Q]=(0,l.useState)(null),U=(0,i.a)(),[K,X]=(0,l.useState)([]),[ee,es]=(0,l.useState)({}),[ea,er]=(0,l.useState)({}),[el,et]=(0,l.useState)({}),en=(0,l.useMemo)(()=>a&&t?{...Y,...t}:Y,[a,t]),ei=(0,A.mN)({resolver:(0,D.u)(_),defaultValues:en}),{watch:ec,setValue:ed,getValues:eo}=ei,em=ec("type"),eh=ec("weaponType"),eu=ec("magicTier"),ex=(0,l.useRef)(em),ep=ec("assignedDeedId"),[ej,eg]=(0,l.useState)(null);(0,l.useEffect)(()=>{(0,q.xy)().then(X)},[]),(0,l.useEffect)(()=>{ep&&K.length>0?eg(K.find(e=>e.id===ep)||null):eg(null)},[ep,K]),(0,l.useEffect)(()=>{N&&("magical"===eu||"artifact"===eu)&&ed("quality","fine")},[eu,N,ed]),(0,l.useEffect)(()=>{let e=ex.current;if(e===em||!N)return;let s=eo();"weapon"===e?es({damageDie:s.damageDie,weaponType:s.weaponType,range:s.range,property:s.property,weaponEffect:s.weaponEffect}):"armor"===e?er({placement:s.placement,weight:s.weight,AR:s.AR,armorDie:s.armorDie}):"shield"===e&&et({placement:s.placement,weight:s.weight,AR:s.AR,armorDie:s.armorDie}),["damageDie","weaponType","range","property","weaponEffect","placement","weight","AR","armorDie"].forEach(e=>ed(e,void 0)),"weapon"===em?Object.entries(ee).forEach(e=>{let[s,a]=e;return ed(s,a)}):"armor"===em?Object.entries(ea).forEach(e=>{let[s,a]=e;return ed(s,a)}):"shield"===em&&(Object.entries(el).forEach(e=>{let[s,a]=e;return ed(s,a)}),ed("placement","shield",{shouldValidate:!0}),ed("weight","None",{shouldValidate:!0})),ex.current=em},[em,eo,ed,N,ee,ea,el]),(0,l.useEffect)(()=>{(async()=>{if(a){ei.reset(en),t?(Q(t||null),es(t),er(t),et(t)):(es({property:"one-handed",weaponType:"melee",damageDie:"d4"}),er({placement:"head",weight:"None",AR:"0",armorDie:"d4"}),et({placement:"shield",weight:"None",AR:"0",armorDie:"d4"})),ex.current=(null==t?void 0:t.type)||"weapon",b(!0),I(!1);return}if(!s){b(!1),I(!1),Q(null);return}I(!0),b(!1);try{let e=await o(s);e?(ei.reset(e),Q(e),es(e),"armor"===e.type?(er(e),et({})):"shield"===e.type?(et(e),er({})):(er({}),et({})),ex.current=e.type):Q(null)}catch(e){w({variant:"destructive",title:"Error",description:"Could not load item data."})}finally{I(!1)}})()},[s,a,ei,w,en,t]);let ef=()=>{a?g():G&&(ei.reset(G),es(G),"armor"===G.type?(er(G),et({})):"shield"===G.type?(et(G),er({})):(er({}),et({})),ex.current=G.type,b(!1))},ey=async e=>{try{let r,l={name:e.name,type:e.type,price:e.price,quality:e.quality,description:e.description,magicTier:e.magicTier,tags:e.tags||[]};switch(e.type){case"weapon":l.damageDie=e.damageDie,l.weaponType=e.weaponType,l.range=e.range,l.property=e.property,l.weaponEffect=e.weaponEffect;break;case"armor":case"shield":l.placement=e.placement,l.weight=e.weight,l.AR=e.AR,l.armorDie=e.armorDie}("magical"===e.magicTier||"artifact"===e.magicTier)&&(l.enchantment=e.enchantment),"artifact"===e.magicTier&&(l.assignedDeedId=e.assignedDeedId,l.magicalTrait=e.magicalTrait);let t=e.tags||[];if(t.length>0&&await (0,k.JE)(t,"item"),a)r=await m(l),w({title:"Item Created!",description:"".concat(e.name," has been added.")});else{if(!s)return;r=s,await h({...l,id:s}),w({title:"Save Successful",description:"".concat(e.name," has been updated.")})}n(r),b(!1)}catch(e){w({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},ev=async()=>{if(s)try{await u(s),w({title:"Item Deleted",description:"The item has been removed."}),c()}catch(e){w({variant:"destructive",title:"Deletion Failed",description:"Could not delete the item."})}};if(S)return(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(R.Zp,{children:[(0,r.jsx)(R.aR,{children:(0,r.jsx)(O.E,{className:"h-8 w-48"})}),(0,r.jsx)(R.Wu,{children:(0,r.jsx)(O.E,{className:"h-40 w-full"})})]})});if(!s&&!a)return(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(R.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,r.jsx)(R.Wu,{className:"text-center pt-6",children:(0,r.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select an item to view or create a new one."})})})});let ew=e=>{ed("assignedDeedId",e.id,{shouldValidate:!0})};return!N&&G?(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsxs)(R.Zp,{children:[(0,r.jsx)(R.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[U&&v&&(0,r.jsx)(j.$,{variant:"ghost",size:"icon",onClick:v,className:"shrink-0 -ml-2 -mt-1",children:(0,r.jsx)(P.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(R.ZB,{className:"text-3xl font-bold",children:G.name}),(0,r.jsxs)(R.BT,{className:"capitalize flex flex-wrap gap-x-4",children:[(0,r.jsxs)("span",{children:[G.magicTier," ",G.type]}),(0,r.jsxs)("span",{children:["Quality: ",G.quality]}),(0,r.jsxs)("span",{children:["Price: ",G.price,"gp"]})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(j.$,{variant:"outline",size:"sm",onClick:()=>{G&&d(G)},children:[(0,r.jsx)(V.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Template"})]}),(0,r.jsxs)(j.$,{variant:"outline",size:"sm",onClick:()=>b(!0),children:[(0,r.jsx)(B.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"hidden sm:inline ml-2",children:"Edit"})]})]})]})}),(0,r.jsx)(R.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(()=>{let e;if(!G)return null;switch(G.type){case"weapon":let s=("missile"===G.weaponType||"spell"===G.weaponType)&&G.range?"".concat(G.weaponType," (").concat(G.range,")"):G.weaponType;e=(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"Weapon Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Damage:"})," ",G.damageDie]}),(0,r.jsxs)("div",{className:"capitalize",children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Type:"})," ",s]}),(0,r.jsxs)("div",{className:"capitalize",children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Property:"})," ",G.property]})]}),G.weaponEffect&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Effect:"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:G.weaponEffect})]})]});break;case"armor":case"shield":e=(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"Armor/Shield Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Placement:"})," ",G.placement]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Weight:"})," ",G.weight]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"AR:"})," ",G.AR]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Armor Die:"})," ",G.armorDie]})]})]});break;default:e=null}let a=G.assignedDeedId?K.find(e=>e.id===G.assignedDeedId):null;return(0,r.jsxs)(r.Fragment,{children:[G.description&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"Description"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:G.description})]}),e&&(0,r.jsx)(f.w,{}),e,("magical"===G.magicTier||"artifact"===G.magicTier)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.w,{}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-md font-semibold text-primary-foreground",children:"magical"===G.magicTier?"Magical Properties":"Artifact Properties"}),G.enchantment&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Enchantment:"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:G.enchantment})]}),"artifact"===G.magicTier&&G.magicalTrait&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Magical Trait:"}),(0,r.jsx)("p",{className:"text-foreground/80 whitespace-pre-wrap",children:G.magicalTrait})]}),a&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-muted-foreground",children:"Granted Deed:"}),(0,r.jsx)("p",{className:"text-accent",children:a.name})]})]})]})]})})(),G.tags&&G.tags.length>0&&(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:G.tags.map(e=>(0,r.jsx)(W.E,{variant:"secondary",children:e},e))})})]})}),(0,r.jsx)(R.wL,{children:(0,r.jsxs)(F.Lt,{children:[(0,r.jsx)(F.tv,{asChild:!0,children:(0,r.jsx)(j.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(L.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(F.EO,{children:[(0,r.jsxs)(F.wd,{children:[(0,r.jsx)(F.r7,{children:"Are you sure?"}),(0,r.jsxs)(F.$v,{children:['This will permanently delete "',G.name,'".']})]}),(0,r.jsxs)(F.ck,{children:[(0,r.jsx)(F.Zr,{children:"Cancel"}),(0,r.jsx)(F.Rx,{onClick:ev,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,r.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,r.jsx)(R.Zp,{children:(0,r.jsx)(M.lV,{...ei,children:(0,r.jsxs)("form",{onSubmit:ei.handleSubmit(ey),className:"space-y-6",children:[(0,r.jsx)(R.aR,{children:(0,r.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[U&&v&&(0,r.jsx)(j.$,{type:"button",variant:"ghost",size:"icon",onClick:g,className:"shrink-0 -ml-2",children:(0,r.jsx)(P.A,{className:"h-5 w-5"})}),(0,r.jsx)(R.ZB,{children:a?"Create New Item":"Editing: ".concat(ei.getValues("name")||"...")})]}),!U&&(0,r.jsx)(j.$,{type:"button",variant:"ghost",size:"icon",onClick:ef,className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(J.A,{className:"h-5 w-5"})})]})}),(0,r.jsxs)(R.Wu,{className:"space-y-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Base Properties"}),(0,r.jsx)(M.zB,{name:"name",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Item Name"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(p.p,{...s})}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"description",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Description"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(E.T,{...a,value:null!=(s=a.value)?s:"",rows:4})}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)(M.zB,{name:"type",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Type"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.w$.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"magicTier",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Tier"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.gV.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"quality",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Quality"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,disabled:"normal"!==eu,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.qY.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"price",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Price (gp)"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(p.p,{type:"number",...a,value:null!=(s=a.value)?s:""})}),(0,r.jsx)(M.C5,{})]})}})]}),(()=>{switch(em){case"weapon":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.w,{}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Weapon Properties"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[(0,r.jsx)(M.zB,{name:"damageDie",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Damage Die"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.zE.map(e=>(0,r.jsx)(T.eb,{value:e,children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"weaponType",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Weapon Type"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.Rb.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),("missile"===eh||"spell"===eh)&&(0,r.jsx)(M.zB,{name:"range",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Range"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(p.p,{type:"number",...a,value:null!=(s=a.value)?s:"",placeholder:"e.g., 30"})}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"property",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Property"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.Vz.map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}})]}),(0,r.jsx)(M.zB,{name:"weaponEffect",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Weapon Effect"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(E.T,{...a,value:null!=(s=a.value)?s:"",rows:3})})]})}})]});case"armor":case"shield":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.w,{}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Armor/Shield Properties"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)(M.zB,{name:"placement",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Placement"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,disabled:"shield"===em,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:("shield"===em?["shield"]:x.H1).map(e=>(0,r.jsx)(T.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"weight",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Weight"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,disabled:"shield"===em,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x._d.map(e=>(0,r.jsx)(T.eb,{value:e,children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"AR",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"AR"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(p.p,{...a,value:null!=(s=a.value)?s:"",placeholder:"e.g., +1"})}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsx)(M.zB,{name:"armorDie",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Armor Die"}),(0,r.jsxs)(T.l6,{onValueChange:s.onChange,value:s.value,children:[(0,r.jsx)(M.MJ,{children:(0,r.jsx)(T.bq,{children:(0,r.jsx)(T.yv,{})})}),(0,r.jsx)(T.gC,{children:x.gG.map(e=>(0,r.jsx)(T.eb,{value:e,children:e},e))})]}),(0,r.jsx)(M.C5,{})]})}})]})]});default:return null}})(),("magical"===eu||"artifact"===eu)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.w,{}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-foreground",children:"Magical Properties"}),(0,r.jsx)(M.zB,{name:"enchantment",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Enchantment"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(E.T,{...a,value:null!=(s=a.value)?s:"",rows:4})}),(0,r.jsx)(M.C5,{})]})}})]}),"artifact"===eu&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.zB,{name:"magicalTrait",control:ei.control,render:e=>{var s;let{field:a}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsx)(M.lR,{children:"Magical Trait"}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(E.T,{...a,value:null!=(s=a.value)?s:"",rows:2})}),(0,r.jsx)(M.C5,{})]})}}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(C.J,{children:"Granted Deed"}),ej?(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-3",children:[(0,r.jsxs)("p",{className:"font-semibold",children:[ej.name," ",(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",ej.tier,")"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(H,{onSelectDeed:ew,allDeeds:K,children:(0,r.jsx)(j.$,{type:"button",variant:"outline",size:"sm",children:"Change"})}),(0,r.jsx)(j.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>{ed("assignedDeedId",void 0,{shouldValidate:!0})},children:(0,r.jsx)(J.A,{className:"h-4 w-4"})})]})]}):(0,r.jsx)(H,{onSelectDeed:ew,allDeeds:K,children:(0,r.jsxs)(j.$,{type:"button",variant:"outline",size:"sm",className:"w-full",children:[(0,r.jsx)($.A,{className:"h-4 w-4 mr-2"}),"Select a Deed"]})}),(0,r.jsx)(M.zB,{name:"assignedDeedId",control:ei.control,render:()=>(0,r.jsx)(M.C5,{})})]})]}),(0,r.jsx)(f.w,{}),(0,r.jsx)(M.zB,{name:"tags",control:ei.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(M.eI,{children:[(0,r.jsxs)(M.lR,{className:"flex items-center gap-2",children:[(0,r.jsx)(Z.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,r.jsx)(M.MJ,{children:(0,r.jsx)(z.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"item"})}),(0,r.jsx)(M.C5,{})]})}})]}),(0,r.jsxs)(R.wL,{className:"flex items-center gap-2",children:[!a&&(0,r.jsxs)(F.Lt,{children:[(0,r.jsx)(F.tv,{asChild:!0,children:(0,r.jsx)(j.$,{type:"button",variant:"destructive",size:"sm",children:(0,r.jsx)(L.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(F.EO,{children:[(0,r.jsxs)(F.wd,{children:[(0,r.jsx)(F.r7,{children:"Are you sure?"}),(0,r.jsxs)(F.$v,{children:['This will permanently delete "',ei.getValues("name"),'".']})]}),(0,r.jsxs)(F.ck,{children:[(0,r.jsx)(F.Zr,{children:"Cancel"}),(0,r.jsx)(F.Rx,{onClick:ev,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,r.jsx)("div",{className:"flex-grow"}),!U&&(0,r.jsx)(j.$,{type:"button",variant:"outline",onClick:ef,children:"Cancel"}),(0,r.jsx)(j.$,{type:"submit",children:a?"Create Item":"Save Changes"})]})]})})})})}function U(){let[e,s]=(0,l.useState)(null),[a,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(null),[m,h]=(0,l.useState)(0),[u,x]=(0,l.useState)(""),[p,j]=(0,l.useState)("all"),[g,f]=(0,l.useState)("all"),[y,v]=(0,l.useState)("all"),[w,N]=(0,l.useState)(""),[b,C]=(0,l.useState)("name"),[T,z]=(0,l.useState)("asc"),[A,D]=(0,l.useState)(!1),I=(0,i.a)(),[q,k]=(0,l.useState)("list");(0,l.useEffect)(()=>{D(!0)},[]);let R={searchTerm:u,typeFilter:p,qualityFilter:g,magicTierFilter:y,tagFilter:w,sortBy:b,sortOrder:T},E={setSearchTerm:x,setTypeFilter:j,setQualityFilter:f,setMagicTierFilter:v,setTagFilter:N,setSortBy:C,setSortOrder:z},F=()=>{x(""),j("all"),f("all"),v("all"),N(""),C("name"),z("asc")},M=()=>h(e=>e+1),P=e=>{s(e),c(!1),o(null),I&&k("editor")},V=()=>{s(null),c(!0),o(null),I&&k("editor")},B=e=>{let a={...e},r=(e.name||"item").replace(/^(Copy of\s*)+/,"");a.name="Copy of ".concat(r),delete a.id,s(null),c(!0),o(a),I&&k("editor")},L=e=>{M(),s(e),c(!1),o(null),I&&k("editor")},J=()=>{M(),s(null),c(!1),o(null),I&&k("list")},$=()=>{a&&(c(!1),s(null),I&&k("list"))};return A?I?(0,r.jsx)(t.A,{showSidebarTrigger:!1,children:(0,r.jsx)("div",{className:"h-full w-full",children:"list"===q?(0,r.jsx)(S,{onSelectItem:P,onNewItem:V,selectedItemId:e,dataVersion:m,filters:R,setFilters:E,onClearFilters:F}):(0,r.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,r.jsx)("div",{className:"p-4 sm:p-6",children:(0,r.jsx)(Q,{itemId:e,isCreatingNew:a,template:d,onSaveSuccess:L,onDeleteSuccess:J,onUseAsTemplate:B,onEditCancel:$,onBack:()=>{k("list"),s(null),c(!1),o(null)}},null!=e?e:a?"new":"placeholder")})})})}):(0,r.jsx)(n.GB,{children:(0,r.jsx)(t.A,{children:(0,r.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,r.jsx)(n.Bx,{style:{"--sidebar-width":"380px"},children:(0,r.jsx)(S,{onSelectItem:P,onNewItem:V,selectedItemId:e,dataVersion:m,filters:R,setFilters:E,onClearFilters:F})}),(0,r.jsx)(n.sF,{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,r.jsx)(Q,{itemId:e,isCreatingNew:a,template:d,onSaveSuccess:L,onDeleteSuccess:J,onUseAsTemplate:B,onEditCancel:$},null!=e?e:a?"new":"placeholder")})})]})})}):null}},73926:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},75074:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(40157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[222,194,160,49,347,516,441,684,358],()=>s(70656)),_N_E=e.O()}]);