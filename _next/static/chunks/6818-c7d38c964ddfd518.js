"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6818],{46818:(e,s,l)=>{l.r(s),l.d(s,{default:()=>H});var t=l(95155),a=l(12115),r=l(15019),n=l(23062),i=l(62523),c=l(30285),d=l(66424),o=l(22346),h=l(87481),x=l(34301),j=l(75074),u=l(9572),m=l(20203),p=l(73926),g=l(59409),f=l(85057),v=l(90648),y=l(8643);function N(e){let{onSelectDeed:s,onNewDeed:l,selectedDeedId:N,dataVersion:w,filters:b,setFilters:C,onClearFilters:F}=e,[T,S]=(0,a.useState)([]),[z,k]=(0,a.useState)(!0),{toast:B}=(0,h.dj)();(0,a.useEffect)(()=>{(async()=>{k(!0);try{let e=await (0,r.xy)();S(e)}catch(e){console.error("Error fetching deeds:",e),B({variant:"destructive",title:"Error",description:"Could not fetch deeds from database."})}finally{k(!1)}})()},[w,B]);let A=(0,a.useMemo)(()=>{let e=T.filter(e=>{let s=e.name.toLowerCase().includes(b.searchTerm.toLowerCase()),l="all"===b.tierFilter||e.tier===b.tierFilter,t="all"===b.deedTypeFilter||e.deedType===b.deedTypeFilter,a="all"===b.actionTypeFilter||e.actionType===b.actionTypeFilter,r="all"===b.versusFilter||e.versus===b.versusFilter,n=!0,i=b.tagFilter.toLowerCase().split(",").map(e=>e.trim()).filter(Boolean);return i.length>0&&(n=!!e.tags&&i.every(s=>e.tags.some(e=>e.toLowerCase().includes(s)))),s&&l&&t&&a&&r&&n}),s={light:1,heavy:2,mighty:3,tyrant:4,special:5},l=e.sort((e,l)=>{if("tier"===b.sortBy){let t=(s[e.tier]||0)-(s[l.tier]||0);if(0!==t)return t}return e.name.localeCompare(l.name)});return"desc"===b.sortOrder&&l.reverse(),l},[T,b]);return(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)(c.$,{onClick:l,className:"w-full",children:[(0,t.jsx)(x.A,{})," New Deed"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(i.p,{placeholder:"Search deeds...",value:b.searchTerm,onChange:e=>C.setSearchTerm(e.target.value),className:"pl-9"})]}),(0,t.jsxs)(y.Nt,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(y.R6,{asChild:!0,children:(0,t.jsxs)(c.$,{variant:"ghost",className:"-ml-2",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Filters"]})}),(0,t.jsx)(c.$,{variant:"ghost",size:"sm",onClick:F,className:"text-xs h-auto p-1",children:"Clear"})]}),(0,t.jsxs)(y.Ke,{className:"space-y-2 pt-2",children:[(0,t.jsxs)(g.l6,{value:b.tierFilter,onValueChange:C.setTierFilter,children:[(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Filter by tier"})}),(0,t.jsxs)(g.gC,{children:[(0,t.jsx)(g.eb,{value:"all",children:"All Tiers"}),(0,t.jsx)(g.eb,{value:"light",children:"Light"}),(0,t.jsx)(g.eb,{value:"heavy",children:"Heavy"}),(0,t.jsx)(g.eb,{value:"mighty",children:"Mighty"}),(0,t.jsx)(g.eb,{value:"tyrant",children:"Tyrant"}),(0,t.jsx)(g.eb,{value:"special",children:"Special"})]})]}),(0,t.jsxs)(g.l6,{value:b.deedTypeFilter,onValueChange:C.setDeedTypeFilter,children:[(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Filter by deed type"})}),(0,t.jsxs)(g.gC,{children:[(0,t.jsx)(g.eb,{value:"all",children:"All Deed Types"}),n.FC.map(e=>(0,t.jsx)(g.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,t.jsxs)(g.l6,{value:b.actionTypeFilter,onValueChange:C.setActionTypeFilter,children:[(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Filter by action type"})}),(0,t.jsxs)(g.gC,{children:[(0,t.jsx)(g.eb,{value:"all",children:"All Action Types"}),n.GW.map(e=>(0,t.jsx)(g.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,t.jsxs)(g.l6,{value:b.versusFilter,onValueChange:C.setVersusFilter,children:[(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Filter by versus"})}),(0,t.jsxs)(g.gC,{children:[(0,t.jsx)(g.eb,{value:"all",children:"All Versus Types"}),n.OJ.map(e=>(0,t.jsx)(g.eb,{value:e,className:"capitalize",children:e},e))]})]}),(0,t.jsx)(v.F,{value:b.tagFilter?b.tagFilter.split(",").map(e=>e.trim()).filter(Boolean):[],onChange:e=>C.setTagFilter(e.join(",")),placeholder:"Tags (e.g. fire, control)",tagSource:"deed"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.J,{children:"Sort by"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(g.l6,{value:b.sortBy,onValueChange:e=>C.setSortBy(e),children:[(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Sort by"})}),(0,t.jsxs)(g.gC,{children:[(0,t.jsx)(g.eb,{value:"name",children:"Name"}),(0,t.jsx)(g.eb,{value:"tier",children:"Tier"})]})]}),(0,t.jsxs)(c.$,{variant:"ghost",size:"icon",onClick:()=>C.setSortOrder(e=>"asc"===e?"desc":"asc"),children:["asc"===b.sortOrder?(0,t.jsx)(m.A,{className:"h-4 w-4"}):(0,t.jsx)(p.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle sort order"})]})]})]})]}),(0,t.jsx)(o.w,{}),(0,t.jsx)(d.F,{className:"flex-1",children:(0,t.jsx)("div",{className:"p-4",children:z?(0,t.jsx)("p",{className:"text-muted-foreground text-center",children:"Loading deeds..."}):A.length>0?(0,t.jsx)("ul",{className:"space-y-1",children:A.map(e=>(0,t.jsx)("li",{children:(0,t.jsxs)("button",{onClick:()=>s(e.id),className:"w-full text-left p-2 rounded-md transition-colors ".concat(N===e.id?"bg-primary text-primary-foreground":"hover:bg-accent/50"),children:[e.name," ",(0,t.jsxs)("span",{className:"text-xs opacity-70",children:["(",e.tier,")"]})]})},e.id))}):(0,t.jsx)("p",{className:"text-muted-foreground text-center",children:"No deeds found."})})})]})}var w=l(62177),b=l(90221),C=l(55594),F=l(66695),T=l(88539),S=l(90010),z=l(17759),k=l(12543),B=l(15599),A=l(18763),D=l(77223),E=l(25318),V=l(53054),R=l(68856),I=l(88911),J=l(26126),M=l(47906);let $=C.z.object({start:C.z.string().optional(),base:C.z.string().optional(),hit:C.z.string().optional(),spark:C.z.string().optional(),shadow:C.z.string().optional(),after:C.z.string().optional()}),O=C.z.object({name:C.z.string().min(1,"Deed name is required"),tier:C.z.enum(["light","heavy","mighty","tyrant","special"]),actionType:C.z.enum(n.GW),deedType:C.z.enum(n.FC),versus:C.z.enum(n.OJ),target:C.z.string().optional(),effects:$,tags:C.z.array(C.z.string()).optional()}),L={name:"",tier:"light",actionType:"attack",deedType:"melee",versus:"guard",target:"",effects:{start:"",base:"",hit:"",spark:"",shadow:"",after:""},tags:[]};function q(e){let{deedId:s,isCreatingNew:l,template:d,onDeedSaveSuccess:x,onDeedDeleteSuccess:j,onUseAsTemplate:u,onEditCancel:m,dataVersion:p,onFilterByClick:f,onBack:y}=e,{toast:N}=(0,h.dj)(),[C,$]=(0,a.useState)(l),[q,W]=(0,a.useState)(!l&&!!s),[Z,H]=(0,a.useState)(null),_=(0,M.a)(),G=(0,w.mN)({resolver:(0,b.u)(O),defaultValues:d||L});(0,a.useEffect)(()=>{(async()=>{if(l){G.reset(d?{...d,tags:d.tags||[]}:L),H(d||null),$(!0),W(!1);return}if(!s){$(!1),W(!1),H(null);return}W(!0),$(!1);try{let e=await (0,r.rp)(s);if(e){let s={...e,tags:e.tags||[]};G.reset(s),H(e)}else H(null)}catch(e){console.error("Failed to fetch deed data:",e),N({variant:"destructive",title:"Error",description:"Could not load deed data."})}finally{W(!1)}})()},[s,l,d,G,N,p]);let K=()=>{if(l)m();else if(Z){let e={...Z,tags:Z.tags||[]};G.reset(e),$(!1)}},P=async e=>{try{let t={...e,tags:e.tags||[]},a=e.tags||[];if(a.length>0&&await (0,r.JE)(a,"deed"),l){let s=await (0,r.W$)(t);N({title:"Deed Created!",description:"".concat(e.name," has been added to the library.")}),x(s)}else s&&(await (0,r.kO)({...t,id:s}),N({title:"Save Successful",description:"".concat(e.name," has been updated.")}),x(s));$(!1)}catch(e){console.error("Failed to save deed:",e),N({variant:"destructive",title:"Save Failed",description:"Could not save changes."})}},U=async()=>{if(s)try{await (0,r.wz)(s),N({title:"Deed Deleted",description:"The deed has been removed from the library."}),j()}catch(e){console.error("Failed to delete deed:",e),N({variant:"destructive",title:"Deletion Failed",description:"Could not delete the deed."})}};return q?(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsxs)(F.Zp,{children:[(0,t.jsxs)(F.aR,{children:[(0,t.jsx)(R.E,{className:"h-8 w-48"}),(0,t.jsx)(R.E,{className:"h-4 w-32"})]}),(0,t.jsxs)(F.Wu,{className:"space-y-6",children:[(0,t.jsx)(R.E,{className:"h-10 w-full"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(R.E,{className:"h-10 w-full"}),(0,t.jsx)(R.E,{className:"h-10 w-full"})]}),(0,t.jsx)(o.w,{}),(0,t.jsx)(R.E,{className:"h-20 w-full"}),(0,t.jsx)(R.E,{className:"h-20 w-full"}),(0,t.jsx)(R.E,{className:"h-20 w-full"})]})]})}):s||l?!C&&Z?(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsxs)(F.Zp,{children:[(0,t.jsx)(F.aR,{children:(0,t.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[_&&y&&(0,t.jsx)(c.$,{variant:"ghost",size:"icon",onClick:y,className:"-ml-4 -mt-2",children:(0,t.jsx)(k.A,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(F.ZB,{className:"text-3xl font-bold",children:Z.name}),(0,t.jsx)(F.BT,{className:"mt-1 capitalize",children:(0,t.jsx)("button",{onClick:e=>f({tierFilter:Z.tier},e),className:"hover:underline p-0 bg-transparent text-inherit",children:Z.tier})})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{Z&&u(Z)},children:[(0,t.jsx)(B.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Template"})]}),(0,t.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>$(!0),children:[(0,t.jsx)(A.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Edit"})]})]})]})}),(0,t.jsxs)(F.Wu,{children:[(0,t.jsx)(I.P,{deed:Z}),Z.tags&&Z.tags.length>0&&(0,t.jsx)("div",{className:"mt-4 pt-3 border-t border-border/50",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:Z.tags.map(e=>(0,t.jsx)("button",{onClick:s=>f({tagFilter:e},s),className:"bg-transparent border-none p-0 m-0",children:(0,t.jsx)(J.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",children:e})},e))})})]}),(0,t.jsx)(F.wL,{children:(0,t.jsxs)(S.Lt,{children:[(0,t.jsx)(S.tv,{asChild:!0,children:(0,t.jsx)(c.$,{type:"button",variant:"destructive",size:"sm",children:(0,t.jsx)(D.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(S.EO,{children:[(0,t.jsxs)(S.wd,{children:[(0,t.jsx)(S.r7,{children:"Are you sure?"}),(0,t.jsxs)(S.$v,{children:['This will permanently delete "',G.getValues("name"),'". This action cannot be undone.']})]}),(0,t.jsxs)(S.ck,{children:[(0,t.jsx)(S.Zr,{children:"Cancel"}),(0,t.jsx)(S.Rx,{onClick:U,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})})]})}):(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsx)(F.Zp,{children:(0,t.jsx)(z.lV,{...G,children:(0,t.jsxs)("form",{onSubmit:G.handleSubmit(P),className:"space-y-6",children:[(0,t.jsx)(F.aR,{children:(0,t.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[_&&y&&(0,t.jsx)(c.$,{type:"button",variant:"ghost",size:"icon",onClick:K,className:"-ml-4",children:(0,t.jsx)(k.A,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(F.ZB,{children:l?_?"New Deed":"Create a New Deed":"Editing: ".concat(G.getValues("name")||"...")}),(0,t.jsx)(F.BT,{children:l?"Fill out the details for your new deed.":"Make your changes and click Save."})]})]}),!_&&(0,t.jsx)(c.$,{type:"button",variant:"ghost",size:"icon",onClick:K,className:"text-muted-foreground hover:text-foreground",children:(0,t.jsx)(E.A,{className:"h-5 w-5"})})]})}),(0,t.jsxs)(F.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(z.zB,{name:"name",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Deed Name"}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(i.p,{placeholder:"e.g., Inferno",...s})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{name:"tier",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Tier"}),(0,t.jsxs)(g.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(z.MJ,{children:(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Select tier"})})}),(0,t.jsxs)(g.gC,{children:[(0,t.jsx)(g.eb,{value:"light",children:"Light"}),(0,t.jsx)(g.eb,{value:"heavy",children:"Heavy"}),(0,t.jsx)(g.eb,{value:"mighty",children:"Mighty"}),(0,t.jsx)(g.eb,{value:"tyrant",children:"Tyrant"}),(0,t.jsx)(g.eb,{value:"special",children:"Special"})]})]}),(0,t.jsx)(z.C5,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(z.zB,{name:"deedType",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Deed Type"}),(0,t.jsxs)(g.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(z.MJ,{children:(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Select deed type"})})}),(0,t.jsx)(g.gC,{children:n.FC.map(e=>(0,t.jsx)(g.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{name:"actionType",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Action Type"}),(0,t.jsxs)(g.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(z.MJ,{children:(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Select action type"})})}),(0,t.jsx)(g.gC,{children:n.GW.map(e=>(0,t.jsx)(g.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{name:"versus",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Versus"}),(0,t.jsxs)(g.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(z.MJ,{children:(0,t.jsx)(g.bq,{children:(0,t.jsx)(g.yv,{placeholder:"Select versus"})})}),(0,t.jsx)(g.gC,{children:n.OJ.map(e=>(0,t.jsx)(g.eb,{value:e,className:"capitalize",children:e},e))})]}),(0,t.jsx)(z.C5,{})]})}})]}),(0,t.jsx)(z.zB,{name:"target",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Target"}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(i.p,{placeholder:"e.g., 1 Creature | Blast 4",...s})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{name:"tags",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{className:"flex items-center gap-2",children:[(0,t.jsx)(V.A,{className:"h-4 w-4 text-accent"}),"Tags"]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(v.F,{value:s.value||[],onChange:s.onChange,placeholder:"Add tags...",tagSource:"deed"})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(o.w,{}),(0,t.jsx)("h4",{className:"font-semibold text-primary-foreground",children:"Effects"}),(0,t.jsx)(z.zB,{name:"effects.start",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["Start ",(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(T.T,{placeholder:"Effect when a creature starts its turn in an area...",...s,rows:2})})]})}}),(0,t.jsx)(z.zB,{name:"effects.base",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["Base ",(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(T.T,{placeholder:"Base effect of the deed...",...s,rows:2})})]})}}),(0,t.jsx)(z.zB,{name:"effects.hit",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["Hit ",(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(T.T,{placeholder:"The primary effect on a successful hit...",...s,rows:3})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{name:"effects.spark",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["Spark (Critical Hit) ",(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(T.T,{placeholder:"The effect on a critical hit...",...s,rows:2})})]})}}),(0,t.jsx)(z.zB,{name:"effects.shadow",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["Shadow (Critical Failure) ",(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(T.T,{placeholder:"The effect on a critical failure...",...s,rows:3})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{name:"effects.after",control:G.control,render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["After ",(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(T.T,{placeholder:"Effect at the end of a creature's turn...",...s,rows:2})})]})}})]}),(0,t.jsxs)(F.wL,{className:"flex items-center gap-2",children:[!l&&(0,t.jsxs)(S.Lt,{children:[(0,t.jsx)(S.tv,{asChild:!0,children:(0,t.jsx)(c.$,{type:"button",variant:"destructive",size:"sm",children:(0,t.jsx)(D.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(S.EO,{children:[(0,t.jsxs)(S.wd,{children:[(0,t.jsx)(S.r7,{children:"Are you sure?"}),(0,t.jsxs)(S.$v,{children:['This will permanently delete "',G.getValues("name"),'". This action cannot be undone.']})]}),(0,t.jsxs)(S.ck,{children:[(0,t.jsx)(S.Zr,{children:"Cancel"}),(0,t.jsx)(S.Rx,{onClick:U,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]}),(0,t.jsx)("div",{className:"flex-grow"}),!_&&(0,t.jsx)(c.$,{type:"button",variant:"outline",onClick:K,children:"Cancel"}),(0,t.jsx)(c.$,{type:"submit",children:l?"Create Deed":"Save Changes"})]})]})})})}):(0,t.jsx)("div",{className:"w-full max-w-5xl mx-auto",children:(0,t.jsx)(F.Zp,{className:"h-full flex items-center justify-center min-h-[300px]",children:(0,t.jsxs)(F.Wu,{className:"text-center pt-6",children:[(0,t.jsx)("p",{className:"text-xl text-muted-foreground",children:"Select a deed to view"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"or create a new one."})]})})})}var W=l(6195),Z=l(20031);function H(e){let{selectedId:s}=e,[l,r]=(0,a.useState)(s||null),[n,i]=(0,a.useState)(0),[c,d]=(0,a.useState)(!1),[o,h]=(0,a.useState)(null),[x,j]=(0,a.useState)(""),[u,m]=(0,a.useState)("all"),[p,g]=(0,a.useState)("all"),[f,v]=(0,a.useState)("all"),[y,w]=(0,a.useState)("all"),[b,C]=(0,a.useState)(""),[F,T]=(0,a.useState)("name"),[S,z]=(0,a.useState)("asc"),[k,B]=(0,a.useState)(!1),A=(0,M.a)(),[D,E]=(0,a.useState)("list");(0,a.useEffect)(()=>{B(!0),s&&(r(s),A&&E("editor"))},[s,A]);let V={searchTerm:x,tierFilter:u,deedTypeFilter:p,actionTypeFilter:f,versusFilter:y,tagFilter:b,sortBy:F,sortOrder:S},R={setSearchTerm:j,setTierFilter:m,setDeedTypeFilter:g,setActionTypeFilter:v,setVersusFilter:w,setTagFilter:C,setSortBy:T,setSortOrder:z},I=(e,s)=>{s.shiftKey?(e.tierFilter&&m(e.tierFilter),e.tagFilter&&C(s=>s?s.split(",").map(e=>e.trim()).includes(e.tagFilter)?s:"".concat(s,", ").concat(e.tagFilter):e.tagFilter)):(m(e.tierFilter||"all"),C(e.tagFilter||""))},J=()=>{j(""),m("all"),g("all"),v("all"),w("all"),C(""),T("name"),z("asc")},$=()=>i(e=>e+1),O=e=>{r(e),d(!1),h(null),A&&E("editor")},L=()=>{r(null),d(!0),h(null),A&&E("editor")},H=e=>{let s={...e};s.name="Copy of ".concat(e.name||"deed"),delete s.id,r(null),d(!0),h(s),A&&E("editor")},_=e=>{$(),r(e),d(!1),h(null),A&&E("editor")},G=()=>{$(),r(null),d(!1),h(null),A&&E("list")},K=()=>{c&&(d(!1),r(null),A&&E("list"))};return k?A?(0,t.jsx)(W.A,{children:(0,t.jsx)("div",{className:"h-full w-full",children:"list"===D?(0,t.jsx)(N,{onSelectDeed:O,onNewDeed:L,selectedDeedId:l,dataVersion:n,filters:V,setFilters:R,onClearFilters:J}):(0,t.jsx)("div",{className:"h-full w-full overflow-y-auto",children:(0,t.jsx)("div",{className:"p-4 sm:p-6",children:(0,t.jsx)(q,{deedId:l,isCreatingNew:c,template:o,onDeedSaveSuccess:_,onDeedDeleteSuccess:G,onUseAsTemplate:H,onEditCancel:K,dataVersion:n,onFilterByClick:I,onBack:()=>{E("list"),r(null),d(!1),h(null)}},null!=l?l:c?"new":"placeholder")})})})}):(0,t.jsx)(Z.SidebarProvider,{children:(0,t.jsx)(W.A,{children:(0,t.jsxs)("div",{className:"flex w-full h-full overflow-hidden",children:[(0,t.jsx)(Z.Bx,{style:{"--sidebar-width":"380px"},children:(0,t.jsx)(N,{onSelectDeed:O,onNewDeed:L,selectedDeedId:l,dataVersion:n,filters:V,setFilters:R,onClearFilters:J})}),(0,t.jsx)(Z.sF,{className:"flex-1 overflow-y-auto",children:(0,t.jsx)("div",{className:"bg-background/50 p-4 sm:p-6 md:p-8 w-full",children:(0,t.jsx)(q,{deedId:l,isCreatingNew:c,template:o,onDeedSaveSuccess:_,onDeedDeleteSuccess:G,onUseAsTemplate:H,onEditCancel:K,dataVersion:n,onFilterByClick:I},null!=l?l:c?"new":"placeholder")})})]})})}):null}}}]);